(function(e,t){typeof define=="function"&&define.amd?define("src/map/IChoropleth",["../common/Palette"],t):e.map_IChoropleth=t(e.common_Palette,e.usStates,e.usCounties)})(this,function(e,t,n){function r(){}return r.prototype._palette=e.rainbow("default"),r.prototype.click=function(e,t,n){console.log("Click:  "+JSON.stringify(e)+", "+t+", "+n)},r}),define("css!src/map/Choropleth",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("src/map/Choropleth",["d3","../common/SVGWidget","./IChoropleth","../other/Bag","../api/ITooltip","css!./Choropleth"],t):e.map_Choropleth=t(e.d3,e.common_SVGWidget,e.map_IChoropleth,e.other_Bag,e.api_ITooltip)}(this,function(e,t,n,r,i){function s(){t.call(this),n.call(this),i.call(this),this._dataMap={},this._dataMinWeight=0,this._dataMaxWeight=0,this._prevTranslate=[0,0],this._prevScale=1}return s.prototype=Object.create(t.prototype),s.prototype.constructor=s,s.prototype._class+=" map_Choropleth",s.prototype.implements(n.prototype),s.prototype.implements(i.prototype),s.prototype.publish("paletteID","YlOrRd","set","Palette ID",s.prototype._palette.switch(),{tags:["Basic","Shared"]}),s.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),s.prototype.data=function(e){var n=t.prototype.data.apply(this,arguments);if(arguments.length){this._dataMap={},this._dataMinWeight=null,this._dataMaxWeight=null;var r=this;this._data.forEach(function(e){r._dataMap[e[0]]=e;if(!r._dataMinWeight||e[1]<r._dataMinWeight)r._dataMinWeight=e[1];if(!r._dataMaxWeight||e[1]>r._dataMaxWeight)r._dataMaxWeight=e[1]})}return n},s.prototype.size=function(e){var n=t.prototype.size.apply(this,arguments);return arguments.length&&this._svgZoom&&this._svgZoom.attr("x",-this._size.width/2).attr("y",-this._size.height/2).attr("width",this._size.width).attr("height",this._size.height),n},s.prototype.projection=function(t){if(!arguments.length)return this._projection;this._projection=t;switch(this._projection){case"albersUsaPr":this.d3Projection=this.albersUsaPr();break;case"orthographic":this.d3Projection=e.geo.orthographic().clipAngle(90);break;case"mercator":this.d3Projection=e.geo.mercator()}return this.d3Path=e.geo.path().projection(this.d3Projection),this},s.prototype.render=function(){return t.prototype.render.apply(this,arguments),this._renderCount===1&&this.zoomToFit(),this},s.prototype.enter=function(t,n){var i=this;this._svgZoom=n.append("rect").attr("class","zoom").attr("x",-this._size.width/2).attr("y",-this._size.height/2).attr("width",this._size.width).attr("height",this._size.height).on("dblclick",function(t){e.event.stopPropagation(),i.zoomToFit(null,750)});var s=this._parentElement.insert("defs",":first-child"),o=s.append("pattern").attr("id","hash").attr("patternUnits","userSpaceOnUse").attr("width","10").attr("height","10").attr("x",0).attr("y",0).append("g");o.append("rect").attr("class","noFill").attr("x",0).attr("y",0).attr("width",5).attr("height",5),o.append("rect").attr("class","noFill").attr("x",5).attr("y",5).attr("width",5).attr("height",5),this._svg=n.append("g"),this._selection=new r.SimpleSelection(this._svg)},s.prototype.update=function(e,t){this._palette=this._palette.switch(this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id()))},s.prototype.exit=function(e,n){t.prototype.enter.apply(this,arguments),delete this._selection},s.prototype.albersUsaPr=function(){function h(e){var t=e[0],n=e[1];return o=null,(a(t,n),o)||(f(t,n),o)||(l(t,n),o)||(c(t,n),o),o}var t=1e-6,n=e.geo.albers(),r=e.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),i=e.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s=e.geo.conicEqualArea().rotate([66,0]).center([0,18]).parallels([8,18]),o,u={point:function(e,t){o=[e,t]}},a,f,l,c;return h.invert=function(e){var t=n.scale(),o=n.translate(),u=(e[0]-o[0])/t,a=(e[1]-o[1])/t;return(a>=.12&&a<.234&&u>=-0.425&&u<-0.214?r:a>=.166&&a<.234&&u>=-0.214&&u<-0.115?i:a>=.204&&a<.234&&u>=.32&&u<.38?s:n).invert(e)},h.stream=function(e){var t=n.stream(e),o=r.stream(e),u=i.stream(e),a=s.stream(e);return{point:function(e,n){t.point(e,n),o.point(e,n),u.point(e,n),a.point(e,n)},sphere:function(){t.sphere(),o.sphere(),u.sphere(),a.sphere()},lineStart:function(){t.lineStart(),o.lineStart(),u.lineStart(),a.lineStart()},lineEnd:function(){t.lineEnd(),o.lineEnd(),u.lineEnd(),a.lineEnd()},polygonStart:function(){t.polygonStart(),o.polygonStart(),u.polygonStart(),a.polygonStart()},polygonEnd:function(){t.polygonEnd(),o.polygonEnd(),u.polygonEnd(),a.polygonEnd()}}},h.precision=function(e){return arguments.length?(n.precision(e),r.precision(e),i.precision(e),s.precision(e),h):n.precision()},h.scale=function(e){return arguments.length?(n.scale(e),r.scale(e*.35),i.scale(e),s.scale(e),h.translate(n.translate())):n.scale()},h.translate=function(e){if(!arguments.length)return n.translate();var o=n.scale(),p=+e[0],d=+e[1];return a=n.translate(e).clipExtent([[p-.455*o,d-.238*o],[p+.455*o,d+.238*o]]).stream(u).point,f=r.translate([p-.307*o,d+.201*o]).clipExtent([[p-.425*o+t,d+.12*o+t],[p-.214*o-t,d+.234*o-t]]).stream(u).point,l=i.translate([p-.205*o,d+.212*o]).clipExtent([[p-.214*o+t,d+.166*o+t],[p-.115*o-t,d+.234*o-t]]).stream(u).point,c=s.translate([p+.35*o,d+.224*o]).clipExtent([[p+.32*o,d+.204*o],[p+.38*o,d+.234*o]]).stream(u).point,h},h.scale(1070)},s.prototype.project=function(e,t){var n=this.d3Projection([t,e]),r=this.x()+this._prevTranslate[0],i=this.y()+this._prevTranslate[1];return n[0]*=this._prevScale,n[1]*=this._prevScale,n[0]+=r,n[1]+=i,n},s.prototype.zoomToFit=function(e,t,n){n=n||.9;var r=e?e.getBBox():this._svg.node().getBBox(),i=r.x+r.width/2,s=r.y+r.height/2,o=n/Math.max(r.width/this.width(),r.height/this.height()),u=[-o*i,-o*s];this._prevTranslate=u,this._prevScale=o,(t?this._svg.transition().duration(t):this._svg).attr("transform","translate("+u+")scale("+o+")")},s}),!function(){function t(e,t){function u(t){var n=e.arcs[t<0?~t:t],r=n[0],i;return e.transform?(i=[0,0],n.forEach(function(e){i[0]+=e[0],i[1]+=e[1]})):i=n[n.length-1],t<0?[i,r]:[r,i]}function a(e,t){for(var r in e){var i=e[r];delete t[i.start],delete i.start,delete i.end,i.forEach(function(e){n[e<0?~e:e]=1}),s.push(i)}}var n={},r={},i={},s=[],o=-1;return t.forEach(function(n,r){var i=e.arcs[n<0?~n:n],s;i.length<3&&!i[1][0]&&!i[1][1]&&(s=t[++o],t[o]=n,t[r]=s)}),t.forEach(function(e){var t=u(e),n=t[0],s=t[1],o,a;if(o=i[n]){delete i[o.end],o.push(e),o.end=s;if(a=r[s]){delete r[a.start];var f=a===o?o:o.concat(a);r[f.start=o.start]=i[f.end=a.end]=f}else r[o.start]=i[o.end]=o}else if(o=r[s]){delete r[o.start],o.unshift(e),o.start=n;if(a=i[n]){delete i[a.end];var l=a===o?o:a.concat(o);r[l.start=a.start]=i[l.end=o.end]=l}else r[o.start]=i[o.end]=o}else o=[e],r[o.start=n]=i[o.end=s]=o}),a(i,r),a(r,i),t.forEach(function(e){n[e<0?~e:e]||s.push([e])}),s}function r(e,n,r){var i=[];if(arguments.length>1){var s=[],o;function u(e){var t=e<0?~e:e;(s[t]||(s[t]=[])).push({i:e,g:o})}function a(e){e.forEach(u)}function f(e){e.forEach(a)}function l(e){e.type==="GeometryCollection"?e.geometries.forEach(l):e.type in c&&(o=e,c[e.type](e.arcs))}var c={LineString:a,MultiLineString:f,Polygon:f,MultiPolygon:function(e){e.forEach(f)}};l(n),s.forEach(arguments.length<3?function(e){i.push(e[0].i)}:function(e){r(e[0].g,e[e.length-1].g)&&i.push(e[0].i)})}else for(var h=0,p=e.arcs.length;h<p;++h)i.push(h);return{type:"MultiLineString",arcs:t(e,i)}}function i(e,r){function a(e){e.forEach(function(t){t.forEach(function(t){(i[t=t<0?~t:t]||(i[t]=[])).push(e)})}),s.push(e)}function f(t){return h(u(e,{type:"Polygon",arcs:[t]}).coordinates[0])>0}var i={},s=[],o=[];return r.forEach(function(e){e.type==="Polygon"?a(e.arcs):e.type==="MultiPolygon"&&e.arcs.forEach(a)}),s.forEach(function(e){if(!e._){var t=[],n=[e];e._=1,o.push(t);while(e=n.pop())t.push(e),e.forEach(function(e){e.forEach(function(e){i[e<0?~e:e].forEach(function(e){e._||(e._=1,n.push(e))})})})}}),s.forEach(function(e){delete e._}),{type:"MultiPolygon",arcs:o.map(function(r){var s=[];r.forEach(function(e){e.forEach(function(e){e.forEach(function(e){i[e<0?~e:e].length<2&&s.push(e)})})}),s=t(e,s);if((n=s.length)>1){var o=f(r[0][0]);for(var u=0,a;u<n;++u)if(o===f(s[u])){a=s[0],s[0]=s[u],s[u]=a;break}}return s})}}function s(e,t){return t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(t){return o(e,t)})}:o(e,t)}function o(e,t){var n={type:"Feature",id:t.id,properties:t.properties||{},geometry:u(e,t)};return t.id==null&&delete n.id,n}function u(e,t){function i(e,t){t.length&&t.pop();for(var i=r[e<0?~e:e],s=0,o=i.length,u;s<o;++s)t.push(u=i[s].slice()),n(u,s);e<0&&a(t,o)}function s(e){return e=e.slice(),n(e,0),e}function o(e){var t=[];for(var n=0,r=e.length;n<r;++n)i(e[n],t);return t.length<2&&t.push(t[0].slice()),t}function u(e){var t=o(e);while(t.length<4)t.push(t[0].slice());return t}function f(e){return e.map(u)}function l(e){var t=e.type;return t==="GeometryCollection"?{type:t,geometries:e.geometries.map(l)}:t in c?{type:t,coordinates:c[t](e)}:null}var n=m(e.transform),r=e.arcs,c={Point:function(e){return s(e.coordinates)},MultiPoint:function(e){return e.coordinates.map(s)},LineString:function(e){return o(e.arcs)},MultiLineString:function(e){return e.arcs.map(o)},Polygon:function(e){return f(e.arcs)},MultiPolygon:function(e){return e.arcs.map(f)}};return l(t)}function a(e,t){var n,r=e.length,i=r-t;while(i<--r)n=e[i],e[i++]=e[r],e[r]=n}function f(e,t){var n=0,r=e.length;while(n<r){var i=n+r>>>1;e[i]<t?n=i+1:r=i}return n}function l(e){function r(e,n){e.forEach(function(e){e<0&&(e=~e);var r=t[e];r?r.push(n):t[e]=[n]})}function i(e,t){e.forEach(function(e){r(e,t)})}function s(e,t){e.type==="GeometryCollection"?e.geometries.forEach(function(e){s(e,t)}):e.type in o&&o[e.type](e.arcs,t)}var t={},n=e.map(function(){return[]}),o={LineString:r,MultiLineString:i,Polygon:i,MultiPolygon:function(e,t){e.forEach(function(e){i(e,t)})}};e.forEach(s);for(var u in t)for(var a=t[u],l=a.length,c=0;c<l;++c)for(var h=c+1;h<l;++h){var p=a[c],d=a[h],v;(v=n[p])[u=f(v,d)]!==d&&v.splice(u,0,d),(v=n[d])[u=f(v,p)]!==p&&v.splice(u,0,p)}return n}function c(e,t){function s(e){i.remove(e),e[1][2]=t(e),i.push(e)}var n=m(e.transform),r=g(e.transform),i=v();return t||(t=p),e.arcs.forEach(function(e){var o=[],u=0,a;for(var f=0,l=e.length,c;f<l;++f)c=e[f],n(e[f]=[c[0],c[1],Infinity],f);for(var f=1,l=e.length-1;f<l;++f)a=e.slice(f-1,f+2),a[1][2]=t(a),o.push(a),i.push(a);for(var f=0,l=o.length;f<l;++f)a=o[f],a.previous=o[f-1],a.next=o[f+1];while(a=i.pop()){var h=a.previous,p=a.next;a[1][2]<u?a[1][2]=u:u=a[1][2],h&&(h.next=p,h[2]=a[2],s(h)),p&&(p.previous=h,p[0]=a[0],s(p))}e.forEach(r)}),e}function h(e){var t=-1,n=e.length,r,i=e[n-1],s=0;while(++t<n)r=i,i=e[t],s+=r[0]*i[1]-r[1]*i[0];return s*.5}function p(e){var t=e[0],n=e[1],r=e[2];return Math.abs((t[0]-r[0])*(n[1]-t[1])-(t[0]-n[0])*(r[1]-t[1]))}function d(e,t){return e[1][2]-t[1][2]}function v(){function r(e,n){while(n>0){var r=(n+1>>1)-1,i=t[r];if(d(e,i)>=0)break;t[i._=n]=i,t[e._=n=r]=e}}function i(e,r){for(;;){var i=r+1<<1,s=i-1,o=r,u=t[o];s<n&&d(t[s],u)<0&&(u=t[o=s]),i<n&&d(t[i],u)<0&&(u=t[o=i]);if(o===r)break;t[u._=r]=u,t[e._=r=o]=e}}var e={},t=[],n=0;return e.push=function(e){return r(t[e._=n]=e,n++),n},e.pop=function(){if(n<=0)return;var e=t[0],r;return--n>0&&(r=t[n],i(t[r._=0]=r,0)),e},e.remove=function(e){var s=e._,o;if(t[s]!==e)return;return s!==--n&&(o=t[n],(d(o,e)<0?r:i)(t[o._=s]=o,s)),s},e}function m(e){if(!e)return y;var t,n,r=e.scale[0],i=e.scale[1],s=e.translate[0],o=e.translate[1];return function(e,u){u||(t=n=0),e[0]=(t+=e[0])*r+s,e[1]=(n+=e[1])*i+o}}function g(e){if(!e)return y;var t,n,r=e.scale[0],i=e.scale[1],s=e.translate[0],o=e.translate[1];return function(e,u){u||(t=n=0);var a=(e[0]-s)/r|0,f=(e[1]-o)/i|0;e[0]=a-t,e[1]=f-n,t=a,n=f}}function y(){}var e={version:"1.6.19",mesh:function(e){return u(e,r.apply(this,arguments))},meshArcs:r,merge:function(e){return u(e,i.apply(this,arguments))},mergeArcs:i,feature:s,neighbors:l,presimplify:c};typeof define=="function"&&define.amd?define("topojson",e):typeof module=="object"&&module.exports?module.exports=e:this.topojson=e}(),function(e,t){typeof define=="function"&&define.amd?define("src/map/ChoroplethCounties",["d3","./Choropleth","topojson","./us-counties"],t):e.map_ChoroplethCounties=t(e.d3,e.map_Choropleth,e.topojson,e.map_usCounties)}(this,function(e,t,n,r){function i(){t.call(this),this.projection("albersUsaPr")}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" map_ChoroplethCounties",i.prototype.testData=function(){var e=[{county:1073,county_name:"JEFFERSON",weight:29.946185501741},{county:1097,county_name:"MOBILE",weight:.79566003616637},{county:1117,county_name:"SHELBY",weight:1.5223596574691},{county:4005,county_name:"COCONINO",weight:27.311773623042},{county:4013,county_name:"MARICOPA",weight:34.386239749349},{county:4015,county_name:"MOHAVE",weight:34.670437987486},{county:4019,county_name:"PIMA",weight:31.969766028563},{county:4021,county_name:"PINAL",weight:32.050522991908},{county:4025,county_name:"YAVAPAI",weight:34.134956874683},{county:4027,county_name:"YUMA",weight:39.511527048619},{county:5119,county_name:"PULASKI",weight:21.796200345423},{county:6001,county_name:"ALAMEDA",weight:30.243180376401},{county:6007,county_name:"BUTTE",weight:32.895132965379},{county:6009,county_name:"CALAVERAS",weight:31.181727904667},{county:6013,county_name:"CONTRA COSTA",weight:32.185196670086},{county:6017,county_name:"EL DORADO",weight:33.085461795452},{county:6019,county_name:"FRESNO",weight:31.700962642409},{county:6023,county_name:"HUMBOLDT",weight:31.504164625184},{county:6025,county_name:"IMPERIAL",weight:33.086419753086},{county:6029,county_name:"KERN",weight:31.370903445093},{county:6031,county_name:"KINGS",weight:30.037376826368},{county:6037,county_name:"LOS ANGELES",weight:32.862228288436},{county:6039,county_name:"MADERA",weight:31.691553376421},{county:6041,county_name:"MARIN",weight:33.940594059406},{county:6045,county_name:"MENDOCINO",weight:32.19390926041},{county:6047,county_name:"MERCED",weight:17.699115044248},{county:6053,county_name:"MONTEREY",weight:34.339622641509},{county:6055,county_name:"NAPA",weight:34.272114240381},{county:6057,county_name:"NEVADA",weight:34.12581216775},{county:6059,county_name:"ORANGE",weight:34.094352964946},{county:6061,county_name:"PLACER",weight:33.368700265252},{county:6065,county_name:"RIVERSIDE",weight:34.378409504182},{county:6067,county_name:"SACRAMENTO",weight:31.127455133963},{county:6071,county_name:"SAN BERNARDINO",weight:28.061278815951},{county:6073,county_name:"SAN DIEGO",weight:33.416802684537},{county:6075,county_name:"SAN FRANCISCO",weight:32.679686882265},{county:6077,county_name:"SAN JOAQUIN",weight:33.220663908788},{county:6079,county_name:"SAN LUIS OBISPO",weight:34.654426692559},{county:6081,county_name:"SAN MATEO",weight:38.130056937369},{county:6083,county_name:"SANTA BARBARA",weight:33.631012786686},{county:6085,county_name:"SANTA CLARA",weight:23.539289157001},{county:6087,county_name:"SANTA CRUZ",weight:33.450792851749},{county:6089,county_name:"SHASTA",weight:33.199951497514},{county:6095,county_name:"SOLANO",weight:29.988272742503},{county:6097,county_name:"SONOMA",weight:32.117851341511},{county:6099,county_name:"STANISLAUS",weight:28.860983743226},{county:6101,county_name:"SUTTER",weight:30.02277904328},{county:6107,county_name:"TULARE",weight:30.886966441677},{county:6111,county_name:"VENTURA",weight:32.241761994195},{county:6113,county_name:"YOLO",weight:33.095684803002},{county:8001,county_name:"ADAMS",weight:36.59961064244},{county:8005,county_name:"ARAPAHOE",weight:35.375019172759},{county:8013,county_name:"BOULDER",weight:14.409178959917},{county:8031,county_name:"DENVER",weight:29.526387009472},{county:8035,county_name:"DOUGLAS",weight:34.816606207175},{county:8041,county_name:"EL PASO",weight:35.803302523627},{county:8059,county_name:"JEFFERSON",weight:30.013848159009},{county:8069,county_name:"LARIMER",weight:31.525663161199},{county:8077,county_name:"MESA",weight:6.4506267196576},{county:8101,county_name:"PUEBLO",weight:13.887799136916},{county:8123,county_name:"WELD",weight:13.152569809794},{county:9001,county_name:"FAIRFIELD",weight:5.7392073825928},{county:9003,county_name:"HARTFORD",weight:4.1802067946824},{county:9005,county_name:"LITCHFIELD",weight:4.0793517742386},{county:9007,county_name:"MIDDLESEX",weight:5.5014146494813},{county:9009,county_name:"NEW HAVEN",weight:4.5156537753223},{county:9011,county_name:"NEW LONDON",weight:5.0602409638554},{county:10003,county_name:"NEW CASTLE",weight:32.839907589629},{county:11001,county_name:"DISTRICT OF COLUMBIA",weight:9.2949842160645},{county:12001,county_name:"ALACHUA",weight:10.877270713336},{county:12005,county_name:"BAY",weight:36.272040302267},{county:12009,county_name:"BREVARD",weight:11.407698791795},{county:12011,county_name:"BROWARD",weight:23.280277164089},{county:12015,county_name:"CHARLOTTE",weight:12.530881141916},{county:12017,county_name:"CITRUS",weight:31.700110796504},{county:12019,county_name:"CLAY",weight:35.153278138286},{county:12021,county_name:"COLLIER",weight:15.993998499625},{county:12031,county_name:"DUVAL",weight:34.893654890095},{county:12033,county_name:"ESCAMBIA",weight:11.185959936182},{county:12035,county_name:"FLAGLER",weight:18.70760442699},{county:12053,county_name:"HERNANDO",weight:9.1261739485504},{county:12055,county_name:"HIGHLANDS",weight:28.057742782152},{county:12057,county_name:"HILLSBOROUGH",weight:26.866557815051},{county:12061,county_name:"INDIAN RIVER",weight:10.33669311602},{county:12069,county_name:"LAKE",weight:13.579952267303},{county:12071,county_name:"LEE",weight:13.640759797284},{county:12073,county_name:"LEON",weight:10.285270716088},{county:12081,county_name:"MANATEE",weight:14.247875510429},{county:12083,county_name:"MARION",weight:33.329608938547},{county:12085,county_name:"MARTIN",weight:19.259129213483},{county:12086,county_name:"MIAMI-DADE",weight:27.092726418329},{county:12087,county_name:"MONROE",weight:19.3515704154},{county:12091,county_name:"OKALOOSA",weight:29.375576745617},{county:12095,county_name:"ORANGE",weight:29.856149076143},{county:12097,county_name:"OSCEOLA",weight:14.039249514772},{county:12099,county_name:"PALM BEACH",weight:30.592551486003},{county:12101,county_name:"PASCO",weight:25.170105355575},{county:12103,county_name:"PINELLAS",weight:28.425946424618},{county:12105,county_name:"POLK",weight:28.673352628391},{county:12109,county_name:"ST. JOHNS",weight:35.882708585248},{county:12111,county_name:"ST. LUCIE",weight:12.200208550574},{county:12113,county_name:"SANTA ROSA",weight:13.362801768106},{county:12115,county_name:"SARASOTA",weight:33.847820200379},{county:12117,county_name:"SEMINOLE",weight:26.554468579008},{county:12127,county_name:"VOLUSIA",weight:26.636455186304},{county:12131,county_name:"WALTON",weight:31.245500359971},{county:13067,county_name:"COBB",weight:4.539857154585},{county:13089,county_name:"DEKALB",weight:9.747504403993},{county:13121,county_name:"FULTON",weight:13.174338679442},{county:13135,county_name:"GWINNETT",weight:6.4834390415786},{county:15001,county_name:"HAWAII",weight:15.918023582257},{county:15003,county_name:"HONOLULU",weight:22.138866719872},{county:15007,county_name:"KAUAI",weight:63.105998356615},{county:15009,county_name:"MAUI",weight:27.947348340328},{county:17031,county_name:"COOK",weight:13.833973012769},{county:17043,county_name:"DUPAGE",weight:30.967531997975},{county:17089,county_name:"KANE",weight:33.050309474687},{county:17097,county_name:"LAKE",weight:11.594933064632},{county:17111,county_name:"MCHENRY",weight:32.527401676338},{county:17143,county_name:"PEORIA",weight:4.8459804658152},{county:17163,county_name:"ST. CLAIR",weight:5.1138238205213},{county:17197,county_name:"WILL",weight:26.516622872158},{county:17201,county_name:"WINNEBAGO",weight:5.1221247332227},{county:18097,county_name:"MARION",weight:12.886209495102},{county:22033,county_name:"EAST BATON ROUGE",weight:3.0595813204509},{county:24003,county_name:"ANNE ARUNDEL",weight:6.6849100860047},{county:24005,county_name:"BALTIMORE",weight:5.1798561151079},{county:24013,county_name:"CARROLL",weight:7.6580226904376},{county:24017,county_name:"CHARLES",weight:5.6275122822689},{county:24021,county_name:"FREDERICK",weight:5.8358521274122},{county:24025,county_name:"HARFORD",weight:7.137490608565},{county:24027,county_name:"HOWARD",weight:6.3063063063063},{county:24031,county_name:"MONTGOMERY",weight:6.4765062307077},{county:24033,county_name:"PRINCE GEORGES",weight:6.9953804091638},{county:24043,county_name:"WASHINGTON",weight:7.9417293233083},{county:24047,county_name:"WORCESTER",weight:16.55126937026},{county:24510,county_name:"BALTIMORE CITY",weight:8.2386000766381},{county:25001,county_name:"BARNSTABLE",weight:17.454806656291},{county:25005,county_name:"BRISTOL",weight:7.4465049928673},{county:25009,county_name:"ESSEX",weight:12.506881996697},{county:25013,county_name:"HAMPDEN",weight:8.0384380719951},{county:25017,county_name:"MIDDLESEX",weight:27.939008042895},{county:25021,county_name:"NORFOLK",weight:24.315648164361},{county:25023,county_name:"PLYMOUTH",weight:13.348746653687},{county:25025,county_name:"SUFFOLK",weight:12.415510494486},{county:25027,county_name:"WORCESTER",weight:8.4754797441365},{county:26049,county_name:"GENESEE",weight:7.9543628475012},{county:26065,county_name:"INGHAM",weight:6.1461497230659},{county:26075,county_name:"JACKSON",weight:3.9448669201521},{county:26081,county_name:"KENT",weight:3.5925196850394},{county:26093,county_name:"LIVINGSTON",weight:4.7977422389464},{county:26099,county_name:"MACOMB",weight:8.4649655731065},{county:26145,county_name:"SAGINAW",weight:3.8956266078648},{county:26161,county_name:"WASHTENAW",weight:12.490241998439},{county:27003,county_name:"ANOKA",weight:35.361438748102},{county:27019,county_name:"CARVER",weight:35.444806707033},{county:27037,county_name:"DAKOTA",weight:3.7469454249253},{county:27053,county_name:"HENNEPIN",weight:25.479191584629},{county:27123,county_name:"RAMSEY",weight:27.0296014068},{county:27137,county_name:"ST. LOUIS",weight:13.218235770165},{county:27139,county_name:"SCOTT",weight:4.1739130434783},{county:27163,county_name:"WASHINGTON",weight:2.2402757262432},{county:27171,county_name:"WRIGHT",weight:32.163742690058},{county:29095,county_name:"JACKSON",weight:27.766490586482},{county:29183,county_name:"ST. CHARLES",weight:31.629914829075},{county:29189,county_name:"ST. LOUIS",weight:43.333848292909},{county:29510,county_name:"SAINT LOUIS CITY",weight:32.204861111111},{county:31109,county_name:"LANCASTER",weight:2.2465753424658},{county:32003,county_name:"CLARK",weight:31.380314013042},{county:32031,county_name:"WASHOE",weight:24.548452960578},{county:34001,county_name:"ATLANTIC",weight:25.995919682165},{county:34003,county_name:"BERGEN",weight:6.9890009165903},{county:34005,county_name:"BURLINGTON",weight:10.048802129547},{county:34007,county_name:"CAMDEN",weight:8.2412255187124},{county:34009,county_name:"CAPE MAY",weight:19.508037018997},{county:34013,county_name:"ESSEX",weight:9.9226139294927},{county:34015,county_name:"GLOUCESTER",weight:30.202724105163},{county:34017,county_name:"HUDSON",weight:24.161710197397},{county:34021,county_name:"MERCER",weight:8.074222668004},{county:34023,county_name:"MIDDLESEX",weight:9.2441860465116},{county:34025,county_name:"MONMOUTH",weight:9.3353822512486},{county:34027,county_name:"MORRIS",weight:17.225352112676},{county:34029,county_name:"OCEAN",weight:37.018672038429},{county:34031,county_name:"PASSAIC",weight:8.7633451957295},{county:34035,county_name:"SOMERSET",weight:8.638148377764},{county:34037,county_name:"SUSSEX",weight:29.534510433387},{county:34039,county_name:"UNION",weight:31.89460476788},{county:34041,county_name:"WARREN",weight:29.438717067583},{county:35001,county_name:"BERNALILLO",weight:28.118628359592},{county:36001,county_name:"ALBANY",weight:3.9375203384315},{county:36005,county_name:"BRONX",weight:30.396841886557},{county:36007,county_name:"BROOME",weight:5.097312326228},{county:36027,county_name:"DUTCHESS",weight:4.2664670658683},{county:36029,county_name:"ERIE",weight:7.2621727283497},{county:36047,county_name:"KINGS",weight:17.225350853669},{county:36055,county_name:"MONROE",weight:7.4890687505814},{county:36059,county_name:"NASSAU",weight:5.2696619295613},{county:36061,county_name:"NEW YORK",weight:34.155087404751},{county:36063,county_name:"NIAGARA",weight:10.821554770318},{county:36067,county_name:"ONONDAGA",weight:4.6743533811156},{county:36071,county_name:"ORANGE",weight:8.2626453031731},{county:36079,county_name:"PUTNAM",weight:14.148471615721},{county:36081,county_name:"QUEENS",weight:15.364354697103},{county:36085,county_name:"RICHMOND",weight:6.269637246501},{county:36087,county_name:"ROCKLAND",weight:27.891763306572},{county:36091,county_name:"SARATOGA",weight:6.2885689097855},{county:36093,county_name:"SCHENECTADY",weight:4.4991511035654},{county:36103,county_name:"SUFFOLK",weight:7.5394862036156},{county:36111,county_name:"ULSTER",weight:12.761714855434},{county:36119,county_name:"WESTCHESTER",weight:29.387637203928},{county:37021,county_name:"BUNCOMBE",weight:11.221203864256},{county:37063,county_name:"DURHAM",weight:15.128449096099},{county:37067,county_name:"FORSYTH",weight:9.2007937939744},{county:37081,county_name:"GUILFORD",weight:28.909542850967},{county:37119,county_name:"MECKLENBURG",weight:33.987464880052},{county:37179,county_name:"UNION",weight:26.785714285714},{county:37183,county_name:"WAKE",weight:8.7896810071831},{county:39017,county_name:"BUTLER",weight:11.786600496278},{county:39023,county_name:"CLARK",weight:14.401858304297},{county:39025,county_name:"CLERMONT",weight:13.625229638702},{county:39035,county_name:"CUYAHOGA",weight:12.534629658669},{county:39041,county_name:"DELAWARE",weight:14.716382387941},{county:39049,county_name:"FRANKLIN",weight:10.798621668187},{county:39057,county_name:"GREENE",weight:11.068539804172},{county:39061,county_name:"HAMILTON",weight:36.769337122667},{county:39085,county_name:"LAKE",weight:12.217071175348},{county:39093,county_name:"LORAIN",weight:13.587223587224},{county:39095,county_name:"LUCAS",weight:13.123076923077},{county:39099,county_name:"MAHONING",weight:31.380076783189},{county:39103,county_name:"MEDINA",weight:16.013693419551},{county:39113,county_name:"MONTGOMERY",weight:26.50459988693},{county:39151,county_name:"STARK",weight:15.11240632806},{county:39153,county_name:"SUMMIT",weight:13.199693285135},{county:39155,county_name:"TRUMBULL",weight:29.438246232139},{county:39165,county_name:"WARREN",weight:13.73673644967},{county:40109,county_name:"OKLAHOMA",weight:27.656619689332},{county:40143,county_name:"TULSA",weight:25.915538104015},{county:41005,county_name:"CLACKAMAS",weight:25.209182578846},{county:41017,county_name:"DESCHUTES",weight:12.440905697935},{county:41029,county_name:"JACKSON",weight:27.052127022169},{county:41039,county_name:"LANE",weight:25.60987654321},{county:41047,county_name:"MARION",weight:10.069371452596},{county:41051,county_name:"MULTNOMAH",weight:24.120918984281},{county:41067,county_name:"WASHINGTON",weight:25.706513525767},{county:42003,county_name:"ALLEGHENY",weight:22.365269461078},{county:42011,county_name:"BERKS",weight:24.786427626038},{county:42017,county_name:"BUCKS",weight:21.367236348479},{county:42029,county_name:"CHESTER",weight:21.769354602664},{county:42043,county_name:"DAUPHIN",weight:6.369785794814},{county:42045,county_name:"DELAWARE",weight:15.37927114255},{county:42049,county_name:"ERIE",weight:22.071725411728},{county:42071,county_name:"LANCASTER",weight:20.179372197309},{county:42077,county_name:"LEHIGH",weight:7.3121191604604},{county:42091,county_name:"MONTGOMERY",weight:18.260730642241},{county:42095,county_name:"NORTHAMPTON",weight:8.6726998491704},{county:42101,county_name:"PHILADELPHIA",weight:7.0216526734423},{county:42129,county_name:"WESTMORELAND",weight:1.5865820489574},{county:42133,county_name:"YORK",weight:1.5625},{county:45013,county_name:"BEAUFORT",weight:29.319371727749},{county:45015,county_name:"BERKELEY",weight:18.962510897995},{county:45019,county_name:"CHARLESTON",weight:30.38401077925},{county:45045,county_name:"GREENVILLE",weight:9.6022727272727},{county:45051,county_name:"HORRY",weight:6.7260370283572},{county:45079,county_name:"RICHLAND",weight:31.786731786732},{county:45083,county_name:"SPARTANBURG",weight:4.8632218844985},{county:47037,county_name:"DAVIDSON",weight:26.933155217592},{county:47065,county_name:"HAMILTON",weight:4.0015769761482},{county:47093,county_name:"KNOX",weight:3.7659811006115},{county:47157,county_name:"SHELBY",weight:17.265944442103},{county:47165,county_name:"SUMNER",weight:40.969162995595},{county:47187,county_name:"WILLIAMSON",weight:11.318009892348},{county:48029,county_name:"BEXAR",weight:9.6375679095036},{county:48039,county_name:"BRAZORIA",weight:17.557251908397},{county:48085,county_name:"COLLIN",weight:9.860788863109},{county:48113,county_name:"DALLAS",weight:9.6153846153846},{county:48121,county_name:"DENTON",weight:7.3293172690763},{county:48141,county_name:"EL PASO",weight:12.724623603691},{county:48157,county_name:"FORT BEND",weight:12.584009269988},{county:48167,county_name:"GALVESTON",weight:16.02023608769},{county:48201,county_name:"HARRIS",weight:4.6453017154967},{county:48339,county_name:"MONTGOMERY",weight:31.846984275992},{county:48439,county_name:"TARRANT",weight:7.9620017628048},{county:48453,county_name:"TRAVIS",weight:13.826591210787},{county:49011,county_name:"DAVIS",weight:40.058055152395},{county:49035,county_name:"SALT LAKE",weight:27.558536096065},{county:49049,county_name:"UTAH",weight:17.96860223189},{county:49057,county_name:"WEBER",weight:38.2081061863},{county:51041,county_name:"CHESTERFIELD",weight:24.315143545913},{county:51059,county_name:"FAIRFAX",weight:7.9613616888681},{county:51087,county_name:"HENRICO",weight:24.006772009029},{county:51107,county_name:"LOUDOUN",weight:7.3784722222222},{county:51153,county_name:"PRINCE WILLIAM",weight:6.8582432232262},{county:51510,county_name:"ALEXANDRIA",weight:6.0534325329726},{county:51760,county_name:"RICHMOND",weight:16.079158936302},{county:53011,county_name:"CLARK",weight:10.591067130249},{county:53033,county_name:"KING",weight:31.749109104673},{county:53035,county_name:"KITSAP",weight:13.962395543175},{county:53053,county_name:"PIERCE",weight:12.965240468639},{county:53061,county_name:"SNOHOMISH",weight:11.663844199831},{county:53063,county_name:"SPOKANE",weight:9.5754829477701},{county:53067,county_name:"THURSTON",weight:11.969351832678},{county:53073,county_name:"WHATCOM",weight:36.384766672626},{county:53077,county_name:"YAKIMA",weight:6.7676289635589},{county:55009,county_name:"BROWN",weight:2.4074631357207},{county:55079,county_name:"MILWAUKEE",weight:14.943187741061},{county:55133,county_name:"WAUKESHA",weight:8.5109742618033}];this.columns(["County","Weight","Label"]);var t=e.map(function(e){return[e.county,e.weight,e.county_name]});return this.data(t),this},i.prototype.enter=function(i,s){t.prototype.enter.apply(this,arguments),s.classed("map_Choropleth",!0);var o=this._svg.selectAll("path").data(n.feature(r.topology,r.topology.objects.counties).features),u=this;this.choroPaths=o.enter().append("path").call(this._selection.enter.bind(this._selection)).on("click",function(e){u._dataMap[e.id]&&u.click(u.rowToObj(u._dataMap[e.id]),"weight",u._selection.selected(this))}).on("dblclick",function(t){e.event.stopPropagation(),u.zoomToFit(u.active===this?null:this,750),u.active=this}).on("mouseover.tooltip",function(e){u._dataMap[e.id]&&u.tooltipShow([u._dataMap[e.id][2],u._dataMap[e.id][1]],u._columns,1)}).on("mouseout.tooltip",function(e){u.tooltipShow()}).on("mousemove.tooltip",function(e){u._dataMap[e.id]&&u.tooltipShow([u._dataMap[e.id][2],u._dataMap[e.id][1]],u._columns,1)})},i.prototype.update=function(n,r){t.prototype.update.apply(this,arguments);var i=this;this.choroPaths.attr("d",this.d3Path).each(function(t){var n=i._dataMap[t.id]?i._dataMap[t.id][1]:undefined;e.select(this).style("fill",n===undefined?"url(#hash)":i._palette(n,i._dataMinWeight,i._dataMaxWeight))})},i}),function(e,t){typeof define=="function"&&define.amd?define("src/map/ChoroplethCountries",["d3","./Choropleth","topojson","./countries"],t):e.map_ChoroplethCountries=t(e.d3,e.map_Choropleth,e.topojson,e.map_countries)}(this,function(e,t,n,r){function i(){t.call(this),this._dataMap={},this._dataMaxWeight=0,this._dataMinWeight=0,this.projection(this.worldProjection())}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" map_ChoroplethCountries",i.prototype.publish("worldProjection","mercator","set","Map Projection",["mercator","orthographic"],{tags:["Private"]}),i.prototype.testData=function(){var e={};for(var t in r.countryNames){var n=r.countryNames[t];e[n.name]=t}var i=[{name:"United States",weight:29.946185501741},{name:"China",weight:229.946185501741}],s=i.map(function(t){return{country:e[t.name],weight:t.weight,label:t.name}});return this.columns(["Country","Weight","Label"]),this.data(s),this},i.prototype.data=function(e){var n=t.prototype.data.apply(this,arguments);if(arguments.length){this._dataMap={},this._dataMinWeight=null,this._dataMaxWeight=null;var r=this;this._data.forEach(function(e){r._dataMap[e.country]=e.weight;if(!r._dataMinWeight||e.weight<r._dataMinWeight)r._dataMinWeight=e.weight;if(!r._dataMaxWeight||e.weight>r._dataMaxWeight)r._dataMaxWeight=e.weight})}return n},i.prototype.enter=function(i,s){t.prototype.enter.apply(this,arguments),s.classed("map_Choropleth",!0),this.projection(this.worldProjection());var o=this;this.lookup={};var u=n.feature(r.topology,r.topology.objects.countries).features.map(function(e){return e.category="Country",r.countryNames[e.id]&&(e.name=r.countryNames[e.id].name,o.lookup[e.name]=e),e}),a=this._svg.selectAll("path").data(u);this.choroPaths=a.enter().append("path").attr("d",this.d3Path).call(this._selection.enter.bind(this._selection)).on("click",function(e){if(o._dataMap[e.id]){var t=[e.id,o._dataMap[e.id],e.name];o.click(o.rowToObj(t),"weight",o._selection.selected(this))}}).on("dblclick",function(t){e.event.stopPropagation(),o.zoomToFit(o.active===this?null:this,750),o.active=this}).on("mouseover.tooltip",function(e){o._dataMap[e.id]&&o.tooltipShow([e.name,o._dataMap[e.id]],o._columns,1)}).on("mouseout.tooltip",function(e){o.tooltipShow()}).on("mousemove.tooltip",function(e){o._dataMap[e.id]&&o.tooltipShow([e.name,o._dataMap[e.id]],o._columns,1)}).attr("id",function(e){return e.id})},i.prototype.update=function(e,n){t.prototype.update.apply(this,arguments),this.projection(this.worldProjection());var r=this;this.transition.apply(this.choroPaths).style("fill",function(e){var t=e.id,n=r._dataMap[t];return n===undefined?"url(#hash)":r._palette(n,r._dataMinWeight,r._dataMaxWeight)})},i}),function(e,t){typeof define=="function"&&define.amd?define("src/map/ChoroplethStates",["d3","./Choropleth","topojson","./us-states"],t):e.map_ChoroplethStates=t(e.d3,e.map_Choropleth,e.topojson,e.map_usStates)}(this,function(e,t,n,r){function i(){t.call(this),this.projection("albersUsaPr")}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" map_ChoroplethStates",i.prototype.testData=function(){var e={};for(var t in r.stateNames){var n=r.stateNames[t];e[n.name]=n.code}var i=[{name:"Alabama",weight:4779736},{name:"Alaska",weight:710231},{name:"Arizona",weight:6392017},{name:"Arkansas",weight:2915918},{name:"California",weight:37253956},{name:"Colorado",weight:5029196},{name:"Connecticut",weight:3574097},{name:"District of Columbia",weight:601723},{name:"Florida",weight:18801310},{name:"Georgia",weight:9687653},{name:"Hawaii",weight:1360301},{name:"Idaho",weight:1567582},{name:"Illinois",weight:12830632},{name:"Indiana",weight:6483802},{name:"Iowa",weight:3046355},{name:"Maine",weight:1328361},{name:"Maryland",weight:5773552},{name:"Massachusetts",weight:6547629},{name:"Michigan",weight:9883640},{name:"Minnesota",weight:5303925},{name:"Mississippi",weight:2967297},{name:"Missouri",weight:5988927},{name:"Montana",weight:989415},{name:"Nebraska",weight:1826341},{name:"Nevada",weight:2700551},{name:"New Hampshire",weight:1316470},{name:"New Jersey",weight:8791894},{name:"New Mexico",weight:2059179},{name:"New York",weight:19378102},{name:"North Carolina",weight:9535483},{name:"North Dakota",weight:672591},{name:"Ohio",weight:11536504},{name:"Oklahoma",weight:3751351},{name:"Oregon",weight:3831074},{name:"Pennsylvania",weight:12702379},{name:"Rhode Island",weight:1052567},{name:"South Carolina",weight:4625364},{name:"South Dakota",weight:814180},{name:"Tennessee",weight:6346105},{name:"Texas",weight:25145561},{name:"Utah",weight:2763885},{name:"Vermont",weight:625741},{name:"Virginia",weight:8001024},{name:"Washington",weight:6724540},{name:"West Virginia",weight:1852994},{name:"Wisconsin",weight:5686986},{name:"Wyoming",weight:563626}];this.columns(["State","Weight","Label"]);var s=i.map(function(t){return[e[t.name],t.weight,t.name]});return this.data(s),this},i.prototype.enter=function(i,s){t.prototype.enter.apply(this,arguments),s.classed("map_Choropleth",!0);var o=this._svg.selectAll("path").data(n.feature(r.topology,r.topology.objects.states).features),u=this;this.choroPaths=o.enter().append("path").call(this._selection.enter.bind(this._selection)).on("click",function(e){var t=r.stateNames[e.id].code;u._dataMap[t]&&u.click(u.rowToObj(u._dataMap[t]),"weight",u._selection.selected(this))}).on("dblclick",function(t){e.event.stopPropagation(),u.zoomToFit(u.active===this?null:this,750),u.active=this}).on("mouseover.tooltip",function(e){var t=r.stateNames[e.id].code;u._dataMap[t]&&u.tooltipShow([r.stateNames[e.id].name,u._dataMap[t][1]],u._columns,1)}).on("mouseout.tooltip",function(e){u.tooltipShow()}).on("mousemove.tooltip",function(e){var t=r.stateNames[e.id].code;u._dataMap[t]&&u.tooltipShow([r.stateNames[e.id].name,u._dataMap[t][1]],u._columns,1)})},i.prototype.update=function(n,i){t.prototype.update.apply(this,arguments);var s=this;this.choroPaths.attr("d",this.d3Path).each(function(t){var n=r.stateNames[t.id].code,i=s._dataMap[n]?s._dataMap[n][1]:undefined;e.select(this).style("fill",i===undefined?"url(#hash)":s._palette(i,s._dataMinWeight,s._dataMaxWeight))})},i}),function(e,t){typeof define=="function"&&define.amd?define("src/map/ChoroplethStatesHeat",["../layout/Layered","../layout/AbsoluteSurface","./ChoroplethStates","../other/HeatMap"],t):e.map_ChoroplethStatesHeat=t(e.layout_Layered,e.layout_AbsoluteSurface,e.map_ChoroplethStates,e.other_HeatMap)}(this,function(e,t,n,r){function i(t){e.call(this)}return i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype._class+=" map_ChoroplethStatesHeat",i.prototype.testData=function(){var e=[[37.665074,-122.384375,.234],[32.69068,-117.17854,.234],[39.709455,-104.969859,.234],[41.244123,-95.96161,.234],[32.68898,-117.19204,.234],[45.78649,-108.5266,.234],[45.79618,-108.535652,.234],[45.77432,-108.49437,.234],[45.777062,-108.549835,.234]],i=(new n).testData(),s=new r,o=s.render;return s.render=function(){this.data(e.map(function(e){var t=i.project(e[0],e[1]);return[t[0],t[1],e[2]]})),o.apply(this,arguments)},this.addLayer((new t).widget(i)).addLayer((new t).widget(s)),this},i}),define("css!src/map/GMap",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("src/map/GMap",["d3","../common/HTMLWidget","../layout/AbsoluteSurface","async!http://maps.google.com/maps/api/js?sensor=false","css!./GMap"],t):e.map_GMap=t(e.d3,e.common_HTMLWidget,e.layout_AbsoluteSurface)}(this,function(e,t,n){function r(e,t,n){this._div=null,this._worldSurface=t,this._viewportSurface=n,this._map=e,this.setMap(e);var r=this;google.maps.event.addListener(e,"bounds_changed",function(){r.draw()}),google.maps.event.addListener(e,"center_changed",function(){r.draw()}),this._prevWorldMin={x:0,y:0},this._prevWorldMax={x:0,y:0},this._prevMin={x:0,y:0},this._prevMax={x:0,y:0}}function i(){t.call(this),this._tag="div";var e=this;this._worldSurface=new n,this._worldSurface.project=function(t,n){var r=e._overlay.getProjection(),i=r.fromLatLngToDivPixel(new google.maps.LatLng(t,n));return i.x-=this.widgetX(),i.y-=this.widgetY(),i},this._viewportSurface=new n,this._viewportSurface.project=function(t,n){var r=e._overlay.getProjection(),i=r.fromLatLngToDivPixel(new google.maps.LatLng(t,n));return i.x-=this.widgetX(),i.y-=this.widgetY(),i}}return r.prototype=new google.maps.OverlayView,r.prototype.onAdd=function(){this.div=document.createElement("div"),this._viewportSurface.target(this.div).units("pixels");var e=this.getPanes();e.overlayLayer.appendChild(this.div)},r.prototype.draw=function(){var e=this.getProjection(),t=this._map.getBounds(),n=e.fromLatLngToDivPixel(t.getCenter()),r=e.fromLatLngToDivPixel(t.getSouthWest()),i=e.fromLatLngToDivPixel(t.getNorthEast()),s={x:r.x,y:i.y},o={x:i.x,y:r.y},u=e.getWorldWidth();while(o.x<s.x+100)o.x+=u;while(s.x>n.x)s.x-=u,o.x-=u;if(s.x!==this._prevMin.x||s.y!==this._prevMin.y||o.x!==this._prevMax.x||o.y!==this._prevMax.y)this._viewportSurface.widgetX(s.x).widgetY(s.y).widgetWidth(o.x-s.x).widgetHeight(o.y-s.y).render(),this._prevMin=s,this._prevMax=o;var a=e.fromLatLngToDivPixel(new google.maps.LatLng(85,-179.9)),f=e.fromLatLngToDivPixel(new google.maps.LatLng(-85,179.9));while(f.x<a.x+100)f.x+=u;while(a.x>n.x)a.x-=u,f.x-=u;if(a.x!==this._prevWorldMin.x||a.y!==this._prevWorldMin.y||f.x!==this._prevWorldMax.x||f.y!==this._prevWorldMax.y)this._worldSurface.widgetX(a.x).widgetY(a.y).widgetWidth(f.x-a.x).widgetHeight(f.y-a.y).render(),this._prevWorldMin=f,this._prevWorldMax=f},r.prototype.onRemove=function(){this._viewportSurface.target(null),this._div.parentNode.removeChild(this._div),this._div=null},i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" map_GMap",i.prototype.publish("type","road","set","Map Type",["terrain","road","satellite","hybrid"],{tags:["Basic"]}),i.prototype.publish("centerLat",42.877742,"number","Center Latitude",null,{tags:["Basic"]}),i.prototype.publish("centerLong",-97.380979,"number","Center Longtitude",null,{tags:["Basic"]}),i.prototype.publish("zoom",4,"number","Zoom Level",null,{tags:["Basic"]}),i.prototype.publish("panControl",!0,"boolean","Pan Controls",null,{tags:["Basic"]}),i.prototype.publish("zoomControl",!0,"boolean","Pan Controls",null,{tags:["Basic"]}),i.prototype.publish("mapTypeControl",!1,"boolean","Pan Controls",null,{tags:["Basic"]}),i.prototype.publish("scaleControl",!0,"boolean","Pan Controls",null,{tags:["Basic"]}),i.prototype.publish("streetViewControl",!1,"boolean","Pan Controls",null,{tags:["Basic"]}),i.prototype.publish("overviewMapControl",!1,"boolean","Pan Controls",null,{tags:["Basic"]}),i.prototype.testData=function(){return this.columns(["latitude","longtitude","pin","circle"]).data([[37.665074,-122.384375,{fillColor:"green"},{radius:50,fillColor:"red"}],[32.69068,-117.17854],[39.709455,-104.969859],[41.244123,-95.96161],[32.68898,-117.19204,null,{radius:100,fillColor:"green",strokeColor:"green"}],[45.78649,-108.5266],[45.79618,-108.535652],[45.77432,-108.49437],[45.777062,-108.549835,{fillColor:"red"}]]),this._worldSurface.testData(),this},i.prototype.data=function(e){var n=t.prototype.data.apply(this,arguments);return n},i.prototype.getMapType=function(){switch(this.type()){case"terrain":return google.maps.MapTypeId.TERRAIN;case"road":return google.maps.MapTypeId.ROADMAP;case"satellite":return google.maps.MapTypeId.SATELLITE;case"hybrid":return google.maps.MapTypeId.HYBRID;default:return google.maps.MapTypeId.ROADMAP}},i.prototype.getMapOptions=function(){return{panControl:this.panControl(),zoomControl:this.zoomControl(),mapTypeControl:this.mapTypeControl(),scaleControl:this.scaleControl(),streetViewControl:this.streetViewControl(),overviewMapControl:this.overviewMapControl(),overviewMapControlOptions:{opened:!0}}},i.prototype.size=function(e){var n=t.prototype.size.apply(this,arguments);return arguments.length&&this._googleMapNode&&(this._googleMapNode.style({width:e.width+"px",height:e.height+"px"}),google.maps.event.trigger(this._googleMap,"resize")),n},i.prototype.enter=function(n,i){t.prototype.enter.apply(this,arguments),this._googleMapNode=i.append("div").style({width:this.width()+"px",height:this.height()+"px"}),this._googleMap=new google.maps.Map(this._googleMapNode.node(),{zoom:this.zoom(),center:new google.maps.LatLng(this.centerLat(),this.centerLong()),mapTypeId:this.getMapType(),disableDefaultUI:!0}),this._overlay=new r(this._googleMap,this._worldSurface,this._viewportSurface),this._circleMap=e.map([]),this._pinMap=e.map([]),this._prevCenterLat=this.centerLat(),this._prevCenterLong=this.centerLong(),this._prevZoom=this.zoom()},i.prototype.update=function(e,t){this._googleMap.setMapTypeId(this.getMapType()),this._googleMap.setOptions(this.getMapOptions());if(this._prevCenterLat!==this.centerLat()||this._prevCenterLong!==this.centerLong())this._googleMap.setCenter(new google.maps.LatLng(this.centerLat(),this.centerLong())),this._prevCenterLat=this.centerLat(),this._prevCenterLong=this.centerLong();this._prevZoom!==this.zoom()&&(this._googleMap.setZoom(this.zoom()),this._prevZoom=this.zoom()),this.updateCircles(),this.updatePins()},i.prototype.updateCircles=function(){function t(e){return e[0]+"_"+e[1]}var n=[],r=[],i=e.map(this._circleMap.keys(),function(e){return e});this.data().forEach(function(e){i.remove(t(e)),e[3]&&!this._circleMap.has(t(e))?n.push(e):e[3]&&this._circleMap.has(t(e))?r.push(e):!e[3]&&this._circleMap.has(t(e))&&i.set(t(e),!0)},this),n.forEach(function(e){var n=this.createCircle(e[0],e[1],e[3],"");this._circleMap.set(t(e),n)},this),r.forEach(function(e){},this);var s=this;i.forEach(function(e){s._circleMap.get(e).setMap(null),s._circleMap.remove(e)})},i.prototype.updatePins=function(){function t(e){return e[0]+"_"+e[1]}var n=[],r=[],i=e.map(this._pinMap.keys(),function(e){return e});this.data().forEach(function(e){i.remove(t(e)),e[2]&&!this._pinMap.has(t(e))?n.push(e):e[2]&&this._pinMap.has(t(e))?r.push(e):!e[2]&&this._pinMap.has(t(e))&&i.set(t(e),!0)},this),n.forEach(function(e){var n=this.createMarker(e[0],e[1],e[2],"");this._pinMap.set(t(e),n)},this),r.forEach(function(e){this._pinMap.get(t(e)).setIcon(this.createIcon(e[2]))},this);var s=this;i.forEach(function(e){s._pinMap.get(e).setMap(null),s._pinMap.remove(e)})},i.prototype.createIcon=function(e){return{path:"M 0,0 C -2,-20 -10,-22 -10,-30 A 10,10 0 1,1 10,-30 C 10,-22 2,-20 0,0 z M -2,-30",fillColor:e.fillColor,fillOpacity:e.fillOpacity||.8,scale:.5,strokeColor:e.strokeColor||"black",strokeWeight:.25}},i.prototype.createMarker=function(e,t,n){return new google.maps.Marker({position:new google.maps.LatLng(e,t),animation:google.maps.Animation.DROP,title:n.title||"",icon:this.createIcon(n),map:this._googleMap})},i.prototype.createCircle=function(e,t,n){return new google.maps.Circle({center:new google.maps.LatLng(e,t),radius:16093*n.radius/10,fillColor:n.fillColor||"red",strokeColor:n.strokeColor||n.fillColor||"black",strokeWeight:.5,map:this._googleMap})},i}),function(e,t){typeof define=="function"&&define.amd?define("src/map/GMapGraph",["./GMap","../graph/Graph","../graph/Edge","../common/Shape"],t):e.map_GMapGraph=t(e.map_GMap,e.graph_Graph,e.graph_Edge,e.common_Shape)}(this,function(e,t,n,r){function i(){e.call(this)}return i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype._class+=" map_GMapGraph",i.prototype.testData=function(){return this.data([[37.665074,-122.384375,{fillColor:"green"},null,.234],[32.69068,-117.17854,null,null,.234],[39.709455,-104.969859,null,null,.234],[41.244123,-95.96161,null,null,.234],[32.68898,-117.19204,null,null,.234],[45.78649,-108.5266,null,null,.234],[45.79618,-108.535652,null,null,.234],[45.77432,-108.49437,null,null,.234],[45.777062,-108.549835,{fillColor:"red"},null,.234]]),this},i.prototype.enter=function(){e.prototype.enter.apply(this,arguments);var i=(new t).layout("None"),s=i.render,o=this;i.render=function(){var e=[],t=[],i=null;o.data().forEach(function(s){var u=o._viewportSurface.project(s[0],s[1]),a=(new r).shape("circle").radius(3).data(s).pos(u);e.push(a),i&&t.push((new n).sourceVertex(i).targetVertex(a).targetMarker("arrowHead")),i=a}),this.data({vertices:e,edges:t}),s.apply(this,arguments),this.graphData.nodeValues().forEach(function(e){var t=o._viewportSurface.project(e._data[0],e._data[1]);t.x-=o.width()/2,t.y-=o.height()/2,e.move(t)}),this.graphData.edgeValues().forEach(function(e){e.points([])})},this._viewportSurface.widget(i)},i.prototype.zoomTo=function(e){var t=0,n=new google.maps.LatLngBounds;return e.forEach(function(e){var r=new google.maps.LatLng(e.geo_lat,e.geo_long);n.extend(r),++t}),t&&(this._googleMap.setCenter(n.getCenter()),this._googleMap.fitBounds(n),this._googleMap.getZoom()>12&&this._googleMap.setZoom(12)),this},i.prototype.zoomToFit=function(){return this.zoomTo(this.graphData.nodeValues().map(function(e){return e._data}))},i}),function(e,t){typeof define=="function"&&define.amd?define("src/map/GMapHeat",["./GMap","../other/HeatMap"],t):e.map_GMapHeat=t(e.map_GMap,e.other_HeatMap)}(this,function(e,t){function n(){e.call(this)}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype._class+=" map_GMapHeat",n.prototype.testData=function(){return this.data([[37.665074,-122.384375,null,null,.234],[32.69068,-117.17854,null,null,.234],[39.709455,-104.969859,null,null,.234],[41.244123,-95.96161,{fillColor:"green"},null,.234],[32.68898,-117.19204,null,null,.234],[45.78649,-108.5266,null,null,.234],[45.79618,-108.535652,{fillColor:"red"},null,.234],[45.77432,-108.49437,null,null,.234],[45.777062,-108.549835,null,null,.234]]),this},n.prototype.enter=function(){e.prototype.enter.apply(this,arguments);var n=new t,r=n.render,i=this;n.render=function(){this.data(i.data().map(function(e){var t=i._viewportSurface.project(e[0],e[1]);return[t.x,t.y,e[4]]})),r.apply(this,arguments)},this._viewportSurface.widget(n)},n}),function(e,t){typeof define=="function"&&define.amd?define("src/map/TestHeatMap",["../layout/Layered","../layout/AbsoluteSurface","./ChoroplethStates","../other/HeatMap"],t):e.map_TestHeatMap=t(e.layout_Layered,e.layout_AbsoluteSurface,e.map_ChoroplethStates,e.other_HeatMap)}(this,function(e,t,n,r){function i(t){e.call(this)}return i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype._class+=" map_TestHeatMap",i.prototype.testData=function(){var e=[[37.665074,-122.384375,.234],[32.69068,-117.17854,.234],[39.709455,-104.969859,.234],[41.244123,-95.96161,.234],[32.68898,-117.19204,.234],[45.78649,-108.5266,.234],[45.79618,-108.535652,.234],[45.77432,-108.49437,.234],[45.777062,-108.549835,.234]],i=(new n).testData(),s=new r,o=s.render;return s.render=function(){this.data(e.map(function(e){var t=i.project(e[0],e[1]);return[t[0],t[1],e[2]]})),o.apply(this,arguments)},this.addLayer((new t).widget(i)).addLayer((new t).widget(s)),this},i}),function(e){var t=document,n="appendChild",r="styleSheet",i=t.createElement("style");i.type="text/css",t.getElementsByTagName("head")[0][n](i),i[r]?i[r].cssText=e:i[n](t.createTextNode(e))}(".noFill{fill:whitesmoke;stroke:none}.map_Choropleth .zoom{stroke:none;fill:none;pointer-events:all}.map_Choropleth path{cursor:pointer;fill:whitesmoke;stroke:#6d6e71;stroke-width:.125px;stroke-linejoin:round;stroke-linecap:round;vector-effect:non-scaling-stroke}.map_Choropleth path.selected{stroke:red;stroke-width:1.5px}.map_Choropleth path.over{stroke:orange;stroke-width:1.5px}.map_GMap .marker{fill:#656565;stroke:none;stroke-width:1px}.map_GMap .zoom{fill:none;pointer-events:all}.gm-style img{max-width:none}.gm-style label{width:auto;display:inline}"),define("hpcc-viz-map",function(){});