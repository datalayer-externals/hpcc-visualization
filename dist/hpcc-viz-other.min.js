!function(t,e){"function"==typeof define&&define.amd?define("other/Audio.js",["d3","../common/HTMLWidget"],e):t.other_Audio=e(t.d3,t.common_HTMLWidget)}(this,function(t,e){function o(){e.call(this),this._tag="audio",this._sections={}}return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype._class+=" other_Audio",o.prototype.publish("source","","string","Audio Source"),o.prototype.section=function(t,e,o,i){return arguments.length?1===arguments.length?this._sections[t]:(this._sections[t]={label:t,offset:e,beatLength:o,beatCount:i,endOffset:e+i*o},this):this._sections},o.prototype.getType=function(t){switch(t){case"mp3":return"audio/mpeg; codecs='mp3'";case"ogg":return"audio/ogg; codecs='vorbis'"}return""},o.prototype.enter=function(t,e){var o=this;e.on("play",function(t){o.onPlay(t)})},o.prototype.update=function(t,e){var o=e.selectAll("source").data(this.source(),function(t){return t});o.enter().append("source").attr("src",function(t){return t})},o.prototype.createTimer=function(e,o,i){var r=this;t.timer(function(){return r.onTick(e.label,i,e),!0},i*e.beatLength,o+e.offset)},o.prototype.onTick=function(t,e,o){},o.prototype.onPlay=function(t){var e=Date.now();for(var o in this._sections)for(var i=this._sections[o],r=0;r<i.beatCount;++r)this.createTimer(i,e,r)},o.prototype.play=function(t){var e=this;this._element.on("canplaythrough",function(t){e.node().play()}),this.node().load()},o}),"function"==typeof define&&define.amd&&define("css",[],function(){return{load:function(t,e,o){o()}}}),function(t,e){"function"==typeof define&&define.amd?define("other/AutoCompleteText.js",["../common/HTMLWidget","autoComplete","css!./AutoCompleteText","css!autoComplete"],e):t.other_AutoCompleteText=e(t.common_HTMLWidget,t.autoComplete)}(this,function(t,e){function o(){t.call(this),this._tag="div"}return o.prototype=Object.create(t.prototype),o.prototype.constructor=o,o.prototype._class+=" other_AutoCompleteText",o.prototype.publish("label","Label: ","string","Label for AutoCompleteText"),o.prototype.publish("textboxWidth",null,"number","width of textbox",null,{optional:!0}),o.prototype.publish("placeholder","Search...","string","Placeholder for AutoCompleteText"),o.prototype.publish("valueColumn",null,"set","Select column for autocomplete",function(){return this.columns()},{optional:!0}),o.prototype.publish("textColumn",null,"set","Select value(s)",function(){return this.columns()},{optional:!0}),o.prototype.publish("minCharsText",1,"number","Size of multiAutoCompleteText box"),o.prototype.autoCompleteTextData=function(t,e){var o=this._db.rollupView([this.textColumn(),this.valueColumn()]);return o.entries().map(function(t,e){return{idx:e,text:t.key,value:t.values.length?t.values[0].key:"",origRow:t.values.length&&t.values[0].values.length?t.values[0].values[0]:[]}},this)},o.prototype.enter=function(e,o){t.prototype.enter.apply(this,arguments),this._span=o.append("span"),this._label=this._span.append("label").attr("for",this.id()+"_input"),this._input=this._span.append("input").attr("id",this.id()+"_input").attr("name",this.id()+"_input_name").attr("type","text").attr("placeholder",this.placeholder())},o.prototype.update=function(o,i){if(t.prototype.update.apply(this,arguments),this._label.text(this.label()),this._input.style("width",this.textboxWidth_exists()?this.textboxWidth()+"px":null),this._prevMinCharsText!==this.minCharsText()){this._prevMinCharsText=this.minCharsText(),this._autoComplete&&this._autoComplete.destroy();var r=this;this._autoComplete=new e({selector:"#"+this.id()+"_input",minChars:this.minCharsText(),delay:150,offsetLeft:0,offsetTop:1,source:function(t,e){var o=r._db.fieldByLabel(r.textColumn());if(o){t=t.toLowerCase();var i=r.autoCompleteTextData().filter(function(e){return e.origRow[o.idx].toLowerCase().indexOf(t)>=0}).map(function(t){return{text:t.origRow[o.idx],rowIdx:t.idx}});e(i)}},renderItem:function(t,e){e=e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var o=new RegExp("("+e.split(" ").join("|")+")","gi");return'<div class="autocomplete-suggestion" data-val="'+t.text+'" data-row-idx="'+t.rowIdx+'">'+t.text.replace(o,"<b>$1</b>")+"</div>"},onSelect:function(t,e,o){var i=+o.getAttribute("data-row-idx"),n=r.autoCompleteTextData()[i];r.click(r.rowToObj(n.origRow),r.valueColumn(),!0)}})}},o.prototype.exit=function(e,o){this._autoComplete&&this._autoComplete.destroy(),this._span.remove(),t.prototype.exit.apply(this,arguments)},o.prototype.click=function(t,e,o){console.log("Click:  "+JSON.stringify(t)+", "+e+", "+o)},o}),function(t,e){"function"==typeof define&&define.amd?define("other/CalendarHeatMap.js",["d3","../common/HTMLWidget","../common/Palette","../common/Utility","css!./CalendarHeatMap"],e):t.other_CalendarHeatMap=e(t.d3,t.common_HTMLWidget,t.common_Palette,t.common_Utility)}(this,function(t,e,o,i){function r(t){e.call(this),i.SimpleSelectionMixin.call(this)}return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype._class+=" other_CalendarHeatMap",r.prototype.mixin(i.SimpleSelectionMixin),r.prototype._palette=o.rainbow("default"),r.prototype.publish("paletteID","YlOrRd","set","Palette ID",r.prototype._palette["switch"](),{tags:["Basic","Shared"]}),r.prototype.publish("dateColumn",null,"set","Date Column",function(){return this.columns()},{optional:!0}),r.prototype.publish("datePattern","%Y-%m-%d","string","Date Pattern"),r.prototype.publish("aggrType",null,"set","Aggregation Type",[null,"mean","median","sum","min","max"],{optional:!0}),r.prototype.publish("aggrColumn",null,"set","Aggregation Field",function(){return this.columns()},{optional:!0,disable:function(t){return!t.aggrType()}}),r.prototype.publish("aggrDeltaColumn",null,"set","Aggregation Field",function(){return this.columns()},{optional:!0,disable:function(t){return!t.aggrType()}}),r.prototype.calendarData=function(){var e=t.time.format(this.datePattern()).parse,o=this.aggrDeltaColumn()?t.format(".1%"):t.format("s");return(this._prevDateColumn!==this.dateColumn()||this._prevAggrType!==this.aggrType()||this._prevAggrColumn!==this.aggrColumn()||this._prevAggrDeltaColumn!==this.aggrDeltaColumn())&&(this._prevDateColumn=this.dateColumn(),this._prevAggrType=this.aggrType(),this._prevAggrColumn=this.aggrColumn(),this._prevAggrDeltaColumn=this.aggrDeltaColumn(),this._view=this._db.aggregateView([this.dateColumn()],this.aggrType(),this.aggrColumn(),this.aggrDeltaColumn())),this._view.entries().map(function(t){return t.dateKey=e(t.key),t.formattedValues=o(t.values.aggregate),t.origRows=o(t.values),t})},r.prototype.calcDelta=function(t){return(t.Close-t.Open)/t.Open},r.prototype.enter=function(o,i){e.prototype.enter.apply(this,arguments),t.select(o.parentNode).style("overflow","scroll"),this._selection.widgetElement(i)},r.prototype.update=function(o,i){function r(e){var o=new Date(e.getFullYear(),e.getMonth()+1,0),i=e.getDay(),r=t.time.weekOfYear(e),n=o.getDay(),s=t.time.weekOfYear(o);return"M"+(r+1)*a+","+i*a+"H"+r*a+"V"+7*a+"H"+s*a+"V"+(n+1)*a+"H"+(s+1)*a+"V0H"+(r+1)*a+"Z"}e.prototype.update.apply(this,arguments),this._palette=this._palette["switch"](this.paletteID());var n=this.width(),a=n/12/5,s=8*a,l=this.calendarData(),p=t.map(l,function(t){return t.dateKey}),u=t.extent(l,function(t){return t.dateKey.getFullYear()}),c=this,h=i.selectAll("svg").data(t.range(u[0],u[1]+1));h.enter().append("svg").each(function(e){var o=t.select(this),i=o.append("g");i.append("text").style("text-anchor","middle"),i.append("g").attr("class","days"),i.append("g").attr("class","months")}),h.attr("width",n).attr("height",s),h.select("g").attr("transform","translate("+(n-53*a)/2+","+(s-7*a-1)+")"),h.select("text").attr("transform","translate(-6,"+3.5*a+")rotate(-90)").text(function(t){return t}),h.exit().remove();var d=t.extent(l,function(t){return t.values.aggregate});if(this.aggrDeltaColumn()){var f=Math.max(Math.abs(d[0]),Math.abs(d[1]));d=[-f,f]}var g=h.select(".days").selectAll(".day").data(function(e){return t.time.days(new Date(e,0,1),new Date(e+1,0,1))});g.enter().append("rect").attr("class","day").call(this._selection.enter.bind(this._selection)).on("click",function(t){var e=p.get(t);e&&e.values&&e.values&&e.values.length&&c.click(c.rowToObj(e.values[0]),c.dateColumn(),c._selection.selected(this))}).on("dblclick",function(t){var e=p.get(t);e&&e.values&&e.values&&e.values.length&&c.dblclick(c.rowToObj(e.values[0]),c.dateColumn(),c._selection.selected(this))}).append("title"),g.attr("x",function(e){return t.time.weekOfYear(e)*a}).attr("y",function(t){return t.getDay()*a}).attr("width",a).attr("height",a),g.select("title").text(function(t){return t}),g.filter(function(t){return p.has(t)}).style("fill",function(t){var e=p.get(t);return e&&e.values&&e.values.aggregate?c._palette(e.values.aggregate,d[0],d[1]):null}).select("title").text(function(t){var e=p.get(t);return e.key+": "+e.formattedValues}),g.exit().remove();var m=h.select(".months").selectAll(".month").data(function(e){return t.time.months(new Date(e,0,1),new Date(e+1,0,1))});m.enter().append("path").attr("class","month"),m.attr("d",r),m.exit().remove()},r.prototype.exit=function(t,o){e.prototype.exit.apply(this,arguments)},r.prototype.click=function(t,e,o){console.log("Click:  "+JSON.stringify(t)+", "+e+", "+o)},r.prototype.dblclick=function(t,e,o){console.log("Double click:  "+JSON.stringify(t)+", "+e+", "+o)},r}),function(t,e){"function"==typeof define&&define.amd?define("other/Comms",["../common/Utility"],e):t.other_Comms=e(t.common_Utility)}(this,function(t){function e(t){if(void 0===t||null===t)return null;if(!t.trim)return t.Row?o(t.Row):t;var e=t.trim();return""!==e&&!isNaN(e)&&(e.length<=1||"0"!==e[0]||"."===e[1])?Number(e):e}function o(t){for(var o in t)t[o]=e(t[o]);return t}function i(){this._protocol="http:",this._hostname="localhost"}function r(t){this._mappings=t,this._reverseMappings={};for(var e in this._mappings){this._reverseMappings[e]={};for(var o in this._mappings[e])this._reverseMappings[e][this._mappings[e][o]]=o}}function n(){i.call(this),this._proxyMappings={},this._mappings=new r({}),this._timeout=g,this._hipieResults={}}function a(){n.call(this)}function s(t){for(var e in t){if(t[e].Row&&t[e].Row instanceof Array)return t;var o;if("string"!=typeof t[e]&&(o=s(t[e])),o)return o}return null}function l(t){for(var e in t){if(t[e].Exception&&t[e].Exception instanceof Array)return t[e];var o=l(t[e]);if(o)return o}return null}function p(){n.call(this),this._port="8002",this._target="",this._query=""}function u(){n.call(this),this._port="8010",this._wuid="",this._jobname="",this._sequence=null,this._resultName=null,this._fetchResultNamesPromise=null,this._fetchResultPromise={},this._resultNameCache={},this._resultNameCacheCount=0}function c(){n.call(this),this._port="8010",this._wuid=null}function h(){n.call(this)}function d(){u.call(this)}function f(){d.call(this)}var g=60;i.prototype.url=function(t){if(!arguments.length)return this._url;this._url=t;var e=document.createElement("a");e.href=this._url,e.href=e.href;var o={};if(e.search.length){var i=e.search;"?"===i[0]&&(i=i.substring(1)),i=i.split("&"),i.map(function(t){var e=t.split("=");o[decodeURIComponent(e[0])]=decodeURIComponent(e[1])})}for(this._protocol=e.protocol,this._hostname=e.hostname,this._port=e.port,this._pathname=e.pathname;this._pathname.length&&"/"===this._pathname[0];)this._pathname=this._pathname.substring(1);return this._search=e.search,this._params=o,this._hash=e.hash,this._host=e.host,this},i.prototype.protocol=function(t){return arguments.length?(this._protocol=t,this):this._protocol},i.prototype.hostname=function(t){return arguments.length?(this._hostname=t,this):this._hostname},i.prototype.port=function(t){return arguments.length?(this._port=t,this):this._port},i.prototype.pathname=function(t){return arguments.length?(this._pathname=t,this):this._pathname},i.prototype.param=function(t){return this._params[t]},i.prototype.isWsWorkunits=function(){return this._pathname.toLowerCase().indexOf("wsworkunits")>=0||this._params.Wuid},i.prototype.isWorkunitResult=function(){return this.isWsWorkunits()&&(this._params.Sequence||this._params.ResultName)},i.prototype.isWsEcl=function(){return this._pathname.toLowerCase().indexOf("wsecl")>=0||this._params.QuerySetId&&this._params.Id},i.prototype.isWsWorkunits_GetStats=function(){return this._pathname.toLowerCase().indexOf("wsworkunits/wugetstats")>=0&&this._params.WUID},i.prototype.getUrl=function(t){return t=t||{},(void 0!==t.protocol?t.protocol:this._protocol)+"//"+(void 0!==t.hostname?t.hostname:this._hostname)+":"+(void 0!==t.port?t.port:this._port)+"/"+(void 0!==t.pathname?t.pathname:this._pathname)},r.prototype.contains=function(e,o){return t.exists(e+"."+o,this._mappings)},r.prototype.mapResult=function(t,e){var o=this._mappings[e];o&&(t[e]=t[e].map(function(t){var e=[];if(o.x&&o.x instanceof Array){e=[];for(var i=0;i<o.x.length;++i)e.push(t[o.y[i]])}else for(var r in o)"label"===o[r]?e[0]=t[r]:"weight"===o[r]&&(e[1]=t[r]);return e},this))},r.prototype.mapResponse=function(t){for(var e in t)this.mapResult(t,e)},n.prototype=Object.create(i.prototype),n.prototype.hipieResults=function(t){if(!arguments.length)return this._hipieResults;this._hipieResultsLength=0,this._hipieResults={};var e=this;return t.forEach(function(t){e._hipieResultsLength++,e._hipieResults[t.id]=t}),this};var m=function(t){var e=[];for(var o in t)if(t.hasOwnProperty(o)){var i=t[o];void 0!==i&&null!==i&&e.push(encodeURIComponent(o)+"="+encodeURIComponent(i))}return e.join("&")},y=function(t,e,o){return new Promise(function(i,r){function n(){delete window[l],document.body.removeChild(p)}var a=1e3*o,s=5e3,l="jsonp_callback_"+Math.round(999999*Math.random());window[l]=function(t){a=0,n(),i(t)};var p=document.createElement("script");p.src=t+(t.indexOf("?")>=0?"&":"?")+"jsonp="+l+"&"+m(e),document.body.appendChild(p);var u=setInterval(function(){0>=a?clearInterval(u):(a-=s,0>=a?(clearInterval(u),console.log("Request timeout:  "+p.src),n(),r(Error("Request timeout:  "+p.src))):console.log("Request pending ("+a/1e3+" sec):  "+p.src))},s)})};return n.prototype.jsonp=function(t,e,o){for(var r in this._proxyMappings){var n=t.split(r),a=n[0];if(n.length>1){var s=(new i).url(t);t=a+this._proxyMappings[r],e.IP=s.hostname(),e.PORT=s.port(),n.length>0&&(e.PATH=n[1]);break}}return y(t,e,this.timeout())},n.prototype.ajax=function(t,e,o){return new Promise(function(i,r){var n=e;"GET"===t&&o&&(n+="?"+m(o));var a=new XMLHttpRequest;a.onload=function(t){this.status>=200&&this.status<300?i(JSON.parse(this.response)):r(Error(this.statusText))},a.onerror=function(){r(Error(this.statusText))},a.open(t,n),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),"GET"===t?a.send():(a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(m(o)))})},n.prototype.get=function(t,e){return this.ajax("GET",t,e)},n.prototype.post=function(t,e){return this.ajax("POST",t,e)},n.prototype.mappings=function(t){return arguments.length?(this._mappings=new r(t),this):this._mappings},n.prototype.proxyMappings=function(t){return arguments.length?(this._proxyMappings=t,this):this._proxyMappings},n.prototype.timeout=function(t){return arguments.length?(this._timeout=t||g,this):this._timeout},a.prototype=Object.create(n.prototype),a.prototype.cacheCalls=function(t){return arguments.length?(this._cacheCalls=t,this):this._cacheCalls},a.prototype.call=function(t,e){var o=this._url+(this._url.indexOf("?")>=0?"&":"?")+m(t);if(this._cacheCalls){var i=this;return new Promise(function(t,i){var r=JSON.parse(localStorage.getItem("hpcc.viz."+o));if(!r)throw Error("not cached");e&&(console.log("Deprecated:  callback, use promise (Basic.prototype.call)"),e(r)),t(r)})["catch"](function(t){return i.get(o).then(function(t){return localStorage.setItem("hpcc.viz."+o,JSON.stringify(t)),e&&(console.log("Deprecated:  callback, use promise (Basic.prototype.call)"),e(t)),t})})}return localStorage.removeItem("hpcc.viz."+o),this.get(o).then(function(t){return e&&(console.log("Deprecated:  callback, use promise (Basic.prototype.call)"),e(t)),t})},p.prototype=Object.create(n.prototype),p.prototype.url=function(t){var e=n.prototype.url.apply(this,arguments);if(arguments.length){this._port="8010"===this._port?"8002":this._port;for(var o in this._params)switch(o){case"QuerySetId":this.target(this._params[o]);break;case"Id":this.query(this._params[o])}var i,r;this._target&&this._query||(i=this._pathname.split("/query/"),i.length>=2&&(r=i[1].split("/"),r.length>=2&&(this.target(r[0]),this.query(r[1]))))}return e},p.prototype.target=function(t){return arguments.length?(this._target=t,this):this._target},p.prototype.query=function(t){return arguments.length?(this._query=t,this):this._query},p.prototype.constructUrl=function(){return n.prototype.getUrl.call(this,{pathname:"WsEcl/submit/query/"+this._target+"/"+this._query+"/json"})},p.prototype.call=function(t,e,i){t=t||{},t.target=t.target||this._target,t.query=t.query||this._query;var r=this,n=this.getUrl({pathname:"WsEcl/submit/query/"+t.target+"/"+t.query+"/json"});return this.jsonp(n,e).then(function(t){var e=s(t);if(e||(e=l(t)),t=e,t.Exception)throw Error(t.Exception.reduce(function(t,e,o,i){return t.length&&(t+="\n"),t+e.Source+" "+e.Code+":  "+e.Message},""));for(var n in t)t[n].Row&&(t[n]=t[n].Row.map(o));return r._mappings.mapResponse(t),i&&(console.log("Deprecated:  callback, use promise (WsECL.prototype.call)"),i(t)),t})},p.prototype.send=function(t,e){return this.call({target:this._target,query:this._query},t,e)},u.prototype=Object.create(n.prototype),u.prototype.url=function(t){var e=n.prototype.url.apply(this,arguments);if(arguments.length){for(var o in this._params)switch(o){case"Wuid":this.wuid(this._params[o]);break;case"ResultName":this.resultName(this._params[o]);break;case"Sequence":this.sequence(this._params[o])}if(!this._wuid){var i=this._url.split("/res/");if(i.length>=2){var r=i[1].split("/");this.wuid(r[0])}}}return e},u.prototype.wuid=function(t){return arguments.length?(this._wuid=t,this):this._wuid},u.prototype.jobname=function(t){return arguments.length?(this._jobname=t,this):this._jobname},u.prototype.sequence=function(t){return arguments.length?(this._sequence=t,this):this._sequence},u.prototype.resultName=function(t){return arguments.length?(this._resultName=t,this):this._resultName},u.prototype.appendParam=function(t,e,o){return e?(o&&(o+="&"),o+t+"="+e):o},u.prototype.constructUrl=function(){var t=n.prototype.getUrl.call(this,{pathname:"WsWorkunits/res/"+this._wuid+"/"}),e="";return e=this.appendParam("ResultName",this._resultName,e),t+(e?"?"+e:"")},u.prototype._fetchResult=function(t,e,i){if(t=t||{},!this._fetchResultPromise[t.resultname]){t._start=t._start||0,t._count=t._count||-1;var r=this.getUrl({pathname:"WsWorkunits/WUResult.json"}),n={Wuid:t.wuid,ResultName:t.resultname,SuppressXmlSchema:!0,Start:t._start,Count:t._count};this._resultNameCache[t.resultname]={};var a=this;this._fetchResultPromise[t.resultname]=this.jsonp(r,n).then(function(r){for(var n in r){if(!r[n].Result)throw"No result found.";a._total=r[n].Total,r=r[n].Result;for(var s in r){r=r[s].Row.map(o);break}break}return a._resultNameCache[t.resultname]=r,i||a._mappings.mapResult(a._resultNameCache,t.resultname),e&&(console.log("Deprecated:  callback, use promise (WsWorkunits.prototype._fetchResult)"),e(a._resultNameCache[t.resultname])),a._resultNameCache[t.resultname]})}return this._fetchResultPromise[t.resultname]},u.prototype.fetchResult=function(t,e,o){if(t.wuid)return this._fetchResult(t,e,o);if(t.jobname){var i=this;return this.WUQuery(t,function(r){return t.wuid=r[0].Wuid,i._fetchResult(t,e,o)})}},u.prototype.WUQuery=function(e,o){var i=this.getUrl({pathname:"WsWorkunits/WUQuery.json"}),r={Jobname:r.jobname,Count:1};return this._resultNameCache={},this._resultNameCacheCount=0,this.jsonp(i,r).then(function(e){if(!t.exists("WUQueryResponse.Workunits.ECLWorkunit",e))throw"No workunit found.";return e=e.WUQueryResponse.Workunits.ECLWorkunit,o&&(console.log("Deprecated:  callback, use promise (WsWorkunits.prototype.WUQuery)"),o(e)),e})},u.prototype.fetchResultNames=function(e){if(!this._fetchResultNamesPromise){var o=this.getUrl({pathname:"WsWorkunits/WUInfo.json"}),i={Wuid:this._wuid,TruncateEclTo64k:!0,IncludeExceptions:!1,IncludeGraphs:!1,IncludeSourceFiles:!1,IncludeResults:!0,IncludeResultsViewNames:!1,IncludeVariables:!1,IncludeTimers:!1,IncludeResourceURLs:!1,IncludeDebugValues:!1,IncludeApplicationValues:!1,IncludeWorkflows:!1,IncludeXmlSchemas:!1,SuppressResultSchemas:!0};this._resultNameCache={},this._resultNameCacheCount=0;var r=this;this._fetchResultNamesPromise=this.jsonp(o,i).then(function(n){return t.exists("WUInfoResponse.Workunit.Archived",n)&&n.WUInfoResponse.Workunit.Archived&&console.log("WU is archived:  "+o+" "+JSON.stringify(i)),t.exists("WUInfoResponse.Workunit.Results.ECLResult",n)&&n.WUInfoResponse.Workunit.Results.ECLResult.map(function(t){r._resultNameCache[t.Name]=[],++r._resultNameCacheCount}),e&&(console.log("Deprecated:  callback, use promise (WsWorkunits.prototype.fetchResultNames)"),e(r._resultNameCache)),r._resultNameCache})}return this._fetchResultNamesPromise},u.prototype.fetchResults=function(t,e){var o=this;return this.fetchResultNames().then(function(i){var r=[];for(var n in o._resultNameCache)r.push(o.fetchResult({wuid:o._wuid,resultname:n},null,e));return Promise.all(r).then(function(e){return t&&(console.log("Deprecated:  callback, use promise (WsWorkunits.prototype.fetchResults)"),t(o._resultNameCache)),o._resultNameCache})})},u.prototype.postFilter=function(t,e){var o={};for(var i in e)o[i]=e[i].filter(function(e,o){for(var i in t)if(void 0!==e[i]&&void 0!==t[i]&&e[i]!=t[i])return!1;return!0});return this._mappings.mapResponse(o),o},u.prototype.send=function(t,e){var o=this;this._resultNameCacheCount?e(o.postFilter(t,this._resultNameCache)):this.fetchResults(function(i){e(o.postFilter(t,i))},!0)},c.prototype=Object.create(n.prototype),c.prototype.url=function(t){var e=n.prototype.url.apply(this,arguments);if(arguments.length)for(var o in this._params)switch(o){case"WUID":this.wuid(this._params[o])}return e},c.prototype.wuid=function(t){return arguments.length?(this._wuid=t,this):this._wuid},c.prototype.constructUrl=function(){return n.prototype.getUrl.call(this,{pathname:"WsWorkunits/WUGetStats?WUID="+this._wuid})},c.prototype.send=function(e,o){var i=this.getUrl({pathname:"WsWorkunits/WUGetStats.json?WUID="+this._wuid});return this.jsonp(i,e).then(function(e){return t.exists("WUGetStatsResponse.Statistics.WUStatisticItem",e)?(o&&(console.log("Deprecated:  callback, use promise (WsWorkunits_GetStats.prototype.send)"),o(e.WUGetStatsResponse.Statistics.WUStatisticItem)),e.WUGetStatsResponse.Statistics.WUStatisticItem):(o&&(console.log("Deprecated:  callback, use promise (WsWorkunits_GetStats.prototype.send)"),o([])),[])})},h.prototype=Object.create(n.prototype),h.prototype.fetchResults=function(t,e){var i=this.getUrl({});this._resultNameCache={},this._resultNameCacheCount=0;var r=this;return this.jsonp(i,t).then(function(t){var i=s(t);if(i||(i=l(t)),t=i,t.Exception)throw Error(t.Exception.reduce(function(t,e,o,i){return t.length&&(t+="\n"),t+e.Source+" "+e.Code+":  "+e.Message},""));for(var n in t)t[n].Row&&(r._resultNameCache[n]=t[n].Row.map(o),++r._resultNameCacheCount);return e&&(console.log("Deprecated:  callback, use promise (HIPIERoxie.prototype.fetchResults)"),e(r._resultNameCache)),r._resultNameCache})},h.prototype.fetchResult=function(t,e){var o=this;return new Promise(function(i,r){e&&(console.log("Deprecated:  callback, use promise (HIPIERoxie.prototype.fetchResult)"),e(o._resultNameCache[t])),i(o._resultNameCache[t])})},h.prototype.call=function(t,e){var o=this;return this.fetchResults(t,e).then(function(t){var e={};for(var i in o._hipieResults){var r=o._hipieResults[i];e[r.id]=t[r.from]}return e})},d.prototype=Object.create(u.prototype),d.prototype.fetchResults=function(t){var e=this;return u.prototype.fetchResultNames.call(this).then(function(o){var i=[];for(var r in e._hipieResults){var n=e._hipieResults[r];i.push(e.fetchResult(n.from))}return Promise.all(i).then(function(o){return t&&(console.log("Deprecated:  callback, use promise (HIPIEWorkunit.prototype.fetchResults)"),t(e._resultNameCache)),e._resultNameCache})})},d.prototype.fetchResult=function(t,e){return u.prototype.fetchResult.call(this,{wuid:this._wuid,resultname:t}).then(function(t){return e&&(console.log("Deprecated:  callback, use promise (HIPIEWorkunit.prototype.fetchResult)"),e(t)),t})},d.prototype.call=function(t,e){function o(t){var e={};for(var o in t)void 0!==t[o+"_changed"]&&(e[o]={value:t[o]});var r={};for(var n in i._hipieResults){for(var a=i._hipieResults[n],s={},l=0;l<a.filters.length;++l){var p=a.filters[l];p.isRange()||(s[p.fieldid]=e[p.fieldid]||{value:void 0},s[p.fieldid].filter=p)}r[a.id]=i._resultNameCache[a.from].filter(function(t){for(var e in s)if(!s[e].filter.matches(t,s[e].value))return!1;return!0})}return r}var i=this;return!t.refresh&&this._resultNameCache&&this._resultNameCacheCount?new Promise(function(e,i){e(o(t))}):this.fetchResults(e).then(function(e){return o(t)})},f.prototype=Object.create(d.prototype),f.prototype.databomb=function(t){return arguments.length?(this._databomb=t,this):this._databomb},f.prototype.databombOutput=function(t,e){return arguments.length?(this._resultNameCacheCount++,this._databomb instanceof Array?this._resultNameCache[t]=this._databomb.map(o):this._resultNameCache[t]=this._databomb[t].map(o),this):void 0},f.prototype.fetchResults=function(t){var e=this;return new Promise(function(o,i){t&&(console.log("Deprecated:  callback, use promise (HIPIEDatabomb.prototype.fetchResults)"),t(e._resultNameCache)),o(e._resultNameCache)})},{Basic:a,ESPMappings:r,ESPUrl:i,WsECL:p,WsWorkunits:u,HIPIERoxie:h,HIPIEWorkunit:d,HIPIEDatabomb:f,createESPConnection:function(t){t=t||document.URL;var e=(new i).url(t);return e.isWsWorkunits_GetStats()?(new c).url(t):e.isWsWorkunits()?(new u).url(t):e.isWsEcl()?(new p).url(t):null},hookJsonp:function(t){y=t}}}),function(t,e){"function"==typeof define&&define.amd?define("other/ESP.js",["./Comms","../common/Utility"],e):t.other_ESP=e(t.other_Comms,t.common_Utility)}(this,function(t,e){function o(t){if(t.Row&&t.Row instanceof Array)return t.Row.map(o);if(t instanceof Object)for(var e in t)t[e]=o(t[e]);return t}function i(){t.Basic.call(this)}function r(t){i.call(this),this.url(t+"WsWorkunits/")}function n(t,e){i.call(this),this.url(t+"WsWorkunits/"),this._wuid=e}function a(t,e,o){i.call(this),this.url(t+"WUResult.json"),this._wuid=e,this._name=o,this._xmlSchema=null}function s(t,e){i.call(this),this.url(t+"WUResult.json"),this._logicalName=e,this._xmlSchema=null}function l(t,e){i.call(this);var o=t.split("/"),r=o.pop();"json"===r.toLowerCase()&&(r=o.pop()),this._queryName=r,this._resultName=e,this.url(o.join("/")+"/"+r+"/json")}function p(t){return t&&t.replace?t.replace(/ +$/,""):t}function u(t,e){return t.filter(function(t){for(var o in e)if(void 0!==t[o]&&p(e[o])!==p(t[o]))return!1;return!0})}function c(t){for(var e in t){if(t[e].Row&&t[e].Row instanceof Array)return t;var o=c(t[e]);if(o)return o}return null}function h(e,o,i){var r=(new t.ESPUrl).url(e);return 0===o.indexOf("http")?new l(o,i):0===o.indexOf("~")||o.indexOf("::")>=0?new s(r.getUrl({pathname:"WsWorkunits/"}),o):o?new a(r.getUrl({pathname:"WsWorkunits/"}),o,i):null}var d=!1,f={};return i.prototype=Object.create(t.Basic.prototype),i.prototype.jsonp=function(e,o){var i=JSON.stringify(o);return d&&f[e]&&f[e][i]?Promise.resolve(f[e][i]):t.Basic.prototype.jsonp.apply(this,arguments).then(function(t){return d&&(f[e]||(f[e]={}),f[e][i]=t),t})},r.prototype=Object.create(i.prototype),r.prototype.wuQuery=function(t){var e=this.getUrl({pathname:"WsWorkunits/WUQuery.json"}),o={Wuid:"",Type:"",Cluster:"",RoxieCluster:"",Owner:"",State:"",StartDate:"",EndDate:"",ECL:"",Jobname:"",LogicalFile:"",LogicalFileSearchType:"",After:"",Before:"",Count:"",PageSize:100,PageStartFrom:0,PageEndAt:"",LastNDays:"",Sortby:"",Descending:0,CacheHint:""};for(var i in t)o[i]=t[i];return this.jsonp(e,o).then(function(t){return t.WUQueryResponse&&t.WUQueryResponse.Workunits?t.WUQueryResponse.Workunits.ECLWorkunit:[]})},n.prototype=Object.create(i.prototype),n.prototype.wuInfo=function(t){var e=this.getUrl({pathname:"WsWorkunits/WUInfo.json"}),o={Wuid:this._wuid,TruncateEclTo64k:!0,IncludeExceptions:!1,IncludeGraphs:!1,IncludeSourceFiles:!1,IncludeResults:!1,IncludeResultsViewNames:!1,IncludeVariables:!1,IncludeTimers:!1,IncludeResourceURLs:!1,IncludeDebugValues:!1,IncludeApplicationValues:!1,IncludeWorkflows:!1,IncludeXmlSchemas:!1,SuppressResultSchemas:!0};for(var i in t)o[i]=t[i];return this.jsonp(e,o).then(function(i){if(d){var r={WUInfoResponse:{Workunit:{}}};for(var n in t){var a=n.substring(7);r.WUInfoResponse.Workunit[a]=i.WUInfoResponse.Workunit[a]}f[e][JSON.stringify(o)]=r}return i})},n.prototype.wuUpdate=function(t){var e=this.getUrl({pathname:"WsWorkunits/WUUpdate.json"}),o={Wuid:this._wuid};for(var i in t)o[i]=t[i];return this.post(e,o)},n.prototype.appData=function(t,e,o){return 2===arguments.length?this.wuInfo({IncludeApplicationValues:!0}).then(function(o){var i;return o.WUInfoResponse&&o.WUInfoResponse.Workunit&&o.WUInfoResponse.Workunit.ApplicationValues&&o.WUInfoResponse.Workunit.ApplicationValues.ApplicationValue&&o.WUInfoResponse.Workunit.ApplicationValues.ApplicationValue.filter(function(o){return o.Application===t&&o.Name===e}).forEach(function(t){i=t.Value}),i}):3===arguments.length?this.wuUpdate({"ApplicationValues.ApplicationValue.0.Application":t,"ApplicationValues.ApplicationValue.0.Name":e,"ApplicationValues.ApplicationValue.0.Value":o,"ApplicationValues.ApplicationValue.itemcount":1}):void 0},n.prototype.results=function(){var t=this;return this.wuInfo({IncludeResults:!0}).then(function(o){var i=[];return e.exists("WUInfoResponse.Workunit.Results.ECLResult",o)&&(i=o.WUInfoResponse.Workunit.Results.ECLResult.map(function(e){return new a(t.getUrl({pathname:"WsWorkunits/"}),t._wuid,e.Name)})),i})},n.prototype.result=function(t,e){return t=t||this._wuid,h(t,e)},a.prototype=Object.create(i.prototype),a.prototype.wuid=function(t){return arguments.length?(this._wuid=t,this):this._wuid},a.prototype.name=function(t){return arguments.length?(this._name=t,this):this._name},a.prototype.query=function(t,e){t=t||{},e=e||{};var i={Wuid:this._wuid,ResultName:this._name,SuppressXmlSchema:!0,Start:0,Count:-1};for(var r in t)i[r]=t[r];var n=0;for(var a in e)i["FilterBy.NamedValue."+n+".Name"]=a,i["FilterBy.NamedValue."+n+".Value"]=e[a],++n;n&&(i["FilterBy.NamedValue.itemcount"]=n);var s=this;return this.jsonp(this.url(),i).then(function(t){return t.WUResultResponse&&t.WUResultResponse.Result&&t.WUResultResponse.Result[s._name]?(d&&(f[s.url()][JSON.stringify(i)]={WUResultResponse:{Result:t.WUResultResponse.Result}}),s._xmlSchema=t.WUResultResponse.Result.XmlSchema,o(t.WUResultResponse.Result[s._name])):[]})},s.prototype=Object.create(i.prototype),s.prototype.query=function(t,e){t=t||{},e=e||{};var i={Cluster:"hthor",LogicalName:this._logicalName,SuppressXmlSchema:null!==this._xmlSchema,Start:0,Count:-1};for(var r in t)i[r]=t[r];var n=0;for(var a in e)i["FilterBy.NamedValue."+n+".Name"]=a,i["FilterBy.NamedValue."+n+".Value"]=e[a],++n;n&&(i["FilterBy.NamedValue.itemcount"]=n);var s=this;return this.jsonp(this.url(),i).then(function(t){return t.WUResultResponse&&t.WUResultResponse.Result&&t.WUResultResponse.Result.Row?(s._xmlSchema=t.WUResultResponse.Result.XmlSchema,o(t.WUResultResponse.Result.Row)):[]})},l.prototype=Object.create(i.prototype),l.prototype.query=function(t,e){t=t||{},e=e||{};var i={};for(var r in t)i[r]=t[r];for(var n in e)i[n]=e[n];var a=this;return this.jsonp(this.url(),i).then(function(t){if(t=c(t))if(a._resultName){if(t&&t[a._resultName]&&t[a._resultName].Row)return o(u(t[a._resultName].Row,e))}else for(var i in t)if(t[i].Row)return o(u(t[i].Row,e));return[]})},{enableCache:function(t){
return arguments.length?(d=t,t||(f={}),this):d},cache:function(t){return arguments.length?(f=t,this):f},WsWorkunits:r,Workunit:n,WUResult:a,createConnection:function(e){e=e||document.URL;var o=(new t.ESPUrl).url(e);if(o.isWsWorkunits()){var i=t.createESPConnection(e);if(i instanceof t.WsWorkunits&&i.wuid())return new n(i.getUrl({pathname:""}),i.wuid()).url(e)}return null},createResult:h,flattenResult:function(t,e){var o={columns:[],data:[]};if(t&&t.length){var i={};if(e&&e.length)e.forEach(function(t){i[t.value.toLowerCase()]=o.columns.length,o.columns.push(t.key)});else for(var r in t[0])i[r.toLowerCase()]=o.columns.length,o.columns.push(r);t.forEach(function(t,e){var r=[];for(var n in t)void 0!==i[n.toLowerCase()]&&(r[i[n.toLowerCase()]]=t[n]);o.data.push(r)})}return o}}}),function(t,e){"function"==typeof define&&define.amd?define("other/HeatMap.js",["d3","../common/CanvasWidget","simpleheat","../common/Palette"],e):t.other_HeatMap=e(t.d3,t.common_CanvasWidget,t.simpleheat,t.common_Palette)}(this,function(t,e,o,i){function r(){e.call(this)}return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype._palette=i.rainbow("default"),r.prototype._class+=" other_HeatMap",r.prototype.publish("radius",15,"number","Set point radius",null,{tags:["Basic"]}),r.prototype.publish("blur",15,"number","Set point blur",null,{tags:["Basic"]}),r.prototype.publish("max",1,"number","Set max data value",null,{tags:["Basic"]}),r.prototype.publish("gradient",{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},"object","Set gradient colors",null,{tags:["Basic"]}),r.prototype.publish("usePalette",!1,"boolean","If true, uses paletteID and colorCount to determine gradient",null,{tags:["Basic"]}),r.prototype.publish("colorCount",10,"number","Top left x-value",null,{tags:["Basic"]}),r.prototype.publish("paletteID","default","set","Palette ID",r.prototype._palette["switch"](),{tags:["Basic"]}),r.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),r.prototype.publish("topLeftX",null,"number","Top left x-value",null,{tags:["Basic"],optional:!0}),r.prototype.publish("topLeftY",null,"number","Top left y-value",null,{tags:["Basic"],optional:!0}),r.prototype.publish("bottomRightX",null,"number","Bottom right x-value",null,{tags:["Basic"],optional:!0}),r.prototype.publish("bottomRightY",null,"number","Bottom right y-value",null,{tags:["Basic"],optional:!0}),r.prototype.enter=function(t,i){e.prototype.enter.apply(this,arguments),this.resize(this._size),this._heat=o(t)},r.prototype.update=function(t,o){if(e.prototype.update.apply(this,arguments),this._palette=this._palette["switch"](this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id())),this.topLeftX_exists()&&this.topLeftY_exists()&&this.bottomRightX_exists()&&this.bottomRightY_exists()?this._heat.data(this.skewedData()):this._heat.data(this.data()),this.radius()&&this._heat.radius(this.radius(),this.blur()),this.usePalette()){for(var i={},r=1;r<=this.colorCount();r++){var n=r/this.colorCount();i[n]=this._palette(r,1,this.colorCount())}this._heat.defaultGradient=i,this._heat.gradient(i)}else this.gradient()&&(this._heat.defaultGradient=this.gradient(),this._heat.gradient(this.gradient()));this._heat.draw()},r.prototype.exit=function(t,o){delete this._heat,e.prototype.exit.apply(this,arguments)},r.prototype.resize=function(t){e.prototype.resize.apply(this,arguments),void 0!==this._heat&&this._heat.resize()},r.prototype.skewedData=function(){var t=this,e=[],o=this.data(),i=this.element().node().getBoundingClientRect(),r=this.bottomRightX()-this.topLeftX(),n=this.bottomRightY()-this.topLeftY(),a=r/i.width,s=n/i.height;return o.forEach(function(o){var i=Math.abs(o[0]-t.topLeftX()),r=Math.abs(o[1]-t.topLeftY()),n=i/a,l=r/s;e.push([n,l,o[2]])}),e},r}),function(t,e){"function"==typeof define&&define.amd?define("other/Html.js",["../common/HTMLWidget","css!./Html"],e):t.other_Html=e(t.common_HTMLWidget)}(this,function(t){function e(){t.call(this),this._tag="div"}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype._class+=" other_Html",e.prototype.publish("html","","string","Html to render",null,{tags:["Basic"]}),e.prototype.publish("overflowX",null,"set","CSS overflow-x",["","visible","hidden","scroll","auto","initial","inherit"],{tags:["Basic"],optional:!0}),e.prototype.publish("overflowY",null,"set","CSS overflow-y",["","visible","hidden","scroll","auto","initial","inherit"],{tags:["Basic"],optional:!0}),e.prototype.enter=function(e,o){t.prototype.enter.apply(this,arguments)},e.prototype.update=function(e,o){t.prototype.update.apply(this,arguments),o.style({"overflow-x":this.overflowX_exists()?this.overflowX():"","overflow-y":this.overflowY_exists()?this.overflowY():""});var i=o.selectAll(".htmlWrapper").data(this.data().length>0?this.data():[this.html()]);i.enter().append("div").attr("class","htmlWrapper"),i.html(function(t){return t}),i.exit().remove()},e}),function(t,e){"function"==typeof define&&define.amd?define("other/Paginator.js",["d3","../common/HTMLWidget","css!./Paginator"],e):t.other_Paginator=e(t.d3,t.common_HTMLWidget)}(this,function(t,e){function o(){e.call(this),this._tag="div",this._tNumPages=1,this._numList=[]}return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype._class+=" other_Paginator",o.prototype.publish("itemsPerPage",2,"number","Pagination items per page",null,{tags:["Private"]}),o.prototype.publish("numItems",10,"number","Pagination total number of items",null,{tags:["Private"]}),o.prototype.publish("pageNumber",1,"number","Pagination set or get the page number",null,{tags:["Private"]}),o.prototype.publish("adjacentPages",2,"number","Number of page indexes either side of current one",null,{tags:["Private"]}),o.prototype.publish("bottom",20,"number","Pagination bottom offset",null,{tags:["Private"]}),o.prototype.publish("right",20,"number","Pagination right offset",null,{tags:["Private"]}),o.prototype.postUpdate=function(t,e){},o.prototype.enter=function(t,o){e.prototype.enter.apply(this,arguments);var i=this;this.paginator=o.append("ul").attr("class","paginator pagination pagination-sm"),this.side=o.append("div").attr("class","paginator pagination side"),this.side.append("span").classed("side",!0).text("Page "),this.side.append("input").attr("type","number").attr("class","currentPageNumber").property("value",1).attr("min",1).on("change",function(){i.pageNumber(this.value),i._onSelect(this.value)}),this.side.append("span").classed("side total",!0).text(" of 1")},o.prototype.update=function(e,o){var i=this;if(o.style("bottom",this.bottom()+"px").style("right",this.right()+"px"),this._tNumPages=Math.ceil(this.numItems()/this.itemsPerPage())||1,this.pageNumber()>this._tNumPages&&this.pageNumber(1),this._numList=[],this.numItems()){this._numList.push("first");for(var r=-this.adjacentPages();r<=this.adjacentPages();r++)this.pageNumber()+r>0&&this.pageNumber()+r<=this._tNumPages&&this._numList.push(this.pageNumber()+r);this._numList.push("last")}this.side.select(".total").text(" of "+this._tNumPages),this.side.select(".currentPageNumber").property("value",this.pageNumber()),this.side.select(".currentPageNumber").attr("max",this._tNumPages);var n=this.paginator.selectAll("li").data(this._numList,function(t){return t});n.enter().append(function(t){var e=document.createElement("li");if(t!==i.pageNumber()){var o=document.createElement("a"),r=document.createTextNode(t);return o.appendChild(r),o.href="#",e.appendChild(o),e}var n=document.createElement("span");return n.innerHTML=t,e.appendChild(n),e}).on("click",function(e,o){switch(t.event.preventDefault(),i.side.select(".currentPageNumber").property("value",i.pageNumber()),e){case"first":1!==i.pageNumber()&&(i.pageNumber(1),i._onSelect(1,"previous"));break;case"last":i.pageNumber()!==i._tNumPages&&(i.pageNumber(i._tNumPages),i._onSelect(i._tNumPages,"previous"));break;default:i.pageNumber(e),i._onSelect(e)}}),n.classed("active",function(t,e){return t===i.pageNumber()}).select("a").text(function(t){return t}),n.exit().remove(),n.order(),0===this.numItems()&&t.select(e).remove()},o.prototype.exit=function(t,o){e.prototype.exit.apply(this,arguments)},o}),function(t,e){"function"==typeof define&&define.amd?define("other/Table.js",["d3","../common/HTMLWidget","./Paginator","../common/Utility","../common/Widget","css!./Table"],e):t.other_Table=e(t.d3,t.common_HTMLWidget,t.other_Paginator,t.common_Utility,t.common_Widget)}(this,function(t,e,o,i,r){function n(){e.call(this),this._tag="div",this.columns([]),this._paginator=new o,this._selectionBag=new i.Selection,this._selectionPrevClick=null,this._paginatorTableSpacing=4}function a(t,e){return e instanceof r?"Widget with class: "+e.classID():e}n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype._class+=" other_Table",n.prototype.publish("renderHtmlDataCells",!1,"boolean","enable or disable HTML within cells",null,{tags:["Private"]}),n.prototype.publish("pagination",!0,"boolean","Enable or disable pagination",null,{tags:["Private"]}),n.prototype.publish("paginationLimit",null,"number","Maximum number of rows allowed before pagination defaults to on",null,{tags:["Private"]}),n.prototype.publishProxy("itemsPerPage","_paginator"),n.prototype.publishProxy("pageNumber","_paginator","pageNumber",1),n.prototype.publishProxy("adjacentPages","_paginator"),n.prototype.publish("topN",null,"number","Total number or rows of data to be displayed in the table",null,{tags:["Private"]}),n.prototype.publish("pivot",!1,"boolean","Pivot Table"),n.prototype.publish("showHeader",!0,"boolean","Show or hide the table header",null,{tags:["Private"]}),n.prototype.publish("fixedHeader",!0,"boolean","Enable or disable fixed table header",null,{tags:["Private"]}),n.prototype.publish("fixedColumn",!1,"boolean","Enable or disable fixed first column",null,{tags:["Private"]}),n.prototype.publish("multiSelect",!1,"boolean","Multiple Selection",null,{tags:["Basic"]}),n.prototype.publish("fixedSize",!1,"boolean","Fix Size to Min Width/Height"),n.prototype.publish("quickUpdateOnClick",!1,"boolean","Avoid calling update on row select/deselect",null,{tags:["Private"]}),n.prototype.publish("hideEmptyColumns",!1,"boolean","Hide columns with all empty cells"),n.prototype.publish("theadFontSize",null,"string","Table head font size",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tbodyFontSize",null,"string","Table body font size",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tfootFontSize",null,"string","Table body font size",null,{tags:["Basic"],optional:!0}),n.prototype.publish("theadFontColor",null,"html-color","Table head font color",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tbodyFontColor",null,"html-color","Table body font color",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tfootFontColor",null,"html-color","Table body font color",null,{tags:["Basic"],optional:!0}),n.prototype.publish("theadFontFamily",null,"string","Table head font family",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tbodyFontFamily",null,"string","Table body font family",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tfootFontFamily",null,"string","Table body font family",null,{tags:["Basic"],optional:!0}),n.prototype.publish("theadCellBorderColor",null,"html-color","Table head cell border color",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tfootCellBorderColor",null,"html-color","Table head cell border color",null,{tags:["Basic"],optional:!0}),n.prototype.publish("theadRowBackgroundColor",null,"html-color","Table head row color",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tfootRowBackgroundColor",null,"html-color","Table head row color",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tbodyCellBorderColor",null,"html-color","Table body cell border color",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tbodyRowBackgroundColor",null,"html-color","Table body row color",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tbodyFirstColFontColor",null,"html-color","Table body first column font color",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tbodyFirstColBackgroundColor",null,"html-color","Table body first column background color",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tbodyHoverRowFontColor",null,"html-color","Table body hover row font color",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tbodyHoverRowBackgroundColor",null,"html-color","Table body hover row background color",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tbodySelectedRowFontColor",null,"html-color","Table body selected row color",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tbodySelectedRowBackgroundColor",null,"html-color","Table body selected row color",null,{tags:["Basic"],optional:!0}),n.prototype.publish("tableZebraColor",null,"html-color","Table zebra row color",null,{tags:["Basic"],optional:!0}),n.prototype.publish("totalledColumns",[],"array","Array of indices of the columns to be totalled",null,{tags:["Basic"],optional:!0,disable:function(t){return t.pivot()}}),n.prototype.publish("totalledLabel",null,"string","Adds a label to the first column of the 'Totalled' row",null,{tags:["Basic"],optional:!0,disable:function(t){return t.pivot()}}),n.prototype.publish("hiddenColumns",[],"array","Array of indices of the columns to be hidden",null,{tags:["Basic"],optional:!0,disable:function(t){return t.pivot()}}),n.prototype.publish("stringAlign","left","set","Cell alignment for strings",["left","right","center"],{tags:["Basic"],optional:!0}),n.prototype.publish("numberAlign","right","set","Cell alignment for numbers",["left","right","center"],{tags:["Basic"],optional:!0}),n.prototype.publish("verticalAlign",null,"set","Cell vertical alignment",[null,"middle","top","bottom"],{tags:["Basic"],optional:!0}),n.prototype.publish("minWidgetWidth",320,"number","Minimum width of a child widget",null,{tags:["Basic"],optional:!0}),n.prototype.publish("minWidgetHeight",240,"number","Minimum height of a child widget",null,{tags:["Basic"],optional:!0}),n.prototype.publish("sortByFieldIndex",null,"number","Index for the field/column to sort the data",null,{tags:["Basic"],optional:!0}),n.prototype.publish("descending",!1,"boolean","Direction for sorting the data: ascending (true) or descending (false)",null,{tags:["Basic"],optional:!0}),n.prototype.size=function(t){var o=e.prototype.size.apply(this,arguments);if(arguments.length&&this.tableDiv){var i=this.showHeader()&&this.fixedHeader()?this.thead.property("offsetHeight"):0;this.tableDiv.style("width",this._size.width+"px").style("height",this._size.height-i+"px"),this._element.style("width",this._size.width+"px").style("height",this._size.height+"px")}return o},n.prototype.isHidden=function(t){if(this.pivot())return!1;if(-1!==this.hiddenColumns().indexOf(t))return!0;var e=this.fields();return e&&e[t]&&("hidden"===e[t].type()||-1!==this._tempHidden.indexOf(t))?!0:!1},n.prototype.tableColumns=function(t){var e=n.prototype.columns.apply(this,arguments);return!arguments.length&&this.pivot()?this._db.column(0):e},n.prototype.tableData=function(t){var e=n.prototype.data.apply(this,arguments);return!arguments.length&&this.pivot()?this._db.columns().filter(function(t,e){return e>0}):e};var s={transform:function(t){return t}};return n.prototype.field=function(t,e){return this.pivot()?0===e?s:this.fields()[t+1]:-1===t?s:this.fields()[e]},n.prototype.calcFieldsIndex=function(t){for(var e=-1,o=0,i=this.columns().length,r=0;i>e&&t>=r;)e++,this.isHidden(e)?o++:r++;return t+o},n.prototype.getEmptyColumnIdxArr=function(t,e){var o=[];if(this.hideEmptyColumns())for(var i=0;i<t.length;i++){for(var r=!0,n=0;n<e.length;n++)if(-1===["",null,void 0].indexOf(e[n][i])){r=!1;break}r&&o.push(i)}return o},n.prototype.enter=function(t,o){e.prototype.enter.apply(this,arguments),this._parentElement.style("overflow","hidden"),this.tableDiv=o.append("div").attr("class","tableDiv"),this.table=this.tableDiv.append("table"),this.fixedHead=o.append("div").classed("header-wrapper",!0),this.fixedHeadTable=this.fixedHead.append("table"),this.fixedThead=this.fixedHeadTable.append("thead").append("tr"),this.unfixedThead=this.table.append("thead").append("tr"),this.tbody=this.table.append("tbody"),this.tfoot=this.table.append("tfoot").append("tr"),this.fixedCol=o.append("div").classed("rows-wrapper",!0),this.fixedColTable=this.fixedCol.append("table"),this.fixedColHead=this.fixedColTable.append("thead"),this.fixedColHeadRow=this.fixedColHead.append("tr"),this.fixedColBody=this.fixedColTable.append("tbody"),this.fixedColFoot=this.fixedColTable.append("tfoot"),this.fixedColFootRow=this.fixedColFoot.append("tr"),this.tableDiv.style("overflow","auto")},n.prototype.update=function(o,n){function a(){var t=j.width;E=l.tbody.property("offsetWidth")+1,A=t>E?E:t,A=A}function s(){D=l.tbody.property("offsetHeight")+k,D=D}e.prototype.update.apply(this,arguments);var l=this,p=l.tableColumns(),u=l.tableData(),c=this.tableDiv.node().scrollLeft;this._tempHidden=this.getEmptyColumnIdxArr(p,u),this.element().selectAll("table,tbody,th,td").style("width",null),!this.sortByFieldIndex_exists()||this._prevSortByFieldIndex===this.sortByFieldIndex()&&this._prevDescending===this.descending()||(i.multiSort(u,[{idx:this.sortByFieldIndex(),reverse:this.descending()}]),this._prevSortByFieldIndex=this.sortByFieldIndex(),this._prevDescending=this.descending()),this._hasChildWidgets=!1,this.fixedHeader()?this.thead=this.fixedThead:this.thead=this.unfixedThead,this.fixedHead.style("display",this.fixedHeader()?"table-row":"none"),this.unfixedThead.style("display",this.fixedHeader()?"none":"table-row");var h=this.thead.selectAll("th").data(this.showHeader()?p.filter(function(t,e){return!l.isHidden(e)}):[]);if(h.enter().append("th").each(function(e){var o=t.select(this);o.append("span").attr("class","thText"),o.append("span").attr("class","thIcon")}).on("click",function(t,e){l.headerClick(t,e,this)}),h.style("background-color",this.theadRowBackgroundColor()).style("border-color",this.theadCellBorderColor()).style("color",this.theadFontColor()).style("font-size",this.theadFontSize()),h.select(".thText").style("font-family",this.theadFontFamily()).text(function(t,e){var o=l.calcFieldsIndex(e);return l.field(-1,o).transform(t)}),h.select(".thIcon").text(function(t,e){return l.descending()?l.sortByFieldIndex()===e?"":"":l.sortByFieldIndex()===e?"":""}),h.exit().remove(),h.order(),this.paginationLimit()&&this.pagination(u.length>=parseInt(this.paginationLimit())?!0:!1),this.pagination()){null===this._paginator.target()&&this._paginator.target(n.node());var d=this._calcRowsPerPage(h);this.itemsPerPage(d),this._paginator.numItems(u.length),this._tNumPages=Math.ceil(this._paginator.numItems()/this.itemsPerPage())||1,(this.pageNumber()>this._tNumPages||this.pageNumber()<=0)&&this.pageNumber(1),this._paginator._onSelect=function(t,e){l.pageNumber(t),l.render()}}else this._paginator.numItems(0);var f=this.pageNumber()-1,g=this.itemsPerPage(),m=f*g,y=parseInt(f*g)+parseInt(g),_=null;_=this.topN()?u.slice(0,this.topN()):this.pagination()?u.slice(m,y):u;var v=[this.totalledLabel()?this.totalledLabel():null];if(0!==this.totalledColumns().length){for(var b=0;b<this.totalledColumns().length;b++)this.totalledColumns()[b]=+this.totalledColumns()[b];for(var w=1;w<p.length;w++){var x=0;if(-1!==this.totalledColumns().indexOf(w)){for(var C=0;C<_.length;C++)x+=_[C][w];v.push(x)}else v.push("")}var S=this.tfoot.selectAll("td").data(v);S.enter().append("td"),S[this.renderHtmlDataCells()?"html":"text"](function(t,e){return l.fields()[e].transform(t)}),S.exit().remove(),S.style("background-color",this.tfootRowBackgroundColor()).style("border-color",this.tfootCellBorderColor()).style("color",this.tfootFontColor()).style("font-size",this.tfootFontSize())}var R=this.tbody.selectAll("tr.tr_"+this.id()).data(_.map(function(t,e){for(var o=0;o<t.length;++o)void 0===t[o]&&(t[o]=null);return{rowIdx:e,row:t}}));R.enter().append("tr").attr("class","tr_"+this.id()).on("click.selectionBag",function(t){if(t.row){var e=t.row,o=t.rowIdx;l.selectionBagClick(e,o),l.applyRowStyles(l.getBodyRow(o)),l.applyFirstColRowStyles(l.getFixedRow(o))}},!0).on("mouseover",function(t){if(t.row){var e=t.rowIdx,o=l.getFixedRow(e);o.empty()||o.classed("hover",!0);var i=l.getBodyRow(e);i.classed("hover",!0),l.applyStyleToRows(i),l.applyFirstColRowStyles(o)}}).on("mouseout",function(t){if(t.row){var e=t.rowIdx,o=l.getFixedRow(e);o.classed("hover",!1);var i=l.getBodyRow(e);i.classed("hover",!1),l.applyStyleToRows(i),l.applyFirstColRowStyles(o)}}),R.classed("selected",function(t){var e=t.row;return l._selectionBag.isSelected(l._createSelectionObject(e))}).classed("trId"+this._id,!0),R.exit().remove(),this.applyStyleToRows(R);var W=R.selectAll(".td_"+this.id()).data(function(t,e){return t.row.filter(function(t,e){return e<p.length&&!l.isHidden(e)}).map(function(e,o){return{rowInfo:t,colIdx:o,cell:e}})});W.enter().append("td").attr("class","td_"+this.id()).on("click",function(t){t.rowInfo&&l.click(l.rowToObj(t.rowInfo.row),l.columns()[t.colIdx],l._selectionBag.isSelected(l._createSelectionObject(t.rowInfo.row)))}).on("dblclick",function(t,e){t.rowInfo&&l.dblclick(l.rowToObj(t.rowInfo.row),l.columns()[t.colIdx],l._selectionBag.isSelected(l._createSelectionObject(t.rowInfo.row)))}).each(function(e,o){var i=l.getColumnAlignment(e.rowInfo.rowIdx,e.colIdx,e.cell),r=t.select(this);r.style({height:null,"text-align":i,"vertical-align":l.verticalAlign()}).classed("tr-"+e.rowInfo.rowIdx+"-td-"+o,!0)}),W.each(function(e){var o=t.select(this);if(e.cell instanceof r){o[l.renderHtmlDataCells()?"html":"text"](null);var i=o.selectAll(".div_"+l.id()).data([e.cell],function(t){return t.id()});i.exit().each(function(t){t.target(null)}).remove(),i.enter().append("div").attr("class","div_"+l.id()).style({width:l.minWidgetWidth()+"px",height:l.minWidgetHeight()+"px"}).each(function(e){var o=t.select(this);e._parentWidget=l,e._class.indexOf("childWidget")<0&&(e._class="childWidget "+e._class),e.target(null).target(o.node())}),i.each(function(t){t.resize().lazyRender(),l._hasChildWidgets=!0})}else{o.selectAll(".div_"+l.id()).remove();var n=l.calcFieldsIndex(e.colIdx);o[l.renderHtmlDataCells()?"html":"text"](l.field(e.rowInfo.rowIdx,n).transform(e.cell))}}),W.exit().remove();var k=parseInt(this.thead.node().offsetHeight);this.pagination()&&this._hasChildWidgets?(this.tableDiv.style("overflow-y","auto"),this.table.style("margin-bottom","50px"),console.log("Warning: displaying another widget in the table may cause problems with pagination")):(this.tableDiv.style("overflow-y",null),this.table.style("margin-bottom",null)),this.size(this._size);var T=0,I=this.fixedColHeadRow.selectAll("th").data(this.fixedColumn()&&this.showHeader()?[p[0]]:[]);I.enter().append("th").each(function(e){var o=t.select(this);o.append("span").attr("class","thText"),o.append("span").attr("class","thIcon")}).on("click",function(t,e){l.headerClick(t,e,this)}),I.style("background-color",this.theadRowBackgroundColor()).style("border-color",this.theadCellBorderColor()).style("color",this.theadFontColor()).style("font-size",this.theadFontSize()),I.select(".thText").style("font-family",this.theadFontFamily()).text(function(t){return t}),I.select(".thIcon").text(function(t,e){return l.descending()?l.sortByFieldIndex()===e?"":"":l.sortByFieldIndex()===e?"":""}),I.exit().remove();var O=this.fixedColBody.selectAll("tr").data(this.fixedColumn()?_:[]);O.enter().append("tr").attr("class",function(){return"trId"+l._id}),O.on("click",function(e,o){t.select(R[0][o]).on("click.selectionBag")(R.data()[o],o)}).on("mouseover",function(e,o){t.select(R[0][o]).on("mouseover")(R.data()[o],o)}).on("mouseout",function(e,o){t.select(R[0][o]).on("mouseout")(R.data()[o],o)}).classed("selected",function(t){return l._selectionBag.isSelected(l._createSelectionObject(t))}),O.exit().remove();var P=O.selectAll("td").data(function(t,e){return[t[0]]});P.enter().append("td"),P[this.renderHtmlDataCells()?"html":"text"](function(t){return"string"==typeof t?t.trim():"number"==typeof t?t:""}),P.exit().remove();var N=this.fixedColFootRow.selectAll("td").data(this.fixedColumn()&&this.totalledLabel()?[this.totalledLabel()]:[]);if(N.enter().append("td"),N[this.renderHtmlDataCells()?"html":"text"](function(t){return"string"==typeof t?t.trim():"number"==typeof t?t:""}),N.exit().remove(),this.fixedColumn()&&!this.fixedSize()&&P.length&&(T=this.showHeader()?P.property("offsetWidth")>I.property("offsetWidth")?P.property("offsetWidth"):I.property("offsetWidth"):P.property("offsetWidth"),this.fixedCol.style("position","absolute").style("margin-top",-this.tableDiv.property("scrollTop")+k+"px"),P.style("width",T+"px"),this.fixedColHead.style("position","absolute").style("margin-top",(this.fixedHeader()?this.tableDiv.property("scrollTop"):0)-k+"px"),I.style("width",T+"px"),R.each(function(e,o){var i=t.select(this).select("td").property("offsetHeight");t.select(P[o][0]).style("height",i+"px")})),this.table.style("margin-left",-T+"px"),this.tableDiv.style("margin-left",T+"px").style("width",this.width()-T+"px"),R.empty()||this.setColumnWidths(R),this.fixedSize()){var B=t.select(".tableDiv > table").node();if(B){var D,A,E,j=B.getBoundingClientRect();0!==j.width&&0!==j.height?(a(),s()):(j.height-k<=l.tableDiv.property("offsetHeight")?s():l.fixedHeader()?(D=l.property("offsetHeight"),D+="px"):D="100%",j.width-T<l.tableDiv.property("offsetWidth")?a():l.fixedColumn()?(A=l.property("offsetWidth")-T,A+="px"):A="100%"),n.classed("childWidget")&&(l._parentElement.style("width",A+"px").style("height",D+"px"),l.tableDiv.style("overflow","hidden")),l.size({width:A,height:D})}}this.setOnScrollEvents(this.tableDiv.node(),k),this._paginator.render(),setTimeout(function(){l._paginator.right((l.hasVScroll(n)?l.getScrollbarWidth():0)+l._paginatorTableSpacing).bottom((l.hasHScroll(n)?l.getScrollbarWidth():0)+l._paginatorTableSpacing).render(function(){l.tableDiv.node().scrollLeft=c})},0)},n.prototype.exit=function(t,o){this._paginator.target(null),e.prototype.exit.apply(this,arguments)},n.prototype.setColumnWidths=function(e){var o=this,i=e.filter(function(t,e){return 0===e}),r=[];i.each(function(e){r=t.selectAll(this.childNodes)});var n=this.fixedHeader()?this.thead.property("offsetHeight"):0,a=1,s={};r.each(function(t,e){s[e]=this.offsetWidth});var l=this.thead.selectAll("th");l.each(function(t,e){var o=this.offsetWidth,i=r.empty()?0:s[e],n=o>=i?o:i;this.style.width=n+"px",!r.empty()&&r[0][e]&&(r[0][e].style.width=n+"px"),a+=n}),this.thead.style("position",this.fixedHeader()?"absolute":"relative").style("width",a+"px").style("margin-top","0px"),this.table.style("width",a+"px"),this.tableDiv.style("margin-top",(o.fixedHeader()?n:0)+"px"),this.tbody.style("width",a+"px")},n.prototype.getBodyRow=function(t){return this.table.selectAll("tbody tr.trId"+this._id).filter(function(e,o){return o===t})},n.prototype.getFixedRow=function(t){return this._element.selectAll(".rows-wrapper tbody tr").filter(function(e,o){return o===t})},n.prototype.setOnScrollEvents=function(t,e){var o=this;t.onscroll=function(t){var i=t.target.scrollTop,r=t.target.scrollLeft;o.fixedHeader()&&o.thead.style("margin-left",-r+"px"),o.fixedColumn()&&(o.fixedCol.style("margin-top",-i+e+"px"),o.fixedHeader()&&o.fixedColHead.style("margin-top",i-e+"px"))}},n.prototype._generateTempRow=function(){var t=this.tbody.append("tr");return t.append("td").text("QQQ"),t},n.prototype._createSelectionObject=function(e){var o=this;return{_id:e,element:function(){return o.tbody?o.tbody.selectAll("tr").filter(function(t){return t===e}):t.select()}}},n.prototype._calcRowsPerPage=function(t){0===this._paginator.numItems()&&(this._paginator.numItems(1),this.itemsPerPage(1)),this._paginator.render();var e=this.thead.selectAll("th").node()?this.thead.selectAll("th").node().clientHeight:0,o=this.tfoot.selectAll("td").node()?this.tfoot.selectAll("td").node().clientHeight:0,i=this._generateTempRow(),r=i.node().clientHeight;i.remove();var n=this.calcHeight(this._paginator.element()),a=Math.floor((this.height()-e-o-n-(this.table.style("width")>=this.table.style("width")?this.getScrollbarWidth():0)-2*this._paginatorTableSpacing)/r)||1;return 0!==this.totalledColumns().length&&(a-=1),a},n.prototype.sort=function(t){return this.sortByFieldIndex()!==t?this.descending(!1):this.descending(!this.descending()),this.sortByFieldIndex(t),this},n.prototype.selection=function(t){return arguments.length?(this._selectionBag.set(t.map(function(t){return this._createSelectionObject(t)},this)),this):this._selectionBag.get().map(function(t){return t._id})},n.prototype.selectionBagClick=function(e,o){if(this.multiSelect()&&t.event.shiftKey&&this._selectionPrevClick){var i=!1,r=[],n=this.tableData().filter(function(t,o){var n=!1;return(t===e||t===this._selectionPrevClick)&&(i&&(n=!0),i=!i,r.push(o)),i||n},this);this.selection(n)}else if(this.multiSelect())this._selectionBag.click(this._createSelectionObject(e),t.event),this._selectionPrevClick=e;else{var a=this._createSelectionObject(e);this._selectionBag.click(a,{ctrlKey:this._selectionBag.isSelected(a)}),this._selectionPrevClick=e}if(this.quickUpdateOnClick()){var s=this;this.tbody.selectAll("tr.tr_"+this.id()).classed("selected",function(t){return s._selectionBag.isSelected(s._createSelectionObject(t.row))}).classed("trId"+this._id,!0)}else this.render()},n.prototype.applyHoverRowStyles=function(t){var e=this;t.style("color",e.tbodyHoverRowFontColor()).style("background-color",e.tbodyHoverRowBackgroundColor())},n.prototype.applySelectedRowStyles=function(t){var e=this;t.style("color",e.tbodySelectedRowFontColor()).style("background-color",e.tbodySelectedRowBackgroundColor())},n.prototype.applyRowStyles=function(t,e){var o=t.datum().row;t.style("color",e?this.tbodyFirstColFontColor():this.tbodyFontColor()).style("background-color",e?this.tbodyFirstColBackgroundColor():this.tableZebraColor_exists()&&this.tableData().indexOf(o)%2?this.tbodyRowBackgroundColor():this.tableZebraColor())},n.prototype.applyFirstColRowStyles=function(t){this.applyStyleToRows(t,!0)},n.prototype.applyStyleToRows=function(e,o){o="undefined"!=typeof o?o:!1;var i=this;e.each(function(){var e=t.select(this);e.classed("hover")?i.applyHoverRowStyles(e):e.classed("selected")?i.applySelectedRowStyles(e):i.applyRowStyles(e,o)})},n.prototype.getColumnAlignment=function(t,e,o){var i=this.calcFieldsIndex(e),r=this.field(t,i);switch(r.__prop_type){case"string":return this.stringAlign();case"number":return this.numberAlign();case"":case void 0:switch(typeof o){case"string":return this.stringAlign();case"number":return this.numberAlign()}}return null},n.prototype.serializeState=function(){return{selection:this._selectionBag.get().map(function(t){return t._id}),data:this.data()}},n.prototype.deserializeState=function(t){if(t){if(t.selection){var e=this;this._selectionBag.set(t.selection.map(function(t){return e._createSelectionObject(t)}))}t.data&&this.data(t.data)}return this},n.prototype.click=function(t,e,o){console.log("click:  "+JSON.stringify(t,a)+", "+e+","+o)},n.prototype.dblclick=function(t,e,o){console.log("dblclick:  "+JSON.stringify(t,a)+", "+e+","+o)},n.prototype.headerClick=function(t,e,o){var i=this.tableDiv.node(),r=o.getBoundingClientRect(),n=r.width,a=r.left;this.sort(e).render(function(){setTimeout(function(){var t=o.getBoundingClientRect(),e=t.width,r=t.left,s=r-a,l=e-n;i.scrollLeft+=s+l},0)})},n}),function(t,e){"function"==typeof define&&define.amd?define("other/Legend.js",["d3","./Table","../common/Palette","css!./Legend"],e):t.other_Legend=e(t.d3,t.other_Table,t.common_Palette)}(this,function(t,e,o){function i(){e.call(this),this._resetCache=!0,this._hiddenRowLabels=[],this.showHeader(!1),this.pagination(!1)}function r(t){return'<div class="colorBlock" style="background-color:'+t+';"></div>';
}i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype._class+=" other_Legend",i.prototype.publish("dataFamily","ND","set","Type of data",["1D","2D","ND","map","any"],{tags:["Private"]}),i.prototype.publish("orientation","vertical","set","Orientation of Legend rows",["vertical","horizontal"],{tags:["Private"]}),i.prototype.publish("rainbowFormat",",","string","Rainbow number formatting",null,{tags:["Private"],optional:!0,disable:function(t){return!t.isRainbow()}}),i.prototype.publish("rainbowBins",8,"number","Number of rainbow bins",null,{tags:["Private"],disable:function(t){return!t.isRainbow()}}),i.prototype.isRainbow=function(){var t=this.getWidget();return t&&t._palette&&"rainbow"===t._palette.type()},i.prototype.targetWidget=function(t){if(!arguments.length)return this._targetWidget;this._targetWidget=t;var e=this;return this._targetWidgetMonitor&&(this._targetWidgetMonitor.remove(),delete this._targetWidgetMonitor),this._targetWidgetMonitor=this._targetWidget.monitor(function(t,o,i,r){switch(t){case"chart":case"columns":case"paletteID":e.lazyRender()}}),this},i.prototype.getWidget=function(){if(this._targetWidget)switch(this._targetWidget.classID()){case"chart_MultiChart":return this._targetWidget.chart()}return this._targetWidget},i.prototype.getPalette=function(){var t=this.getWidget();if(t&&t._palette)switch(t._palette.type()){case"ordinal":return o.ordinal(t._palette.id());case"rainbow":return o.rainbow(t._palette.id())}return o.ordinal("default")};var n=e.prototype.getBBox;return i.prototype.getBBox=function(t,e){var o=n.apply(this,arguments),i=this.element().select(".tableDiv > table");if(!i.empty()){var r=i.node().getBoundingClientRect(),a=r.width+8+(this.hasVScroll(this._parentElement)?this.getScrollbarWidth():0),s=r.height+8+(this.hasHScroll(this._parentElement)?this.getScrollbarWidth():0);return{x:o.x,y:o.y,width:(e?Math.round(a):a)*this._scale,height:(e?Math.round(s):s)*this._scale}}return o},i.prototype.enter=function(o,i){e.prototype.enter.apply(this,arguments),t.select(o.parentNode).style("overflow-y","auto"),this.renderHtmlDataCells(!0),this.fixedHeader(!1),this.fixedSize(!0),i.classed("other_Legend",!0)},i.prototype.update=function(o,i){var n=["Key","Label"],a=[];if(this.needsDataUpdate()){if(this._targetWidget){var s=this.getPalette();switch(s.type()){case"ordinal":switch(this.dataFamily()){case"2D":a=this._targetWidget.data().map(function(t){return[r(s(t[0])),t[0]]},this);break;case"ND":var l=this._targetWidget.columns();a=l.filter(function(t,e){return e>0}).map(function(t){return[r(s(t)),t]},this)}break;case"rainbow":var p=t.format(this.rainbowFormat()),u=this.getWidget(),c=this.rainbowBins(),h=u._dataMinWeight,d=u._dataMaxWeight,f=(d-h)/(c-1);a.push([r(s(h,h,d)),p(h)]);for(var g=1;c-1>g;++g){var m=f*g;a.push([r(s(m,h,d)),p(Math.floor(m))])}a.push([r(s(d,h,d)),p(d)])}}this.columns(n),this.data(a),this._hiddenRowLabels=[],this._cachedData=this._targetWidget.data(),this.element().selectAll("tbody > tr").style("opacity",1)}e.prototype.update.apply(this,arguments),i.classed("horiz-legend","horizontal"===this.orientation());var y=i.select(".tableDiv > table"),_=y.node().getBoundingClientRect(),v=this._parentElement.node().getBoundingClientRect();i.select(".tableDiv").style({overflow:"visible"});var b=v.height/2-_.height/2,w=v.width/2-_.width/2;y.style({position:"absolute",top:b+"px",left:w+"px"});var x=this.pageNumber()-1,C=this.itemsPerPage(),S=x*C,R=parseInt(x*C)+parseInt(C),W=null;W=this.pagination()?this.data().slice(S,R):this.data();var k=this.tbody.selectAll("tr").data(W),T=this;k.on("click",function(t,e){T.onClick(t,e)}).on("dblclick",function(t,e){T.onDblClick(t,e)}).on("mouseover",function(t,e){T.onMouseOver(t,e)})},i.prototype.exit=function(t,o){this._targetWidgetMonitor&&(this._targetWidgetMonitor.remove(),delete this._targetWidgetMonitor),e.prototype.exit.apply(this,arguments)},i.prototype.filteredData=function(){var t=this;return this._cachedData?this._cachedData.filter(function(e,o){return-1===t._hiddenRowLabels.indexOf(e[0])}):[]},i.prototype.needsDataUpdate=function(){var t=this._hiddenRowLabels,e=JSON.stringify(this._targetWidget.data().map(function(t){return t[0]})),o=JSON.stringify(this.data().map(function(t){return t[1]}).filter(function(e){return-1===t.indexOf(e)}));return e!==o},i.prototype.onClick=function(t,e){if(console.log("Legend onClick method"),console.log("rowData: "+t),console.log("rowIdx: "+e),this._hiddenRowLabels||(this._hiddenRowLabels=[]),this._cachedData||(this._cachedData=this._targetWidget.data()),this._targetWidget&&"function"==typeof this._targetWidget.hideRowOnLegendClick&&this._targetWidget.hideRowOnLegendClick()){var o=t[1],i=this.element().select("tbody > tr:nth-child("+(e+1)+")");-1===this._hiddenRowLabels.indexOf(o)?(this._hiddenRowLabels.push(o),i.style("opacity",.15)):(this._hiddenRowLabels=this._hiddenRowLabels.filter(function(t){return t!==o}),i.style("opacity",1)),this._resetCache=!1,this._targetWidget.data(this.filteredData()).lazyRender()}},i.prototype.onDblClick=function(t,e){console.log("Legend onDblClick method"),console.log("rowData: "+t),console.log("rowIdx: "+e)},i.prototype.onMouseOver=function(t,e){console.log("Legend onMouseOver method"),console.log("rowData: "+t),console.log("rowIdx: "+e)},i}),function(t,e){"function"==typeof define&&define.amd?define("other/MorphText.js",["../common/SVGWidget","css!./MorphText"],e):t.other_MorphText=e(t.common_SVGWidget)}(this,function(t){function e(){t.call(this)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype._class+=" other_MorphText",e.prototype.publish("anchor","middle","set","Sets anchor point",["middle"],{tags:["Basic"]}),e.prototype.publish("fontSize",14,"number","Sets fontsize",null,{tags:["Basic"]}),e.prototype.publish("reverse",!1,"boolean","Reverse Animation",null,{tags:["Basic"]}),e.prototype.publish("text","","string","Sets text/data of widget",null,{tags:["Basic"]}),e.prototype._origText=e.prototype.text,e.prototype.text=function(t){var o=e.prototype._origText.apply(this,arguments);if(arguments.length){var i={},r=t.split("");this.data(r.map(function(t){var e="_"+t;return void 0===i[e]&&(i[e]=0),i[e]++,{text:t,id:t.charCodeAt(0)+1024*i[e]}}))}return o},e.prototype.enter=function(t,e){if(!this.fontSize()){var o=window.getComputedStyle(t,null);this.fontSize(parseInt(o.fontSize))}this._fontWidth=32*this.fontSize()/48,this._textElement=e.append("g")},e.prototype.dateTime=function(){var t=new Date,e=1===t.getSeconds().toString().length?"0"+t.getSeconds():t.getSeconds(),o=1===t.getMinutes().toString().length?"0"+t.getMinutes():t.getMinutes(),i=1===t.getHours().toString().length?"0"+t.getHours():t.getHours(),r=t.getHours()>=12?"pm":"am",n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return a[t.getDay()]+" "+n[t.getMonth()]+" "+t.getDate()+" "+t.getFullYear()+" "+i+":"+o+":"+e+r},e.prototype.update=function(t,e){var o=this,i=this._textElement.selectAll("text").data(this.data(),function(t){return t.id});i.attr("class","update"),this.transition.apply(i).attr("x",function(t,e){return(-o.data().length/2+e)*o._fontWidth+o._fontWidth/2});var r=i.enter().append("text").attr("class","enter").attr("font-size",this.fontSize()).attr("dy",".35em").attr("y",(this.reverse()?1:-1)*this._fontWidth*2).attr("x",function(t,e){return(-o.data().length/2+e)*o._fontWidth+o._fontWidth/2}).style("fill-opacity",1e-6).style("text-anchor",this.anchor()).text(function(t){return t.text});this.transition.apply(r).attr("y",0).style("fill-opacity",1),i.exit().attr("class","exit"),this.transition.apply(i.exit()).attr("y",(this.reverse()?-1:1)*this._fontWidth*2).style("fill-opacity",1e-6).remove()},e}),function(t,e){"function"==typeof define&&define.amd?define("other/NestedTable.js",["./Table"],e):t.other_NestedTable=e(t.other_Table)}(this,function(t){function e(e){t.call(this),this.minWidgetHeight(240),this.minWidgetWidth(360)}e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype._class+=" other_NestedTable";var o=e.prototype.columns;e.prototype.columns=function(t){return arguments.length?(this._columns=t,o.call(this,t.map(function(t){return"object"==typeof t?t.label:t}))):o.apply(this,arguments)};var i=e.prototype.data;return e.prototype.data=function(e){if(arguments.length){var o=this;return i.call(this,e.map(function(e){return e.map(function(e,i){if(e instanceof Array){var r=[];if("object"==typeof o._columns[i]&&o._columns[i].columns)r=o._columns[i].columns;else for(var n=0;n<e.length;++n)r.push(o._columns[i]+"."+n);return(new t).columns(r).data(e)}return e})}))}return i.apply(this,arguments)},e}),function(t,e){"function"==typeof define&&define.amd?define("other/Opportunity.js",["d3","../common/SVGWidget","../common/Utility","../common/PropertyExt","css!./Opportunity"],e):t.graph_Opportunity=e(t.d3,t.common_SVGWidget,t.common_Utility,t.common_PropertyExt)}(this,function(t,e,o,i){function r(t){i.call(this),this._owner=t}function n(t){i.call(this),this._owner=t}function a(t){i.call(this),this._owner=t}function s(t){e.call(this),this._drawStartPos="origin",this.groupCount=7}return r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype._class+=" graph_Opportunity.Column",r.prototype.publish("headerLabel",null,"string","Header value of a table",function(){return this._owner?this._owner.columns():[]},{tags:["Basic"],optional:!0}),n.prototype=Object.create(i.prototype),n.prototype.constructor=n,n.prototype._class+=" graph_Opportunity.MouseHoverColumn",n.prototype.publish("hoverValue",null,"string","Hover value of a table",function(){return this._owner?this._owner.columns():[]},{tags:["Basic"],optional:!0}),n.prototype.publish("hoverList",null,"set","Hover value of a table",function(){return this._owner?this._owner.getIds():[]},{tags:["Basic"],optional:!0}),a.prototype=Object.create(i.prototype),a.prototype.constructor=a,a.prototype._class+=" graph_Opportunity.ColumnDropdown",a.prototype.publish("columnIndex",null,"number","Column index for display context data based on column dropdown list selction",{},{tags:["Basic","Shared"]}),a.prototype.publish("ColumnDropdownList",null,"set","column value of a table",function(){return this._owner?this._owner.getIds():[]},{tags:["Basic"],optional:!0}),s.prototype=Object.create(e.prototype),s.prototype.constructor=s,s.prototype.Column=r,s.prototype.MouseHoverColumn=n,s.prototype.ColumnDropdown=a,s.prototype._class+=" graph_Opportunity",s.prototype.publish("previousGroup","","set","label in Opportunity",function(){return this.getIds()},{tags:["Basic","Shared"]}),s.prototype.publish("currentGroup","","set","label in Opportunity",function(){return this.getIds()},{tags:["Basic","Shared"]}),s.prototype.publish("opportunityId","id","set","Id for label in Opportunity",function(){return this.getIds()},{tags:["Basic","Shared"]}),s.prototype.publish("url",null,"string","URL in Opportunity",{},{tags:["Basic","Shared"]}),s.prototype.publish("width",1100,"number","label in Opportunity",{},{tags:["Basic","Shared"]}),s.prototype.publish("addColumn",null,"string","number of columns in a table",{},{tags:["Basic","Shared"],editor_input:function(t,e,o,i){o.append("button").attr("id",t.id()+"_addColumn"+i.id).classed("property-input custom-editor-input addColumn update",!0).text("AddColumn").on("click",function(){e.groupCount=e.groupCount+1;var o="Added a new column";t.setProperty(e,i.id,o)})}}),s.prototype.publish("removeColumn",null,"string","number of columns in a table",function(){return this.columns()},{tags:["Basic","Shared"],editor_input:function(t,e,o,i){o.append("button").attr("id",t.id()+"_removeColumn"+i.id).classed("property-input custom-editor-input removeColumn update",!0).text("RemoveColumn").on("click",function(){e.groupCount=e.groupCount-1;var o="Removed a column";t.setProperty(e,i.id,o)})}}),s.prototype.publish("headerLabels",[],"propertyArray","Source Columns",null,{autoExpand:r}),s.prototype.publish("mouseHover",[],"propertyArray","mouse hover options",null,{autoExpand:n}),s.prototype.publish("columnData",[],"propertyArray","column data",null,{autoExpand:a}),s.prototype.getIds=function(){var t=this.columns();return t.unshift("default"),t},s.prototype.enter=function(o,i){e.prototype.enter.apply(this,arguments);var r=30,n=14,a=10,s=(this.data().length+1)*(n+a+1)+r;this.svg=i.append("g").attr("width",100*this.groupCount+1).attr("height",s),this.svg.append("defs").append("marker").classed("arrowhead",!0).attr("id","end-arrow").attr("viewBox","0 -5 10 10").attr("refX",6).attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5").attr("fill","rgb(100,100,100)"),this.tooltipdiv=t.select("body").append("div").attr("class","graph_Opportunity-tooltip tooltip").style("opacity",0)},s.prototype.update=function(o,i){e.prototype.update.apply(this,arguments);var r=this,n=this.data(),a=this.opportunityId();n.sort(function(t,e){return t.cur_group>e.cur_group?1:t.cur_group<e.cur_group?-1:0});for(var s=[],l=1;l<=r.groupCount;l++)s.push(l);var p=30,u=14,c=10,h=(n.length+1)*(u+c+1)+p,d=this.width(),f=30,g=d/r.groupCount-f,m=this.svg.selectAll(".group").data(s);m.enter().append("rect").attr("class","group"),m.attr("x",function(t,e){return e*d/r.groupCount+1}).attr("y",p).attr("width",d/this.groupCount).attr("height",h-p),m.exit().remove();var y=this.svg.selectAll(".group_headings").data(s);if(y.enter().append("text").attr("class","group_headings").attr("y",20),y.attr("x",function(t,e){return e*d/r.groupCount+d/r.groupCount/r.groupCount}).text(function(t,e){return r.headerLabels().length>0&&r.headerLabels()[e]&&r.headerLabels()[e].headerLabel()?r.headerLabels()[e].headerLabel():""}),y.exit().remove(),"prev_group"===this.previousGroup()&&"cur_group"===this.currentGroup()){var _=this.svg.selectAll(".node_date_change").data(n);_.enter().append("g").attr("class","node_date_change update").on("mouseover",function(e){r.tooltipdiv.transition().duration(200).style("opacity",.9);var o="<span style='font-weight:bolder'>Close Date Change </span><br/>",i=r.mouseHover();i.forEach(function(t,i){void 0!==t.hoverValue()&&(o=o+"<span style='font-weight:bold'>"+t.hoverValue()+":  </span>"+e[t.hoverList()]+"<br/>")});var n=e.prevdate+"";n=n.replace(/(\d\d\d\d)(\d\d)(\d\d)/g,"$3-$2-$1");var a=e.curdate+"";a=a.replace(/(\d\d\d\d)(\d\d)(\d\d)/g,"$3-$2-$1"),o=o+"<span style='font-weight:bold'>From: </span>"+n+"<br/><span style='font-weight:bold'>To: </span>"+a+"<br/>",r.tooltipdiv.html(o).style("left",t.event.pageX+"px").style("top",t.event.pageY-50+"px")}).on("mouseout",function(t){r.tooltipdiv.transition().duration(500).style("opacity",0)}).each(function(e){var o=t.select(this);o.append("rect").attr("class","node_date_change_rect").attr("width",5).attr("height",u).attr("rx",6).attr("ry",6)}),_.attr("transform",function(t,e){return"translate("+(9*d/r.groupCount+f-80)+","+(e+e*(u+c)+12+p)+")"}),_.exit().remove();var v=this.svg.selectAll(".node_prev_group").data(n);v.enter().append("g").attr("class","node_prev_group").on("mouseover",function(e,o){r.tooltipdiv.transition().duration(200).style("opacity",.9);var i="",n=r.mouseHover();n.forEach(function(t,o){void 0!==t.hoverValue()&&(i=i+"<span style='font-weight:bold'>"+t.hoverValue()+":  </span>"+e[t.hoverList()]+"<br/>")}),r.tooltipdiv.html(i).style("left",t.event.pageX+"px").style("top",t.event.pageY-100+"px")}).on("mouseout",function(t){r.tooltipdiv.transition().duration(500).style("opacity",0)}).each(function(e){var o=t.select(this);o.append("rect").attr("class","node_prev_rect").attr("rx",6).attr("ry",6),o.append("text").attr("class","node_prev_text")}),v.classed("update",!0).classed("changed",function(t){return 0!==t.delta}).attr("transform",function(t,e){return"translate("+((t.prev_group-1)*d/r.groupCount+f/2)+","+(e+e*(u+c)+10+p)+")"}).each(function(e){var o=t.select(this),i=o.selectAll(".arrow").data(0!==e.delta?[e]:[]);i.enter().append("line").attr("class","arrow update"),i.attr("x1",function(t){return t.delta>0?g:0}).attr("y1",u/2).attr("x2",function(t){return t.delta>0?g+f-4+(Math.abs(t.delta)-1)*(d/r.groupCount):-f-(Math.abs(t.delta)-1)*(d/r.groupCount)+4}).attr("y2",u/2).style("stroke-dasharray","3, 3").style("stroke","rgb(100,100,100)").style("marker-end","url(#end-arrow)").style("opacity","1"),i.exit().remove()});var b=v.select(".node_prev_rect");b.attr("width",g).attr("height",u);var w=v.select(".node_prev_text");w.attr("dy",u/2+3).attr("dx",g/4).text(function(t){return"number"==typeof t[a]?t[a]:t[a].substring(0,14)}),v.exit().remove();var x=this.svg.selectAll(".node_cur_group").data(n);x.enter().append("g").attr("class","node_cur_group").attr("transform",function(t,e){return"translate("+((t.prev_group-1)*d/r.groupCount+f/2)+","+(e+e*(u+c)+10+p)+")"}).on("mouseover",function(e,o){r.tooltipdiv.transition().duration(200).style("opacity",.9);var i="",n=r.mouseHover();n.forEach(function(t,o){void 0!==t.hoverValue()&&(i=i+"<span style='font-weight:bold'>"+t.hoverValue()+":  </span>"+e[t.hoverList()]+"<br/>")}),r.tooltipdiv.html(i).style("left",t.event.pageX+"px").style("top",t.event.pageY-100+"px")}).on("mouseout",function(t){r.tooltipdiv.transition().duration(500).style("opacity",0)}).each(function(e){var o=t.select(this);o.append("rect").attr("class","node_cur_rect").attr("fill",function(t){var e;return e=t.delta<0||7===t.cur_group?"#F78181":"#A9F5A9"}).attr("rx",6).attr("ry",6),o.append("a").append("text").attr("class","node_cur_text")}),x.classed("update",!0).classed("changed",function(t){return 0!==t.delta}).transition().duration(800).ease("linear").attr("transform",function(t,e){return"translate("+((t.cur_group-1)*d/r.groupCount+f/2)+","+(e+e*(u+c)+10+p)+")"}).each("end",function(){t.selectAll(".arrow").style("opacity","1")});var C=x.select(".node_cur_group a");C.classed("update",!0).attr("xlink:href",function(t){return r.url()+t.id}).attr("xlink:show","new");var S=x.select(".node_cur_rect");S.attr("width",g).attr("height",u);var R=x.select(".node_cur_text");R.classed("update",!0).attr("dy",u/2+3).attr("dx",g/4).style("fill","blue").text(function(t){return"number"==typeof t[a]?t[a]:t[a].substring(0,14)}),x.exit().remove()}for(var W=0;W<r.columnData().length;W++)if(r.columnData()[W]&&r.columnData()[W].ColumnDropdownList()){var k=this.svg.selectAll(".columnDataText_"+W).data(n);k.enter().append("g").attr("class","columnDataText_"+W+" update").each(function(e){var o=t.select(this);o.append("text")}),k.attr("transform",function(t,e){return"translate("+(r.columnData()[W].columnIndex()*d/r.groupCount+f/2)+","+(e+e*(u+c)+12+p)+")"}).attr("width",5).attr("height",u).attr("rx",6).attr("ry",6);var T=k.select("text");T.attr("y",-6).attr("dy",u+14).attr("dx",0).attr("height",20).attr("width",29).text(function(t,e){return t[r.columnData()[W].ColumnDropdownList()]}),k.exit().remove()}},s.prototype.exit=function(t,o){e.prototype.exit.apply(this,arguments)},s}),function(t,e){"function"==typeof define&&define.amd?define("other/Persist",["../common/Utility","../common/Platform"],e):t.other_Persist=e(t.common_Utility,t.common_Platform)}(this,function(t,e){function o(t){return t.publishedProperties(!1,!0)}function i(t,e){t&&(e(t),o(t).forEach(function(o){switch(o.type){case"widget":i(t[o.id](),e);break;case"widgetArray":case"propertyArray":r(t[o.id](),e)}}))}function r(t,e){t&&t.forEach(function(t){i(t,e)})}function n(t,e,o){t.propertyWalker(e,o)}function a(t,e,o){i(t,function(t){n(t,e,o)})}function s(e,o){if(o=o&&"1.14.2-dev"!==o?o:"1.18.0",!e.__version)return e;var i=t.parseVersionString(e.__version),r=t.parseVersionString(o);if(1===i.major&&14===i.minor){console.log("Upgrading old persist from "+e.__version+" to "+o);var n=JSON.stringify(e);n=n.split('"'+e.__version).join('"'+o);var a=JSON.parse(n);return a.__properties&&a.__properties.content&&a.__properties.content.forEach(function(t){JSON.stringify(t).split("graph_Graph").length>1&&r.minor>=16&&(t.__properties.widget.__id=t.__properties.widget.__properties.widget.__id,t.__properties.widget.__class="composite_MegaChart",t.__properties.widget.__properties.showCSV=!1,t.__properties.widget.__properties.chartType="GRAPH",t.__properties.widget.__properties.chart=t.__properties.widget.__properties.widget,delete t.__properties.widget.__properties.chart.__id,delete t.__properties.widget.__properties.widget),"undefined"==typeof t.__properties.fields&&(t.__properties.fields=[])}),a}return e}return{discover:o,widgetWalker:i,widgetArrayWalker:r,propertyWalker:n,widgetPropertyWalker:a,serializeTheme:function(t,e){return JSON.stringify(this.serializeThemeToObject(t,e))},serializeThemeToObject:function(t,e){function o(t,e){var o=!1;for(var i in e)if(-1!==t.indexOf(e[i])){o=!0;break}return o}e=e||["surface","Color","Font","palette"];var i={};return a(t,null,function(t,r){if((t[r.id+"_modified"]()||t.publishedProperty(r.id).origDefaultValue!==t.publishedProperty(r.id).defaultValue)&&o(r.id,e)){var n=t._class.trim().split(" ");for(var a in n){if(void 0===i[n[a]]&&(i[n[a]]={}),void 0===i[n[a]][r.id]){i[n[a]][r.id]=t[r.id]();break}if(i[n[a]][r.id]===t[r.id]())break}}}),i},removeTheme:function(t,e){a(t,null,function(t,e){t.publishedProperty(e.id).defaultValue=t.publishedProperty(e.id).origDefaultValue}),"function"==typeof e&&e.call(this)},applyTheme:function(t,e,o){var i=this;a(t,null,function(t,o){switch(o.type){case"widget":return i.applyTheme(t[o.id](),e),!0;case"widgetArray":var r=t[o.id]();return r.forEach(function(t){i.applyTheme(t,e)},this),!0;default:t.applyTheme(e)}}),"function"==typeof o&&o.call(this)},serializeToObject:function(t,e,o,i){var r={__class:t.classID()};0!==t._id.indexOf(t._idSeed)&&(r.__id=t._id),t.version&&(r.__version=t.version()),r.__properties={};var a=this;if(n(t,e,function(e,n){if(e[n.id+"_modified"]())switch(n.type){case"widget":return r.__properties[n.id]=a.serializeToObject(e[n.id](),null,o,i&&!t.serializeState),!0;case"widgetArray":case"propertyArray":r.__properties[n.id]=[];var s=e[n.id]();return s.forEach(function(e,s){r.__properties[n.id].push(a.serializeToObject(e,null,o,i&&!t.serializeState))}),!0;default:r.__properties[n.id]=e[n.id]()}}),"marshaller_Graph"===t.classID()){var s=t.data().vertices;s&&(this.__vertices=s.map(function(e){return this.serializeToObject(e,null,o,i&&!t.serializeState)},this))}return o&&t.data&&(r.__data||(r.__data={}),r.__data.data=t.data()),i&&(t.serializeState?r.__state=t.serializeState():t.data&&(r.__state={data:t.data()})),r},serialize:function(t,e,o,i){return JSON.stringify(this.serializeToObject(t,e,o,i))},deserializeFromObject:function(t,e,o){var i=this;return new Promise(function(r,n){var s=0;a(t,null,function(t,o){if(t[o.id+"_reset"](),void 0!==e.__properties[o.id])switch(o.type){case"widget":++s;var r=o.id;i.create(e.__properties[o.id],function(e){t[r](e),--s});break;case"widgetArray":case"propertyArray":var n=o.id,a=e.__properties[o.id];if(a.length){++s;var l=[];l.length=a.length;var p=0;a.forEach(function(e,o){++p,i.create(e,function(e){e._owner=t,l[o]=e,--p});var r=setInterval(function(){0>=p&&(clearInterval(r),p=void 0,t[n](l),--s)},20)})}break;default:t[o.id](e.__properties[o.id])}});var l=setInterval(function(){if(0>=s){if(clearInterval(l),s=void 0,e.__data)for(var i in e.__data)switch(i){case"data":t.data(e.__data[i]);break;default:console.log("Unexpected __data item:  "+i),t[i](e.__data[i])}e.__state&&(t.deserializeState?t.deserializeState(e.__state):e.__state.data&&t.data&&t.data(e.__state.data)),o&&(console.log("Deprecated:  callback, use promise (Persist.deserializeFromObject)"),o(t)),r(t)}},20)})},deserialize:function(t,e,o){"string"==typeof e&&(e=JSON.parse(e)),e.__id&&0!==e.__id.indexOf(t._idSeed)&&t._id!==e.__id&&console.log("Deserialize:  IDs do not match - "+t._id),this.deserializeFromObject(t,e,o)},create:function(o,i){"string"==typeof o&&(o=JSON.parse(o)),o=s(o,(new e).version());var r=this;return t.requireWidget(o.__class).then(function(t){var e=new t;return o.__id&&0!==o.__id.indexOf(e._idSeed)&&0!==o.__id.indexOf("_pe")&&(e._id=o.__id),r.deserializeFromObject(e,o,i)})["catch"](function(t){console.log("Persist.create:  ***exception***"),console.log(t),i&&(console.log("Deprecated:  callback, use promise (Persist.create)"),i(null))})},clone:function(t,e){this.create(this.serializeToObject(t,[],!0,!0),e)}}}),function(t,e){"function"==typeof define&&define.amd?define("other/PropertyEditor",["d3","../common/HTMLWidget","../other/Persist","../layout/Grid","../common/Widget","css!./PropertyEditor"],e):t.other_PropertyEditor=e(t.d3,t.common_HTMLWidget,t.other_Persist,t.layout_Grid,t.common_Widget)}(this,function(t,e,o,i,r){function n(t){switch(t){case"widget":case"widgetArray":case"propertyArray":return!0}return!1}function a(){e.call(this),this._parentPropertyEditor=null,this._tag="div",this._show_settings=!1}a.prototype=Object.create(e.prototype),a.prototype.constructor=a,a.prototype._class+=" other_PropertyEditor",a.prototype.publish("showFields",!1,"boolean","If true, widget.fields() will display as if it was a publish parameter.",null,{tags:["Basic"]}),a.prototype.publish("showData",!1,"boolean","If true, widget.data() will display as if it was a publish parameter.",null,{tags:["Basic"]}),a.prototype.publish("sorting","none","set","Specify the sorting type",["none","A-Z","Z-A","type"],{tags:["Basic"],icons:["fa-sort","fa-sort-alpha-asc","fa-sort-alpha-desc","fa-sort-amount-asc"]}),a.prototype.publish("hideNonWidgets",!1,"boolean","Hides non-widget params (at this tier only)",null,{tags:["Basic"]}),a.prototype.publish("label","","string","Label to display in header of property editor table",null,{tags:["Basic"]}),a.prototype.publish("filterTags","","set","Only show Publish Params of this type",["Basic","Intermediate","Advance",""],{}),a.prototype.publish("excludeTags",[],"array","Exclude this array of tags",null,{}),a.prototype.publish("excludeParams",[],"array","Exclude this array of params (widget.param)",null,{}),a.prototype.publish("widget",null,"widget","Widget",null,{tags:["Basic"],render:!1}),a.prototype.parentPropertyEditor=function(t){return arguments.length?(this._parentPropertyEditor=t,this):this._parentPropertyEditor},a.prototype._widgetOrig=a.prototype.widget,a.prototype.widget=function(t){if(arguments.length&&this._widgetOrig()===t)return this;var e=a.prototype._widgetOrig.apply(this,arguments);if(arguments.length&&(this.watchWidget(t),t instanceof i)){var o=this;t.postSelectionChange=function(){o._selectedItems=t._selectionBag.get().map(function(t){return t.widget}),o.lazyRender()}}return e},a.prototype.show_settings=function(t){return arguments.length?(this._show_settings=t,this):this._show_settings},a.prototype.rootWidgets=function(){return this._selectedItems&&this._selectedItems.length?this._selectedItems:this.show_settings()?[this]:this.widget()?[this.widget()]:[]},a.prototype.update=function(o,i){e.prototype.update.apply(this,arguments);var r=this,n=this.rootWidgets().filter(function(t){return t._owningWidget&&t._owningWidget.excludeObjs instanceof Array&&-1!==t._owningWidget.excludeObjs.indexOf(t.classID())?!1:!0}),a=i.selectAll(".table"+this.id()).data(n,function(t){return t.id()});a.enter().append("table").attr("class","property-table table"+this.id()).each(function(e){var o=t.select(this);o.append("thead").append("tr").append("th").datum(o).attr("colspan","2").each(function(e){var o=t.select(this);o.append("span"),r.thButtons(o)}),o.append("tbody")}),a.each(function(e){var o=t.select(this);o.select("thead > tr > th > span").text(function(t){var e="";return r.label()&&(e+=r.label()),t&&t.classID&&(e&&(e+=" - "),e+=t.classID()),e}),o.selectAll("i").classed("fa-eye",!r.hideNonWidgets()).classed("fa-eye-slash",r.hideNonWidgets()),r.renderInputs(o.select("tbody"),e)}),a.exit().each(function(t){r.renderInputs(i.select("tbody"),null)}).remove()},a.prototype.exit=function(t,o){e.prototype.exit.apply(this,arguments),this.watchWidget(null)};var s=0;return a.prototype.watchWidget=function(t){if(this._watch&&(window.__hpcc_debug&&(--s,console.log("watchDepth:  "+s)),this._watch.remove(),delete this._watch),t){var e=this;this._watch=t.monitor(function(t,o,i){i!==o&&e.lazyRender()}),window.__hpcc_debug&&(++s,console.log("watchDepth:  "+s))}},a.prototype.thButtons=function(t){var e=this,o=t.append("i").attr("class","fa fa-minus-square-o").on("click",function(t){t.classed("property-table-collapsed",!t.classed("property-table-collapsed")),o.classed("fa-minus-square-o",!t.classed("property-table-collapsed")).classed("fa-plus-square-o",t.classed("property-table-collapsed"))});if(null===this.parentPropertyEditor()){var i=t.append("i").attr("class","fa "+e.__meta_sorting.ext.icons[e.sorting_options().indexOf(e.sorting())]).on("click",function(){var t=e.sorting(),o=e.sorting_options(),r=e.__meta_sorting.ext.icons;i.classed(r[o.indexOf(t)],!1).classed(r[(o.indexOf(t)+1)%o.length],!0),e.sorting(o[(o.indexOf(t)+1)%o.length]).render()}),r=t.append("i").attr("class","fa "+(e.hideNonWidgets()?"fa-eye-slash":"fa-eye")).on("click",function(){r.classed("fa-eye",e.hideNonWidgets()).classed("fa-eye-slash",!e.hideNonWidgets()),e.hideNonWidgets(!e.hideNonWidgets()).render()});r.classed("fa-eye",!e.hideNonWidgets()).classed("fa-eye-slash",e.hideNonWidgets())}},a.prototype.gatherDataTree=function(t){if(!t)return null;var e={label:t.id()+" ("+t.classID()+")",children:[]},i=o.discover(t);return i.forEach(function(o){var i={label:o.id,children:[]};switch(o.type){case"widget":i.children.push(this.gatherDataTree(t[o.id]()));break;case"widgetArray":case"propertyArray":var r=t[o.id]();r&&r.forEach(function(t){i.children.push(this.gatherDataTree(t))},this)}e.children.push(i)},this),e},a.prototype.getDataTree=function(){return this.gatherDataTree(this.rootWidget())},a.prototype._rowSorting=function(t){if("type"===this.sorting()){var e=["boolean","number","string","html-color","array","object","widget","widgetArray","propertyArray"];t.sort(function(t,o){return t.type===o.type?t.id<o.id?-1:1:e.indexOf(t.type)<e.indexOf(o.type)?-1:1})}else"A-Z"===this.sorting()?t.sort(function(t,e){return t.id<e.id?-1:1}):"Z-A"===this.sorting()&&t.sort(function(t,e){return t.id>e.id?-1:1})},a.prototype.filterInputs=function(t){var e=o.discover(t);if((this.filterTags()||this.excludeTags().length>0||this.excludeParams.length>0)&&t instanceof a==!1){var i=this;return e.filter(function(e,o){for(var r=0;r<i.excludeParams().length;r++){var n,a,s,l=i.excludeParams()[r].split(".");if(l.length>2?(n=l[0],a=l[1],s=l[2]):(n=l[0],s=l[1]),-1!==t["class"]().indexOf(n))return e.id===s?!1:!0}return i.excludeTags().length>0&&e.ext&&e.ext.tags&&e.ext.tags.some(function(t){return i.excludeTags().indexOf(t)>-1})?!1:i.filterTags()&&e.ext&&e.ext.tags&&-1!==e.ext.tags.indexOf(i.filterTags())||!i.filterTags()?!0:!1})}return e},a.prototype.renderInputs=function(e,o){var i=this,r=[],a=!this.show_settings()&&this.showFields();o&&(r=this.filterInputs(o).filter(function(t){return"fields"!==t.id?!0:a}),!this.show_settings()&&this.showData()&&o.data&&r.push({id:"data",type:"array"}),this.hideNonWidgets()&&(r=r.filter(function(t){return n(t.type)})),this._rowSorting(r));var s=e.selectAll("tr.prop"+this.id()).data(r,function(t){return t.id});s.enter().append("tr").attr("class","property-wrapper prop"+this.id()).each(function(e){var r=t.select(this);if(n(e.type))r.classed("property-widget-wrapper",!0),r.append("td").attr("colspan","2");else{r.classed("property-input-wrapper",!0),r.append("td").classed("property-label",!0).text(e.id);var a=r.append("td").classed("property-input-cell",!0);i.enterInputs(o,a,e)}}),s.each(function(e){var r=t.select(this);r.classed("disabled",o[e.id+"_disabled"]&&o[e.id+"_disabled"]()),r.attr("title",e.description),n(e.type)?i.updateWidgetRow(o,r.select("td"),e):i.updateInputs(o,e)}),s.exit().each(function(e){var r=t.select(this);n(e.type)&&i.updateWidgetRow(o,r.select("td"),null)}).remove(),s.order()},a.prototype.updateWidgetRow=function(e,o,i){var r=[];e&&i&&(r=e[i.id]()||[]);
var n=r instanceof Array?r:[r];if(i&&i.ext&&i.ext.autoExpand){var s=!0,l=n.filter(function(t,o){return s=t.publishedModified(),t._owner=e,s||o===n.length-1},this),p=n.length-l.length;s&&(p=!0,l.push(new i.ext.autoExpand(e))),p&&(e[i.id](l),n=l)}var u=this,c=o.selectAll("div.propEditor"+this.id()).data(n,function(t){return t.id()});c.enter().append("div").attr("class","property-input-cell propEditor"+this.id()).each(function(e){t.select(this).attr("data-widgetid",e.id()).property("data-propEditor",(new a).label(i.id).target(this))}),c.each(function(e){t.select(this).property("data-propEditor").parentPropertyEditor(u).showFields(u.showFields()).showData(u.showData()).sorting(u.sorting()).filterTags(u.filterTags()).excludeTags(u.excludeTags()).excludeParams(u.excludeParams()).hideNonWidgets(u.hideNonWidgets()&&e._class.indexOf("layout_")>=0).widget(e).render()}),c.exit().each(function(e){var o=t.select(this);o.property("data-propEditor").widget(null).render().target(null),o.property("data-propEditor",null)}).remove()},a.prototype.setProperty=function(t,e,o){for(var i=this;i&&t;)if(i===this&&t[e](o),t._parentElement){var r=i;t.render(function(t){r.render()}),i=null}else i=i.parentPropertyEditor(),t=i.widget()},a.prototype.enterInputs=function(e,o,i){o.classed(i.type+"-cell",!0);var r=this;switch("function"==typeof i.ext.editor_input&&i.ext.editor_input(this,e,o,i),i.type){case"boolean":o.append("input").attr("id",this.id()+"_"+i.id).classed("property-input",!0).attr("type","checkbox").on("change",function(){r.setProperty(e,i.id,this.checked)});break;case"set":o.append("select").attr("id",this.id()+"_"+i.id).classed("property-input",!0).on("change",function(){r.setProperty(e,i.id,this.value)}).each(function(o){for(var r=t.select(this),n=e[i.id+"_options"](),a=0;a<n.length;a++)r.append("option").attr("value",n[a]).text(n[a])});break;case"array":case"object":o.append("textarea").attr("id",this.id()+"_"+i.id).classed("property-input",!0).on("change",function(){r.setProperty(e,i.id,JSON.parse(this.value))});break;default:i.ext&&i.ext.range?(o.append("span").classed("property-input-span",!0).attr("id",this.id()+"_"+i.id+"_currentVal").text(i.defaultValue),o.append("input").attr("type","range").attr("step",i.ext.range.step).attr("min",i.ext.range.min).attr("max",i.ext.range.max).attr("id",this.id()+"_"+i.id).classed("property-input",!0).on("input",function(){r.setProperty(e,i.id,this.value),t.select("#"+this.id+"_currentVal").text("Current Value: "+this.value)}).on("change",function(){r.setProperty(e,i.id,this.value),t.select("#"+this.id+"_currentVal").text("Current Value: "+this.value)})):(o.append("input").attr("id",this.id()+"_"+i.id).classed("property-input",!0).on("change",function(){r.setProperty(e,i.id,this.value)}),"html-color"!==i.type||this.isIE||o.append("input").attr("id",this.id()+"_"+i.id+"_2").classed("property-input",!0).attr("type","color").on("change",function(){r.setProperty(e,i.id,this.value)}))}},a.prototype.updateInputs=function(e,i){var n=t.selectAll("#"+this.id()+"_"+i.id+", #"+this.id()+"_"+i.id+"_2"),a=e?e[i.id]():"";switch(n.property("disabled",e[i.id+"_disabled"]&&e[i.id+"_disabled"]()),i.type){case"array":case"object":n.property("value",JSON.stringify(a,function(t,e){return e instanceof r?o.serialize(e):e}));break;case"boolean":n.property("checked",a);break;default:i.ext&&i.ext.range&&t.select("#"+this.id()+"_"+i.id+"_currentVal").text("Current Value: "+a),n.property("value",a)}},a}),function(t,e){"function"==typeof define&&define.amd?define("other/RadioCheckbox.js",["d3","../common/HTMLWidget","css!./RadioCheckbox"],e):t.other_RadioCheckbox=e(t.d3,t.common_HTMLWidget)}(this,function(t,e){function o(t){e.call(this)}return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype._class+=" other_RadioCheckbox",o.prototype.publish("label",null,"string","Label for RadioCheckbox"),o.prototype.publish("valueColumn",null,"set","RadioCheckbox display value",function(){return this.columns()},{optional:!0}),o.prototype.publish("textColumn",null,"set","RadioCheckbox value(s)",function(){return this.columns()},{optional:!0}),o.prototype.publish("sort",null,"set","Sort contents",["","ascending","descending"],{optional:!0}),o.prototype.publish("multiple",!1,"boolean","Multiple selection"),o.prototype.rcData=function(){var t=this._db.rollupView([this.textColumn(),this.valueColumn()]),e=[];if(e=e.concat(t.entries().map(function(t){return{text:t.key,value:t.values.length?t.values[0].key:"",origRow:t.values.length&&t.values[0].values.length?t.values[0].values[0]:[]}},this)),this.sort_exists()){var o="descending"===this.sort();e.sort(function(t,e){return t.text<e.text?o?1:-1:t.text>e.text?o?-1:1:0})}return e},o.prototype.enter=function(t,o){e.prototype.enter.apply(this,arguments),this._span=o.append("span"),this._label=this._span.append("label").attr("for",this.id()+"_radioCheckbox"),this._Checkbox=this._span.append("div").attr("id",this.id()+"_radioCheckbox")},o.prototype.update=function(o,i){e.prototype.update.apply(this,arguments);var r=this;this._label.text(this.label());var n=this._Checkbox.selectAll(".dataRow").data(this.rcData());n.enter().append("div").attr("class","dataRow").each(function(e,o){var i=t.select(this),n=r.id()+"_checkbox_"+o;i.append("input").attr("id",n).attr("name",r.id()+"_radioCheckbox").on("change",function(t){r.handleClick()}),i.append("label").attr("for",n)}),n.each(function(e,o){var i=t.select(this);i.select("input").attr("type",r.multiple()?"checkbox":"radio").attr("value",e.value),i.select("label").text(e.text)}),n.exit().remove(),n.order()},o.prototype.exit=function(t,o){this._span.remove(),e.prototype.exit.apply(this,arguments)},o.prototype.handleClick=function(){var e=[];this._Checkbox.selectAll(".dataRow > input").each(function(o,i){var r=t.select(this);r.property("checked")&&o&&o.origRow&&e.push(o.origRow)}),e.length?this.click(this.rowToObj(e[0]),this.valueColumn(),!0):this.click([],this.valueColumn(),!1)},o.prototype.click=function(t,e,o){console.log("Click:  "+JSON.stringify(t)+", "+e+", "+o)},o}),function(t,e){"function"==typeof define&&define.amd?define("other/Select.js",["d3","../common/HTMLWidget","css!./Select"],e):t.other_Select=e(t.d3,t.common_HTMLWidget)}(this,function(t,e){function o(t){e.call(this)}return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype._class+=" other_Select",o.prototype.publish("label",null,"string","Label for select"),o.prototype.publish("valueColumn",null,"set","Select display value",function(){return this.columns()},{optional:!0}),o.prototype.publish("textColumn",null,"set","Select value(s)",function(){return this.columns()},{optional:!0}),o.prototype.publish("optional",!0,"boolean","Optional Select"),o.prototype.publish("sort",null,"set","Sort contents",["","ascending","descending"],{optional:!0}),o.prototype.publish("multiple",!1,"boolean","Multiple selection"),o.prototype.publish("selectSize",5,"number","Size of multiselect box",null,{disable:function(t){return!t.multiple()}}),o.prototype.selectData=function(){var t=this._db.rollupView([this.textColumn(),this.valueColumn()]),e=[];if(e=e.concat(t.entries().map(function(t){return{text:t.key,value:t.values.length?t.values[0].key:"",origRow:t.values.length&&t.values[0].values.length?t.values[0].values[0]:[]}},this)),this.sort_exists()){var o="descending"===this.sort();e.sort(function(t,e){return t.text<e.text?o?1:-1:t.text>e.text?o?-1:1:0})}return this.optional()&&e.unshift({value:"",text:""}),e},o.prototype.enter=function(o,i){e.prototype.enter.apply(this,arguments),this._span=i.append("span"),this._label=this._span.append("label").attr("for",this.id()+"_select");var r=this;this._select=this._span.append("select").attr("id",this.id()+"_select").on("change",function(e){for(var o=[],i=r._select.node().options,n=0;n<i.length;++n){var a=i[n];a.selected&&o.push(t.select(a).datum().origRow)}o.length?r.click(r.rowToObj(o[0]),r.valueColumn(),!0):r.click([],r.valueColumn(),!1)})},o.prototype.update=function(t,o){e.prototype.update.apply(this,arguments),this._label.text(this.label()),this._select.attr("multiple",this.multiple()?this.multiple():null).attr("size",this.multiple()&&this.selectSize()?this.selectSize():null);var i=this._select.selectAll(".dataRow").data(this.selectData());i.enter().append("option").attr("class","dataRow"),i.attr("value",function(t){return t.value}).text(function(t){return t.text}),i.exit().remove(),i.order()},o.prototype.exit=function(t,o){this._span.remove(),e.prototype.exit.apply(this,arguments)},o.prototype.click=function(t,e,o){console.log("Click:  "+JSON.stringify(t)+", "+e+", "+o)},o}),function(t,e){"function"==typeof define&&define.amd?define("other/ThemeEditor.js",["../common/Widget","../common/HTMLWidget","./Persist","./PropertyEditor","css!./ThemeEditor"],e):t.other_PropertyEditor=e(t.common_Widget,t.common_HTMLWidget,t.other_Persist,t.other_PropertyEditor)}(this,function(t,e,o,i){function r(){e.call(this),this._tag="div",this._current_grouping=void 0,this._showing_columns=void 0,this._showing_data=void 0,this.columns(["Key","Value"]),this._contentEditors=[],this._showSettings=!0,this._defaultThemes=[],this._widgetObjsById={}}function n(t){var e=t.split(/(?=[0-9A-Z])/).map(function(t){return t.length>1?t+" ":t}).join("");return e.replace(/(?:^|\s)\S/g,function(t){return t.toUpperCase()})}function a(t,e,o,i){function r(t,e){var o="";return t.set.forEach(function(t){var i=t===e?" selected":"";o+="<option value='"+t+"'"+i+">"+t+"</option>"}),o}var n,a="",s="te-input-"+t.id+"-"+i;"undefined"!=typeof t.ext&&"undefined"!=typeof t.ext.inputType&&(n=t.ext.inputType),"undefined"!=typeof t.inputID&&(s=t.inputID);var l="data-paramid='"+t.id+"' data-wids='"+o.map(function(t){return"object"==typeof t.widget?t.widget._id:t}).join(",")+"'";switch(t.type){case"boolean":var p=e?" checked":"";a="<input id='"+s+"' "+l+" type='checkbox' class='te-checkbox te-input'"+p+">";break;case"number":"undefined"!=typeof n?"textarea"===n?a="<textarea id='"+s+"' class='te-textarea te-input' "+l+">"+e+"</textarea>":"range"===n&&(a="<input id='"+s+"' class='te-input' type='range' "+l+" value='"+e+"'  min='"+t.ext.min+"' max='"+t.ext.max+"' step='"+t.ext.step+"'>"):a="<input id='"+s+"' type='text' class='te-text te-input' "+l+" value='"+e+"'>";break;case"string":"undefined"!=typeof n?"textarea"===n&&(a="<textarea id='"+s+"' class='te-textarea te-input' "+l+">"+e+"</textarea>"):a="<input id='"+s+"' type='text' class='te-text te-input' value='"+e+"' "+l+">";break;case"html-color":var u=""===e?"":" value='"+e+"'";a="<input id='"+s+"' type='text' class='te-html-color-input te-input' "+l+" "+u+">",a+="<input type='color' class='te-html-color-button te-input' "+l+" "+u+">";break;case"set":var c=r(t,e);a="<select id='"+s+"' class='te-select te-input'"+l+">"+c+"</select>";break;case"array":a="<textarea id='"+s+"' class='te-textarea te-input' data-type='array' "+l+">"+e+"</textarea>"}return"undefined"!=typeof t.ext.saveButton&&(a+="<button id='"+t.ext.saveButtonID+"'>"+t.ext.saveButton+"</button>"),a}var s=function(t){return"function"==typeof window.g_defaultThemes&&window.g_defaultThemes(t),JSON.parse(localStorage.getItem("themeEditorThemes")||"{}")},l=function(t){return"function"==typeof window.g_defaultSerials&&window.g_defaultSerials(t),JSON.parse(localStorage.getItem("themeEditorSerials")||"{}")},p=function(t){var e=s(),o=[];for(var i in e)o.push(i);return"undefined"!=typeof t&&"undefined"!=typeof o[t]&&(o=o[t]),o},u=function(t){var e=l(),o=[];for(var i in e)o.push(i);return"undefined"!=typeof t&&"undefined"!=typeof o[t]&&(o=o[t]),o};r.prototype=Object.create(e.prototype),r.prototype._class+=" other_ThemeEditor",r.prototype.publish("themeMode",!0,"boolean","Edit default values",null,{tags:["Basic"]}),r.prototype.publish("saveTheme","","string","Save Theme",null,{tags:["Basic","Theme"],saveButton:"Save",saveButtonID:"te-save-button"}),r.prototype.publish("loadedTheme",p(1),"set","Loaded Theme",p(),{tags:["Basic","Theme"]}),r.prototype.publish("saveSerial","","string","Save Serial",null,{tags:["Basic","Serial"],saveButton:"Save",saveButtonID:"te-save-button"}),r.prototype.publish("loadedSerial",u(0),"set","Loaded Serial",u(),{tags:["Basic","Serial"]}),r.prototype.publish("showColumns",!0,"boolean","Show Columns",null,{tags:["Intermediate"]}),r.prototype.publish("showData",!0,"boolean","Show Data",null,{tags:["Intermediate"]}),r.prototype.publish("shareCountMin",1,"number","Share Count Min",null,{tags:["Private"]}),r.prototype.publish("paramGrouping","By Param","set","Param Grouping",["By Param","By Widget"],{tags:["Private"]}),r.prototype.publish("editorComplexity","Basic","set","Choose what publish properties to display within the editor.",["Basic","Intermediate","Advanced","Private"],{tags:["Private"]}),r.prototype.publish("sectionTitle","","string","Section Title",null,{tags:["Private"]}),r.prototype.publish("collapsibleSections",!0,"boolean","Collapsible Sections",null,{tags:["Intermediate"]}),r.prototype.getThemes=s,r.prototype.getSerials=l,r.prototype.getDefaultThemes=p,r.prototype.getDefaultSerials=u,r.prototype.showSettings=function(t){return arguments.length?(this._showSettings=t,this):this._showSettings},r.prototype.onChange=function(t,e){},r.prototype.enter=function(t,o){e.prototype.enter.apply(this,arguments),this._parentElement.style("overflow","auto")};var c=function(t){var e=!1;return"undefined"==typeof t._current_grouping?t._current_grouping=t._group_params_by:t._current_grouping!==t._group_params_by&&(e=!0),"undefined"==typeof t._showing_columns?t._showing_columns=t.showColumns():t._showing_columns!==t.showColumns()&&(e=!0),"undefined"==typeof t._showing_data?t._showing_data=t.showData():t._showing_data!==t.showData()&&(e=!0),e};return r.prototype.widgetProperty=function(t,e,o){return void 0===o?t[e]():t[e](o)},r.prototype.load=function(){},r.prototype.save=function(){},r.prototype.needsPropTableRedraw=function(t,e){var o=null===document.getElementById("te-themeEditorOptions");return o},r.prototype.update=function(t,i){e.prototype.update.apply(this,arguments),c(this)&&i.selectAll("#"+this._id+" > table").remove(),this._current_grouping=this.paramGrouping(),this._widgetObjsById[this._id]=this,this._sharedProperties=this.findSharedProperties(this.data());var r=this.needsPropTableRedraw();if(r&&this.showSettings()){var n=o.discover(this);for(var s in n)if(-1!==n[s].ext.tags.indexOf(this.editorComplexity())){var l=this[n[s].id]();("loadedTheme"===n[s].id||"loadedSerial"===n[s].id)&&(n[s].inputID="te-load-theme"),n[s].input=a(n[s],l,[this._id],this._id)}else delete n[s];t.innerHTML=this.propertiesTableHtml(n);var p=document.createEvent("Events");p.initEvent("TE Properties Ready",!0,!0),document.dispatchEvent(p)}this.buildTableObjects(t,this._sharedProperties),this.initFunctionality(t)},r.prototype.exit=function(t,o){e.prototype.exit.apply(this,arguments)},r.prototype.click=function(t){},r.prototype.propertiesTableHtml=function(t){var e={id:"te-themeEditorOptions",label:"Editor Options",rowArr:[]},o={id:"te-tableModeOptions",label:this.themeMode()?"Save/Load Theme":"Save/Load Serial",rowArr:[]};for(var i in t)this.themeMode()?-1===t[i].ext.tags.indexOf("Theme")&&-1===t[i].ext.tags.indexOf("Serial")?e.rowArr.push({th:n(t[i].id),td:t[i].input,trClass:"propertyRow"}):-1!==t[i].ext.tags.indexOf("Theme")&&o.rowArr.push({th:n(t[i].id),td:t[i].input,trClass:"propertyRow"}):-1===t[i].ext.tags.indexOf("Serial")&&-1===t[i].ext.tags.indexOf("Theme")?e.rowArr.push({th:n(t[i].id),td:t[i].input,trClass:"propertyRow"}):-1!==t[i].ext.tags.indexOf("Serial")&&o.rowArr.push({th:n(t[i].id),td:t[i].input,trClass:"propertyRow"});var r="";return e.rowArr.length>0&&(r+=this.tableObjHtml(e)),o.rowArr.length>0&&(r+=this.tableObjHtml(o)),r},r.prototype.buildTableObjects=function(t,e){var o={};o=this.themeMode()?{chartColorSection:{id:"te-colorOptions",label:"Chart Colors",rowObjArr:[]},surfaceSection:{id:"te-containerOptions",label:"Container Styles/Colors",rowObjArr:[]},fontSection:{id:"te-fontOptions",label:"Font Styles/Colors",rowObjArr:[]}}:{nonSurfaceSection:{id:"te-chartOptions",label:"Chart Properties",rowObjArr:[]}};for(var i in e)this.themeMode()?-1===i.toUpperCase().indexOf("FONT")||-1!==e[i].arr[0].widget._class.indexOf("layout_Surface")&&-1!==i.toUpperCase().indexOf("COLOR")?"paletteID"===i?o.chartColorSection.rowObjArr.push(e[i]):-1!==e[i].arr[0].widget._class.indexOf("layout_Surface")&&o.surfaceSection.rowObjArr.push(e[i]):o.fontSection.rowObjArr.push(e[i]):-1===e[i].arr[0].widget._class.indexOf("layout_Surface")&&o.nonSurfaceSection.rowObjArr.push(e[i]);var r="";for(var n in o)r+=this.sharedPropertyTableHtml(o[n]);t.innerHTML+=r},r.prototype.initFunctionality=function(t){function e(t){if(r.showSettings()){var e=document.getElementById("te-save-button");e.onclick=function(t){var e=t.srcElement,o=e.previousSibling.value;if(o.length>1){var i,n=document.getElementById("te-load-theme"),a=n.getElementsByTagName("option"),s=!1;for(var l in a){var p=a[l].value;p===o&&(s=!0)}if(s){var u=confirm("'"+o+"' already exists. Do you want to overwrite the existing save? ");u&&(i=r.save(o))}else i=r.save(o),n.innerHTML+="<option value='"+o+"'>"+o+"</option>";e.previousSibling.value="",n.value=o}else alert("Save Name cannot be empty.")}}}function o(t){var e=t.getElementsByClassName("te-input");for(var o in e){if(isNaN(parseInt(o)))break;var i=e[o],n=i.getAttribute("id");"te-load-theme"===n?i.onchange=function(t){var e=t.srcElement;r.load(e.value)}:null!==n&&-1!==n.indexOf("te-input-themeMode")?i.onchange=function(t){var e=t.srcElement;r.themeMode(e.checked);var o=document.getElementById("te-load-theme"),i=null!==o?o.value:"Default";r.load(i)}:("INPUT"===i.tagName||"SELECT"===i.tagName||"TEXTAREA"===i.tagName)&&(i.onchange=function(t){var e=t.srcElement,o=e.getAttribute("id");-1!==e.className.split(" ").indexOf("te-html-color-button")&&(o=e.previousSibling.getAttribute("id"),e.previousSibling.value=e.value);var i=e.getAttribute("type"),n=o.split("-"),a=n.slice(0,n.length-1).join("-")+"-",s=e.getAttribute("data-wids"),l=e.getAttribute("data-paramid"),p=s.split(",");p.forEach(function(t){var o=a+t,n=document.getElementById(o);if("checkbox"===i)n.checked=e.checked,r._widgetObjsById[t][l](e.checked);else if("array"===e.getAttribute("data-type")){n.value=e.value;try{r._widgetObjsById[t][l](JSON.parse(e.value))}catch(s){}}else n.value=e.value,r._widgetObjsById[t][l](e.value),-1!==n.className.split(" ").indexOf("te-html-color-input")?n.nextSibling.value=e.value:-1!==n.className.split(" ").indexOf("te-html-color-button")&&(n.previousSibling.value=e.value)}),r.data().forEach(function(t){t.render()})})}}function i(t){var e=t.getElementsByClassName("te-section-table");for(var o in e)if("function"==typeof e[o].getElementsByTagName){var i=e[o].getElementsByTagName("thead");i[0].onclick=function(t){var e=t.toElement;"TH"===e.tagName&&(e=e.parentElement.parentElement);var o=e.parentElement,i="";-1===o.className.split(" ").indexOf("expanded")?(o.className="te-section-table expanded",i="shown"):(o.className="te-section-table collapsed",i="hidden");var r=o.getElementsByTagName("tbody");r[0].className=i}}var r=t.getElementsByClassName("sharedPropertyRow");for(var n in r)if("function"==typeof r[n].getElementsByClassName){var a=r[n].getElementsByClassName("te-label");a[0].onclick=function(t){var e=t.toElement,o=e.parentElement,i="";-1===o.className.split(" ").indexOf("expanded")?(o.className="sharedPropertyRow expanded",i="shown"):(o.className="sharedPropertyRow collapsed",i="hidden");for(var r=o.nextSibling;null!==r;)-1===r.className.split(" ").indexOf("sharedPropertyRow")?(r.className="propertyRow "+i,r=r.nextSibling):r=null}}}var r=this;i(t),o(t),e(t)},r.prototype.sharedPropertyTableHtml=function(t){function e(t){var e=t.widget.classID().split("_"),o=e.join("/");return o+" <i>["+t.widget._id+"]</i>"}function o(t){return n(t.id)}function i(t,e){function o(t,e){var o=t.arr[e].widget[t.id]();return null!==o?o:""}var i=o(t,e),r=a(t,i,[t.arr[e]],t.arr[e].widget._id);return r}function r(t){function e(t){var e=t.arr[0].widget[t.id]();return t.arr.forEach(function(t,o){return e!==t.widget[t.id]()?"":void 0}),null!==e?"array"===t.type?JSON.stringify(e):e:""}var o=e(t),i=a(t,o,t.arr,"shared");return i}var s={id:t.id,label:t.label,rowArr:[]};return t.rowObjArr.forEach(function(t){t.arr.forEach(function(n,a){0===a&&s.rowArr.push({th:o(t),td:r(t),trClass:"sharedPropertyRow collapsed"}),s.rowArr.push({th:e(n),td:i(t,a),trClass:"propertyRow hidden"})})}),this.tableObjHtml(s)},r.prototype.tableObjHtml=function(t){var e="<table id='"+t.id+"' class='te-section-table expanded'>";return e+="<thead><tr><th colspan='2'>"+t.label+"</th></tr></thead>",e+="<tbody>",t.rowArr.forEach(function(t){e+=this.tableRowObjHtml(t)},this),e+="</tbody>",e+"</table>"},r.prototype.tableRowObjHtml=function(t){var e="undefined"!=typeof t.trClass?"<tr class='"+t.trClass+"'>":"<tr>";return e+="<th class='te-label'>"+t.th+"</th>",e+="<td>"+t.td+"</td>",e+"</tr>"},r.prototype.setWidgetObjsById=function(t){var e=this,o=t.widget[t.id]();"widgetArray"===t.type?o.forEach(function(t){e._widgetObjsById[t._id]=t}):"widget"===t.type&&null!==o&&(this._widgetObjsById[o._id]=o)},r.prototype.checkTagFilter=function(t){var e=["Basic"],o=!1;return t.forEach(function(t){-1!==e.indexOf(t)&&(o=!0)}),o},r.prototype.findSharedProperties=function(t){function e(t,i){var n=[];if(null!==t){var a=o.discover(t);a.forEach(function(o,a){if("undefined"!=typeof o.ext.tags&&n.push({id:o.id,type:o.type,description:o.description,set:o.set,ext:o.ext,widget:t}),"widgetArray"===o.type){var s=r.widgetProperty(t,o.id);s.forEach(function(t){var o=e(t,i+1);n=n.concat(o)})}else if("widget"===o.type){var l=r.widgetProperty(t,o.id),p=e(l,i+1);n=n.concat(p)}})}return n}var i,r=this;if("undefined"!=typeof t&&t.length>0){var n=[];i={};var a={},s={};t.forEach(function(t){var o=e(t,0);n=n.concat(o)}),n.forEach(function(t){if(-1!==["widget","widgetArray"].indexOf(t.type))r.setWidgetObjsById(t);else if(r.checkTagFilter(t.ext.tags)){var e=t.id;-1!==t.widget._class.indexOf("Surface")?("undefined"==typeof a[e]&&(a[e]={arr:[]}),a[e].id=t.id,a[e].description=t.description,a[e].type=t.type,a[e].set=t.set,a[e].ext=t.ext,a[e].arr.push(t)):("undefined"==typeof s[e]&&(s[e]={arr:[]}),s[e].id=t.id,s[e].description=t.description,s[e].type=t.type,s[e].set=t.set,s[e].ext=t.ext,s[e].arr.push(t)),"undefined"==typeof i[e]&&(i[e]={arr:[]}),i[e].id=t.id,i[e].description=t.description,i[e].type=t.type,i[e].set=t.set,i[e].ext=t.ext,i[e].arr.push(t)}})}return i},r}),function(t,e){"function"==typeof define&&define.amd?define("other/WordCloud.js",["d3","../common/SVGWidget","../api/I2DChart","../api/ITooltip","d3-cloud","css!./WordCloud"],e):t.other_WordCloud=e(t.d3,t.common_SVGWidget,t.api_I2DChart,t.api_ITooltip,t.d3.layout.cloud)}(this,function(t,e,o,i,r){function n(){e.call(this),o.call(this),i.call(this),this._prevOffsetX=this.offsetX(),this._prevOffsetY=this.offsetY(),this._prevZoom=this.zoom(),this._vizData=[]}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype._class+=" other_WordCloud",n.prototype["implements"](o.prototype),n.prototype["implements"](i.prototype),n.prototype.publish("paletteID","default","set","Palette ID",n.prototype._palette["switch"](),{tags:["Basic","Shared"]}),n.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),n.prototype.publish("fontFamily","Impact","string","Font Name",null,{tags:["Basic"]}),n.prototype.publish("fontSizeFrom",6,"number","Font Size From",null,{tags:["Basic"]}),n.prototype.publish("fontSizeTo",48,"number","Font Size To",null,{tags:["Basic"]}),n.prototype.publish("angleFrom",-60,"number","Angle From",null,{tags:["Basic"]}),n.prototype.publish("angleTo",60,"number","Angle To",null,{tags:["Basic"]}),n.prototype.publish("angleCount",5,"number","Angle Count",null,{tags:["Basic"]}),n.prototype.publish("padding",0,"number","Padding",null,{tags:["Intermediate"]}),n.prototype.publish("scaleMode","linear","set","Text scaling mode",["linear","log","sqrt","pow"],{tags:["Intermediate"]}),n.prototype.publish("spiral","archimedean","set","Text scaling mode",["archimedean","rectangular"],{tags:["Intermediate"]}),n.prototype.publish("offsetX",0,"number","X offset",null,{tags:["Advanced"]}),n.prototype.publish("offsetY",0,"number","Y offset",null,{tags:["Advanced"]}),n.prototype.publish("zoom",1,"number","Zoom",null,{tags:["Advanced"]}),n.prototype.data=function(t){var o=e.prototype.data.apply(this,arguments);return arguments.length&&(this._vizData=t.map(function(t){var e={};for(var o in t)e["__viz_"+o]=t[o];return e})),o},n.prototype.enter=function(o,i){e.prototype.enter.apply(this,arguments),this._root=i.append("g"),this._canvas=document.createElement("canvas");var n=this;this._zoom=t.behavior.zoom().scaleExtent([.1,10]).on("zoom",function(){n.zoomed(n._zoom,t.event.translate,t.event.scale)}),i.call(this._zoom),this._cloud=(new r).canvas(this._canvas),this.tooltipHTML(function(t){var e=n.columns(),o=e&&e.length?e[0]:"Word";return n.tooltipFormat({label:t.__viz_0,series:o,value:t.__viz_1})})},n.prototype.update=function(o,i){function r(t,e){var o=n._root.selectAll("text").data(t,function(t){return t.__viz_0?t.__viz_0.toLowerCase():""});o.enter().append("text").attr("text-anchor","middle").text(function(t){return t.__viz_0}).on("click",function(t){n.click({label:t.__viz_0,weight:t.__viz_1})}).on("dblclick",function(t){n.dblclick({label:t.__viz_0,weight:t.__viz_1})}).on("mouseout.tooltip",n.tooltip.hide).on("mousemove.tooltip",n.tooltip.show).style("opacity",1e-6),o.style("font-size",function(t){return s(t.__viz_1)+"px"}).style("font-family",n.fontFamily()).transition().duration(1e3).attr("transform",function(t){return"translate("+[t.x,t.y]+")rotate("+t.rotate+")"}).style("fill",function(t){return n._palette(t.__viz_0?t.__viz_0.toLowerCase():"")}).style("opacity",1),o.exit().transition().duration(1e3).style("opacity",1e-4).remove()}e.prototype.update.apply(this,arguments),this._palette=this._palette["switch"](this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id())),this.zoomed(this,[this.offsetX(),this.offsetY()],this.zoom());var n=this,a=t.extent(this._vizData,function(t){return t.__viz_1}),s=t.scale[this.scaleMode()]().domain(a).range([this.fontSizeFrom(),this.fontSizeTo()]),l=t.scale.linear().domain([0,n.angleCount()-1]).range([n.angleFrom(),n.angleTo()]);this._cloud.stop().size([this.width(),this.height()]).words(this._vizData).font(this.fontFamily()).padding(this.padding()).spiral(this.spiral()).text(function(t){return t.__viz_0}).fontSize(function(t){return s(t.__viz_1)}).rotate(function(){return l(~~(Math.random()*n.angleCount()))}).on("end",r).start()},n.prototype.zoomed=function(t,e,o){if(e[0]!==this._prevOffsetX||e[1]!==this._prevOffsetY||o!==this._prevZoom){switch(this._root.attr("transform","translate("+e[0]+","+e[1]+")scale("+o+")"),t){case this:this._zoom.scale(o).translate(e);break;case this._zoom:this.offsetX(e[0]),this.offsetY(e[1]),this.zoom(o)}this._prevOffsetX=e[0],this._prevOffsetY=e[1],this._prevZoom=o}},n});