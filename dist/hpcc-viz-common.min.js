!function(t,e){"function"==typeof define&&define.amd?define("common/Class.js",[],e):t.common_Class=e()}(this,function(){function t(){}return t.prototype.constructor=t,t.prototype._class="common_Class",t.prototype["class"]=function(t){return arguments.length?(this._class=t,this):this._class},t.prototype.classID=function(){return this._class.split(" ").pop()},t.prototype["implements"]=function(t){for(var e in t)t.hasOwnProperty(e)&&(void 0===this[e]?this[e]=t[e]:window.__hpcc_debug&&console.log("Duplicate member:  "+e))},t.prototype.mixin=function(t){this["implements"](t.prototype),t.prototype.hasOwnProperty("_class")&&(this._class+=" "+t.prototype._class.split(" ").pop())},t.prototype.overrideMethod=function(t,e){if(void 0===this[t])throw"Method:  "+t+" does not exist.";var i=this[t];return this[t]=function(){return e(i,arguments)},this},t}),function(t,e){"function"==typeof define&&define.amd?define("common/Platform.js",["d3","es6-promise"],e):(t.require=t.require||function(e,i){"function"==typeof e&&(i=e,e=[]);var n=e.map(function(e){var i=0===e.indexOf("src/")?"src/".length:0===e.indexOf("hpcc-viz/")?"hpcc-viz/".length:0===e.indexOf("../")?"../".length:0,n=e.substring(i).split("/").join("_");return t[n]});i.apply(null,n)},t.common_Platform=e(t.d3))}(this,function(t){function e(){}var i="1.20.7-rc2";return e.prototype.version=function(){return i},e.prototype.ieVersion=function(){var t,e=navigator.userAgent,i=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(i[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],parseFloat(t[1])):/msie/i.test(i[1])?parseFloat(i[2]):null}(),e.prototype.isIE=null!==e.prototype.ieVersion,e.prototype.svgMarkerGlitch=e.prototype.isIE&&e.prototype.ieVersion<=12,e.prototype.MutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver||function(t){this.callback=t,this.listeners=[];var e=function(t,e,i){this.callback=t,this.domNode=e,this.type=i};e.prototype={handleEvent:function(t){var e={type:this.type,target:this.domNode,addedNodes:[],removedNodes:[],previousSibling:t.target.previousSibling,nextSibling:t.target.nextSibling,attributeName:null,attributeNamespace:null,oldValue:null};this.callback([e])}},this.observe=function(t,i){var n=null;i.attributes&&(n=new e(this.callback,t,"attributes"),this.listeners.push(n),t.addEventListener("DOMAttrModified",n,!0)),i.characterData&&(n=new e(this.callback,t,"characterData"),this.listeners.push(n),t.addEventListener("DOMCharacterDataModified",n,!0)),i.childList&&(n=new e(this.callback,t,"childList"),this.listeners.push(n),t.addEventListener("DOMNodeInserted",n,!0),t.addEventListener("DOMNodeRemoved",n,!0))},this.disconnect=function(){this.listeners.forEach(function(t){switch(t.type){case"attributes":t.domNode.removeEventListener("DOMAttrModified",t,!0);break;case"characterData":t.domNode.removeEventListener("DOMCharacterDataModified",t,!0);break;case"childList":t.domNode.removeEventListener("DOMNodeRemoved",t,!0),t.domNode.removeEventListener("DOMNodeInserted",t,!0)}}),this.listeners=[]}},window.MutationObserver||(window.MutationObserver=e.prototype.MutationObserver),e.prototype._scrollBarWidth=null,e.prototype.getScrollbarWidth=function(){if(null===e.prototype._scrollBarWidth){var t=document.createElement("div");t.style.visibility="hidden",t.style.width="100px",t.style.msOverflowStyle="scrollbar",document.body.appendChild(t);var i=t.offsetWidth;t.style.overflow="scroll";var n=document.createElement("div");n.style.width="100%",t.appendChild(n);var o=n.offsetWidth;t.parentNode.removeChild(t),e.prototype._scrollBarWidth=i-o}return e.prototype._scrollBarWidth},e.prototype.debounce=function(t,e,i){return function(){function n(){i||t.apply(o,r),o.__hpcc_debounce_timeout=null}var o=this||{},r=arguments;o.__hpcc_debounce_timeout?clearTimeout(o.__hpcc_debounce_timeout):i&&t.apply(o,r),o.__hpcc_debounce_timeout=setTimeout(n,e||100)}},Math.sign=Math.sign||function(t){return t=+t,0===t||isNaN(t)?t:t>0?1:-1},e}),function(t,e){"function"==typeof define&&define.amd?define("common/PropertyExt.js",["./Class"],e):t.common_PropertyExt=e(t.common_Class)}(this,function(t){function e(t){return 0===t.indexOf(s)}function i(t,e){return t[a+e]}function n(t,e,i,n,o,r){switch(r=r||{},this.id=t,this.type=i,this.origDefaultValue=e,this.defaultValue=r.optional&&null===e?void 0:e,this.description=n,this.set=o,this.ext=r,i){case"set":this.checkedAssign=function(e){var n="function"==typeof o?o.call(this):o;return(!n||n.indexOf(e)<0)&&console.error("Invalid value for '"+t+"':  "+e+" expected "+i),e};break;case"html-color":this.checkedAssign=function(e){if(window.__hpcc_debug&&e&&"red"!==e){var n="red",o=document.createElement("div");o.style.color=n,o.style.color=e,(o.style.color===n||""===o.style.color)&&console.error("Invalid value for '"+t+"':  "+e+" expected "+i)}return e};break;case"boolean":this.checkedAssign=function(t){return"string"==typeof t&&["false","off","0"].indexOf(t.toLowerCase())>=0?!1:Boolean(t)};break;case"number":this.checkedAssign=function(t){return Number(t)};break;case"string":this.checkedAssign=function(t){return String(t)};break;case"array":this.checkedAssign=function(e){return e instanceof Array||console.error("Invalid value for '"+t+"':  "+e+" expected "+i),e};break;case"object":this.checkedAssign=function(e){return e instanceof Object||console.error("Invalid value for '"+t+"':  "+e+" expected "+i),e};break;case"widget":this.checkedAssign=function(e){return(!e._class||e._class.indexOf("common_PropertyExt")<0)&&console.error("Invalid value for '"+t+"':  "+e+" expected "+i),e};break;case"widgetArray":this.checkedAssign=function(e){return e.some(function(t){return!t._class||t._class.indexOf("common_Widget")<0})&&console.error("Invalid value for '"+t+"':  "+e+" expected "+i),e};break;case"propertyArray":this.checkedAssign=function(e){return e.some(function(t){return!t.publishedProperties})&&console.log("Invalid value for '"+t+"':  "+e+" expected "+i),e};break;default:this.checkedAssign=function(e){return window.__hpcc_debug&&console.error("Unchecked property type for '"+t+"':  "+e+" expected "+i),e}}}function o(t,e,i,n,o){this.id=t,this.type="proxy",this.proxy=e,this.method=i,this.defaultValue=n,this.ext=o||{}}function r(){t.call(this),this._id="_pe"+ ++l,this._watchArrIdx=0,this._watchArr={},this.publishedProperties(!0).forEach(function(t){switch(t.type){case"array":case"widgetArray":case"propertyArray":this[t.id+"_reset"]()}},this)}var s="__meta_",a="__private_",h="__prop_",c="__default_",l=0;return r.prototype=Object.create(t.prototype),r.prototype._class+=" common_PropertyExt",r.prototype.id=function(){return this._id},r.prototype.publishedProperties=function(t,n){var o=[];for(var r in this)if(e(r)&&(t||!i(this,r))){var s=this[r];if(n&&s.type){for(var a=this;"proxy"===s.type;)a=a[s.proxy],s=a.publishedProperty(s.method);s.id!==this[r].id&&(s=JSON.parse(JSON.stringify(s)),s.id=this[r].id)}o.push(s)}return o},r.prototype.propertyWalker=function(t,e){this.publishedProperties(!1,!0).forEach(function(i){"function"==typeof t&&t(this,i)||e(this,i)},this)},r.prototype.publishedProperty=function(t){return this[s+t]},r.prototype.publishedModified=function(t){return this.publishedProperties().some(function(t){return this[t.id+"_modified"]()},this)},r.prototype.publishReset=function(t,i){t=(t||[]).map(function(t){return s+t}),i=(i||[]).map(function(t){return s+t});for(var n in this)if(e(n)){var o=!t.length||t.length&&t.indexOf(n)>=0,r=i.indexOf(n)>=0;o&&!r&&(this[a+n]=!0)}},r.prototype.publish=function(t,e,i,o,r,l){if(l=l||{},void 0!==this[s+t]&&!l.override)throw t+" is already published.";var p=this[s+t]=new n(t,e,i,o,r,l);p.ext.internal&&(this[a+t]=!0),this[t]=function(e){return arguments.length?(void 0===e?e=null:""===e&&p.ext.optional?e=null:null!==e&&(e=p.checkedAssign.call(this,e)),this.broadcast(t,e,this[h+t]),null===e?delete this[h+t]:this[h+t]=e,this):this[t+"_disabled"]()?this[t+"_default"]():void 0!==this[h+t]?this[h+t]:this[t+"_default"]()},this[t+"_disabled"]=function(){return l&&l.disable?!!l.disable(this):!1},this[t+"_modified"]=function(){return void 0!==this[h+t]},this[t+"_exists"]=function(){return void 0!==this[h+t]||void 0!==this[t+"_default"]()},this[t+"_default"]=function(e){return arguments.length?(""===e&&(e=null),null===e?delete this[c+t]:this[c+t]=e,this):void 0!==this[c+t]?this[c+t]:p.defaultValue},this[t+"_reset"]=function(){switch(i){case"widget":this[h+t]&&this[h+t].target(null);break;case"widgetArray":this[h+t]&&this[h+t].forEach(function(t){t.target(null)})}switch(i){case"array":case"widgetArray":case"propertyArray":this[c+t]=this[t+"_default"]().map(function(t){return t})}return delete this[h+t],this},this[t+"_options"]=function(){if("function"==typeof r){var t=p.ext.optional?[null]:[];return t.concat(r.apply(this,arguments))}return r}},r.prototype.publishWidget=function(t,e,i){for(var n in e.prototype)if(0===n.indexOf("__meta")){var o=e.prototype[n];this.publishProxy(t+h+o.id,i,o.method||o.id)}},r.prototype.publishProxy=function(t,e,i,n){if(i=i||t,void 0!==this[s+t])throw t+" is already published.";this[s+t]=new o(t,e,i,n),this[t]=function(o){return arguments.length?(void 0!==n&&o===n?this[e][i+"_reset"]():this[e][i](o),this):void 0===n||this[t+"_modified"]()?this[e][i]():n},this[t+"_disabled"]=function(){return this[e][i+"_disabled"]()},this[t+"_modified"]=function(){return this[e][i+"_modified"]()&&(void 0===n||this[e][i]()!==n)},this[t+"_exists"]=function(){return this[e][i+"_exists"]()},this[t+"_default"]=function(t){return arguments.length?(this[e][i+"_default"](t),this):this[e][i+"_default"]()},this[t+"_reset"]=function(){return this[e][i+"_reset"](),this},this[t+"_options"]=function(){return this[e][i+"_options"]()}},r.prototype.monitorProperty=function(t,e){var i=this.publishedProperty(t);switch(i.type){case"proxy":return this[i.proxy]?this[i.proxy].monitorProperty(i.method,function(t,n,o){e(i.id,n,o)}):{remove:function(){}};default:var n=this._watchArrIdx++;this._watchArr[n]={propertyID:t,callback:e};var o=this;return{remove:function(){delete o._watchArr[n]}}}return null},r.prototype.monitor=function(t){return{_watches:this.publishedProperties().map(function(e){return this.monitorProperty(e.id,t)},this),remove:function(){this._watches.forEach(function(t){t.remove()})}}},r.prototype.broadcast=function(t,e,i,n){if(n=n||this,e!==i)for(var o in this._watchArr){var r=this._watchArr[o];void 0!==r.propertyID&&r.propertyID!==t||!r.callback||setTimeout(function(o){o.callback(t,e,i,n)},0,r)}},r.prototype.applyTheme=function(t){if(t){var e=this._class.split(" ");for(var i in e)if(t[e[i]])for(var n in t[e[i]])if("overrideTags"===n&&t[e[i]][n]instanceof Object)for(var o in t[e[i]][n])this.publishedProperty(n).ext&&(this.publishedProperty(n).ext.tags=t[e[i]][n][o]);else this.publishedProperty(n)&&(this.publishedProperty(n).defaultValue=t[e[i]][n])}},r.prototype.copyPropsTo=function(t){this.publishedProperties(!1).forEach(function(e){this[e.id+"_exists"]()?t[e.id](this[e.id]()):t[e.id+"_reset"]()},this)},r}),function(t,e){"function"==typeof define&&define.amd?define("common/Utility.js",["d3","require","es6-promise"],e):t.common_Utility=e(t.d3,t.require)}(this,function(t,e){function i(t,e,i,n,o){var r,s,a=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,h=/(^[ ]*|[ ]*$)/g,c=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,l=/^0x[0-9a-f]+$/i,p=/^0/,u=function(t){return!o&&(""+t).toLowerCase()||""+t},d=u(n?t[n]:t).replace(h,"")||"",f=u(n?e[n]:e).replace(h,"")||"",m=d.replace(a,"\x00$1\x00").replace(/\0$/,"").replace(/^\0/,"").split("\x00"),y=f.replace(a,"\x00$1\x00").replace(/\0$/,"").replace(/^\0/,"").split("\x00"),g=parseInt(d.match(l),16)||1!==m.length&&d.match(c)&&Date.parse(d),_=parseInt(f.match(l),16)||g&&f.match(c)&&Date.parse(f)||null;if(_){if(_>g)return"ascending"===i?-1:1;if(g>_)return"ascending"===i?1:-1}for(var v=0,x=Math.max(m.length,y.length);x>v;v++){if(r=!(m[v]||"").match(p)&&parseFloat(m[v])||m[v]||0,s=!(y[v]||"").match(p)&&parseFloat(y[v])||y[v]||0,isNaN(r)!==isNaN(s))return isNaN(r)?1:-1;if(typeof r!=typeof s&&(r+="",s+=""),s>r)return"ascending"===i?-1:1;if(r>s)return"ascending"===i?1:-1}return 0}function n(){this.items={}}function o(t,e){this.widgetElement(t),this.skipBringToTop(e)}function r(t){this._selection=new o(null,t)}function s(t){return"[object Array]"===Object.prototype.toString.call(t)}function a(t,e){return e=e?e:document.createElement("div"),e.innerHTML=t,e.textContent||e.innerText||""}function h(t){var e;if(2===arguments.length&&"object"==typeof arguments[1])e=arguments[1];else{e=new Array(arguments.length-1);for(var i=1;i<arguments.length;++i)e[i-1]=arguments[i]}e&&e.hasOwnProperty||(e={});for(var n in e)s(e[n])&&e[n].forEach(function(t,i){e[n+"["+i+"]"]=t});return t.replace(u,function(t,i){var n=e.hasOwnProperty(i)?e[i]:null;return null===n||void 0===n?t:a(n)}).replace(p,function(t,i){var n=e.hasOwnProperty(i)?e[i]:null;return null===n||void 0===n?"":n})}n.prototype.clear=function(){for(var t in this.items)this.items[t].element().classed("selected",!1);this.items={}},n.prototype.isEmpty=function(){for(var t in this.items)return!1;return!0},n.prototype.append=function(t){this.items[t._id]=t,t.element().classed("selected",!0)},n.prototype.remove=function(t){this.items[t._id].element().classed("selected",!1),delete this.items[t._id]},n.prototype.isSelected=function(t){return void 0!==this.items[t._id]},n.prototype.get=function(){var t=[];for(var e in this.items)t.push(this.items[e]);return t},n.prototype.set=function(t){this.clear(),t.forEach(function(t,e){this.append(t)},this)},n.prototype.click=function(t,e){e.ctrlKey?this.items[t._id]?this.remove(t):this.append(t):(this.clear(),this.append(t))},o.prototype.widgetElement=function(t){return arguments.length?(this._widgetElement=t,this):this._widgetElement},o.prototype.skipBringToTop=function(t){return arguments.length?(this._skipBringToTop=t,this):this._skipBringToTop},o.prototype.enter=function(e){var i=this;e.each(function(e){var n=i._initialSelection?i._initialSelection.indexOf(JSON.stringify(e))>=0:!1;t.select(this).classed("selected",n).classed("deselected",!n)}).on("click.SimpleSelection",function(e,n){i._skipBringToTop||this.parentNode.appendChild(this);var o=t.select(this),r=o.classed("selected");i._widgetElement.selectAll(".selected").classed("selected",!1).classed("deselected",!0),r||o.classed("selected",!0).classed("deselected",!1)}).on("mouseover.SimpleSelection",function(e,i){t.select(this).classed("over",!0)}).on("mouseout.SimpleSelection",function(e,i){t.select(this).classed("over",null)})},o.prototype.selected=function(e){return t.select(e).classed("selected")},o.prototype.selection=function(e){if(!arguments.length){var i=[];return this._widgetElement&&this._widgetElement.selectAll(".selected").each(function(t){i.push(JSON.stringify(t))}),i}return this._widgetElement?this._widgetElement.selectAll(".selected,.deselected").each(function(i){var n=e.indexOf(JSON.stringify(i))>=0;t.select(this).classed("selected",n).classed("deselected",!n)}):this._initialSelection=e,this},r.prototype.serializeState=function(){return{selection:this._selection.selection(),data:this.data()}},r.prototype.deserializeState=function(t){return t&&(this._selection.selection(t.selection),t.data&&this.data(t.data)),this};var c=window.performance,l=c&&(c.now||c.mozNow||c.msNow||c.oNow||c.webkitNow),p=/\{([0-9a-zA-Z_\s\[\]]+)\}/g,u=/\{\{([0-9a-zA-Z_\s\[\]]+)\}\}/g;return{naturalSort:function(t,e,n,o){return t.slice(0).sort(function(t,r){return i(t,r,e,n,o)})},multiSort:function(e,i){return i&&i.length&&e.sort(function(e,n){for(var o=0;o<i.length;++o){var r=e[i[o].idx],s=n[i[o].idx];if(r!==s)return i[o].reverse?t.descending(r,s):t.ascending(r,s)}return 0}),e},Selection:n,SimpleSelection:o,SimpleSelectionMixin:r,urlParams:function(){var t=window.location.search.split("?")[1],e={};return t&&t.split("&").forEach(function(t,i){var n=t.split("=");switch(n.length){case 1:e[decodeURIComponent(n[0])]=void 0;break;case 2:e[decodeURIComponent(n[0])]=decodeURIComponent(n[1]);break;default:throw"Invalid URL Param:  "+t}}),e},endsWith:function(t,e,i){var n=t.toString();("number"!=typeof i||!isFinite(i)||Math.floor(i)!==i||i>n.length)&&(i=n.length),i-=e.length;var o=n.indexOf(e,i);return-1!==o&&o===i},d3ArrayAdapter:function(t){return{ownerDocument:{createElement:function(e){return{get __data__(){return this.row},set __data__(e){this.row=t[this.index]=e}}},createElementNS:function(t,e){return this.createElement(e)}},querySelectorAll:function(e){if(e)throw"unsupported";var i=this;return t.map(function(e,n){return{ownerDocument:i.ownerDocument,parentNode:i,get __data__(){return e},set __data__(e){t[n]=e}}})},appendChild:function(e){return e.parentNode=this,e.index=t.length,t.push(null),e},insertBefore:function(e,i){var n=t.indexOf(e.__data__),o=t.indexOf(i.__data__);return n>o?t.splice(o,0,t.splice(n,1)[0]):o-1>n&&t.splice(o-1,0,t.splice(n,1)[0]),e},removeChild:function(e){return t.splice(t.indexOf(e.__data__),1),e}}},downloadBlob:function(e,i,n,o){var r=new Date,s=t.time.format("%Y-%m-%dT%H_%M_%S"),a=s(r);n=n||"data_"+a+"."+e.toLowerCase();var h=n+(o?"."+o:""),c="";switch(e){case"TSV":c="text/tab-seperated-values";break;case"JSON":c="application/json";break;default:c="text/csv"}var l=document.createElement("a");if(navigator.msSaveBlob)return l=null,navigator.msSaveBlob(new Blob([i],{type:c}),h);if("download"in l)return l.href="data:"+c+","+encodeURIComponent(i),l.setAttribute("download",h),document.body.appendChild(l),setTimeout(function(){l.click(),document.body.removeChild(l)},10),!0;l=null;var p=document.createElement("iframe");return document.body.appendChild(p),p.src="data:"+c+","+encodeURIComponent(i),setTimeout(function(){document.body.removeChild(p)},100),!0},widgetPath:function(t){return"../"+t.split("_").join("/")},parseClassID:function(t,e){e=e||"..";var i=t.split(".");return{path:e+"/"+i[0].split("_").join("/"),memberWidgetID:i.length>1?i[1]:null}},requireWidget:function(t){var i=this;return new Promise(function(n,o){var r=i.parseClassID(t);e([r.path],function(t){n(r.memberWidgetID?t.prototype?t.prototype[r.memberWidgetID]:t[r.memberWidgetID]:t)})})},checksum:function(t){switch(t instanceof Array&&(t=t.join("")+t.length),typeof t){case"string":break;default:t=""+t}for(var e=305419896,i=0,n=t.length;n>i;++i)e+=t.charCodeAt(i)*(i+1);return(4294967295&e).toString(16)},getTime:function(){return l&&l.call(c)||(new Date).getTime()},mixin:function(t,e){function i(t,e){var i,n={};for(var o in e)i=e[o],o in t&&(t[o]===i||o in n&&n[o]===i)||(t[o]=i);return t}t=t||{};for(var n=1,o=arguments.length;o>n;n++)i(t,arguments[n]);return t},exists:function(t,e){if(!t||!e)return!1;for(var i=t.split("."),n=e,o=0;o<i.length;++o){var r=i[o];if(void 0===n[r])return!1;n=n[r]}return!0},logStringify:function(t){var e=[];return JSON.stringify(t,function(t,i){if("object"==typeof i&&null!==i){if(-1!==e.indexOf(i))return;e.push(i)}return i})},isArray:s,template:h,parseVersionString:function(t){var e=t.split(".");return{major:parseInt(e[0].replace("v","")),minor:parseInt(e[1]),patch:parseInt(e[2].split("-")[0])}},removeHTMLFromString:a}}),function(t,e){"function"==typeof define&&define.amd?define("common/Database.js",["d3","./Class","./PropertyExt","./Utility"],e):t.common_Database=e(t.d3,t.common_Class,t.common_PropertyExt,t.common_Utility)}(this,function(t,e,i,n){function o(t){e.call(this),i.call(this),this._id=t||this._id}function r(t){t=t||!1,e.call(this),i.call(this),this._dataChecksum=t,this._dataVersion=0,this.clear()}function s(e){this._grid=e,t.rebind(this,this._grid,"checksum","fields")}function a(t,e,i){s.call(this,t),e instanceof Array||(e=[e]),this._columnIndicies=e.filter(function(t){return t}).map(function(t){switch(typeof t){case"string":return this._grid.fieldByLabel(t).idx}return t},this),i=i||function(t){return t},this._rollup=i}function h(t,e){return t instanceof Array||(t=[t]),t.filter(function(t){return""!==t}).every(e)}function c(t){return"boolean"==typeof t}function l(t){return"number"==typeof t||!isNaN(t)}function p(t){return"string"==typeof t}function u(e,i){for(var n=0;n<e.length;++n){var o=t.time.format(e[n]).parse(i);if(o)return _=e[n],e[n]}return null}function d(t){return u(v,t)}function f(t){return u(x,t)}function m(t){return u(b,t)}function y(t){return["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY","AS","DC","FM","GU","MH","MP","PW","PR","VI"].indexOf(String(t).toUpperCase())>=0}o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype.mixin(i),o.prototype._class+=" common_Database.Field",o.prototype.id=function(){return this._id},o.prototype.checksum=function(){return n.checksum(this.label()+this.type()+this.mask()+this.format())},o.prototype.publish("label","","string","Label",null,{optional:!0}),o.prototype.publish("type","","set","Type",["","string","number","boolean","time","hidden"],{optional:!0}),o.prototype.publish("mask","","string","Time Mask",null,{disable:function(t){return"time"!==t.type()},optional:!0}),o.prototype.publish("format","","string","Format",null,{optional:!0}),o.prototype.typeTransformer=function(t){switch(this.type()){case"number":return Number(t);case"string":return String(t);case"boolean":return"string"==typeof t&&["false","off","0"].indexOf(t.toLowerCase())>=0?!1:Boolean(t);case"time":case"date":return this.maskTransformer(t)}return t},o.prototype.maskTransformer=function(t){return this.formatter(this.mask()).parse(String(t))},o.prototype.formatTransformer=function(t){return this.formatter(this.format())(t)},o.prototype.parse=function(t){if(!t)return t;try{return this.typeTransformer(t)}catch(e){return console.log("Unable to parse:  "+t),null}},o.prototype.transform=function(t){if(!t)return t;try{return this.formatTransformer(this.typeTransformer(t))}catch(e){return console.log("Unable to transform:  "+t),null}},o.prototype.clone=function(){function t(t,i){t[i+"_default"](e[i+"_default"]()),e[i+"_exists"]()&&t[i](e[i]())}var e=this,i=new o(this._id);return t(i,"label"),t(i,"type"),t(i,"mask"),t(i,"format"),i},o.prototype.formatter=function(e){var i;if(!e)return i=function(t){return t},i.parse=function(t){return t},i;switch(this.type()){case"time":case"date":return t.time.format(e)}return i=t.format(e),i.parse=function(t){return t},i},r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.mixin(i),r.prototype._class+=" common_Database.Grid",r.prototype.publish("fields",[],"propertyArray","Fields"),r.prototype.clear=function(){return this.fields([]),this._data=[],this._dataChecksums=[],++this._dataVersion,this},r.prototype.resetColumns=function(t){var e=this.fields();this.legacyColumns([]),this.legacyColumns(e.map(function(t){return t.label()}))},r.prototype.legacyColumns=function(t,e){return arguments.length?(this.row(0,t,e),this):this.row(0)},r.prototype.legacyData=function(t,e){return r.prototype.data.apply(this,arguments)},r.prototype.field=function(t){return this.fields()[t]};var g=r.prototype.fields;r.prototype.fields=function(t,e){return arguments.length?g.call(this,e?t.map(function(t){return t.clone()}):t):g.apply(this,arguments)},r.prototype.fieldByLabel=function(t,e){return this.fields().filter(function(i,n){return i.idx=n,e?i.label().toLowerCase()===t.toLowerCase():i.label()===t})[0]},r.prototype.data=function(t,e){return arguments.length?(this._data=e?t.map(function(t){return t.map(function(t){return t})}):t,this._dataCalcChecksum(),this):this._data},r.prototype.parsedData=function(){var t=this;return this._data.map(function(e){return e.map(function(e,i){return t.fields()[i].parse(e)})})},r.prototype.formattedData=function(){var t=this;return this._data.map(function(e){return e.map(function(e,i){return t.fields()[i].transform(e)})})},r.prototype.fieldsChecksum=function(){return n.checksum(this.fields().map(function(t){return t.checksum()}))},r.prototype.dataChecksum=function(){return n.checksum(this._dataChecksum?this._dataChecksums:this._dataVersion)},r.prototype.checksum=function(){return n.checksum([this.dataChecksum(),this.fieldsChecksum()])},r.prototype._dataCalcChecksum=function(t){return++this._dataVersion,this._dataChecksum&&(arguments.length?this._dataChecksums[t]=n.checksum(this._data[t]):this._dataChecksums=this._data.map(function(t){return n.checksum(t)})),this},r.prototype.row=function(t,e,i){if(arguments.length<2)return 0===t?this.fields().map(function(t){return t.label()}):this._data[t-1];if(0===t){var n=this.fields();this.fields(e.map(function(t,e){return i?(n[e]||new o).label_default(t):(n[e]||new o).label(t)},this))}else this._data[t-1]=e,this._dataCalcChecksum(t-1);return this},r.prototype.rows=function(t){return arguments.length?(this.row(0,t[0]),this._data=t.filter(function(t,e){return e>0}),this._dataCalcChecksum(),this):[this.row(0)].concat(this._data)},r.prototype.column=function(t,e){return arguments.length<2?[this.fields()[t].label()].concat(this._data.map(function(e,i){return e[t]})):(e.forEach(function(i,n){0===n?this.fields()[t]=(new o).label(e[0]):(this._data[n-1][t]=i,this._dataCalcChecksum(n-1))},this),this)},r.prototype.columnData=function(t,e){return arguments.length<2?this._data.map(function(e,i){return e[t]}):(e.forEach(function(e,i){this._data[i][t]=e,this._dataCalcChecksum(i)},this),this)},r.prototype.columns=function(t){return arguments.length?(t.forEach(function(e,i){this.column(i,t[i])},this),this):this.fields().map(function(t,e){return this.column(e)},this)},r.prototype.cell=function(t,e,i){return arguments.length<3?this.row(t)[e]:(0===t?this.fields()[e]=(new o).label(i):(this._data[t][e]=i,this._dataCalcChecksum(t)),this)},r.prototype.grid=function(t){return r.prototype.rows.apply(this,arguments)},r.prototype.hipieMappings=function(e,i){if(i=i||"",!this.fields().length||!this._data.length)return[];var n=[],o=!1;if(e.forEach(function(t,e){var i={groupby:!1,func:"",params:[]};if(t.hasFunction())i.func=t["function"](),"SCALE"===i.func?i.groupby=!0:o=!0,t.params().forEach(function(t){var e=this.fieldByLabel(t,!0);i.params.push(e?e.idx:-1)},this);else{i.groupby=!0;var r=this.fieldByLabel(t.id(),!0);i.params.push(r?r.idx:-1)}n.push(i)},this),o){var r=[];return this.rollup(n.filter(function(t){return t.groupby===!0}).map(function(t){return t.params[0]}),function(e){var i=n.map(function(i){var n=i.params[0],o=i.params[1];switch(i.func){case"SUM":return t.sum(e,function(t){return t[n]});case"AVE":return t.mean(e,function(t){return t[n]/t[o]});case"MIN":return t.min(e,function(t){return t[n]});case"MAX":return t.max(e,function(t){return t[n]});case"SCALE":return console.log("Unexpected function:  "+i.func),t.mean(e,function(t){return t[n]/+o})}return e[0][n]});return r.push(i),i}),r}return this._data.map(function(t){return n.map(function(e){var i=e.params[0],n=e.params[1];switch(e.func){case"SCALE":return t[i]/+n;case"SUM":case"AVE":case"MIN":case"MAX":console.log("Unexpected function:  "+e.func)}return t[i]})})},s.prototype.constructor=s,s.prototype.grid=function(){return this._grid},s.prototype.columns=function(t){return arguments.length?(this._grid.legacyColumns(t),this):this._grid.legacyColumns()},s.prototype.rawData=function(t){return arguments.length?(this._grid.legacyData(t),this):this._grid.legacyData()},s.prototype.formattedData=function(){return this._formattedDataChecksum!==this._grid.checksum()&&(this._formattedDataChecksum=this._grid.checksum(),this._formattedData=this._grid.formattedData()),this._formattedData},s.prototype.parsedData=function(){return this._parsedDataChecksum!==this._grid.checksum()&&(this._parsedDataChecksum=this._grid.checksum(),this._parsedData=this._grid.parsedData()),this._parsedData},s.prototype._whichData=function(t){if(t){if(t.parsed)return this.formattedData();if(t.formatted)return this.formattedData()}return this.rawData()},s.prototype.data=function(t){return s.prototype.rawData.apply(this,arguments)},a.prototype=Object.create(s.prototype),a.prototype.constructor=a,a.prototype.nest=function(){if(this._nestChecksum!==this._grid.checksum()){this._nestChecksum=this._grid.checksum();var e=t.nest();this._columnIndicies.forEach(function(t){e.key(function(e){return e[t]})}),this._nest=e.rollup(this._rollup)}return this._nest},a.prototype.entries=function(t){return this.nest().entries(this._whichData(t))},a.prototype.map=function(t){return this.nest().map(this._whichData(t))},a.prototype.d3Map=function(e){return this.nest().map(this._whichData(e),t.map)},a.prototype._walkData=function(t,e){e=e||[];var i=[];return t.forEach(function(t){t instanceof Array?i.push(e.concat([t])):i=i.concat(this._walkData(t.values,e.concat([t.key])))},this),i},a.prototype.data=function(t){return this._walkData(this.entries(t))},r.prototype.legacyView=function(){return new s(this)},r.prototype.nestView=function(t){return new a(this,t)},r.prototype.rollupView=function(t,e){return new a(this,t,e)},r.prototype.aggregateView=function(e,i,n,o){var r=this;return new a(this,e,function(e){switch(i){case null:case void 0:case"":return e.aggregate=e.length,e;default:var s=r.legacyColumns(),a=s.indexOf(n),h=s.indexOf(o);return e.aggregate=t[i](e,function(t){return(+t[a]-(h>=0?+t[h]:0))/(h>=0?+t[h]:1)}),e}})},r.prototype._nest=function(e,i){e instanceof Array||(e=[e]);var n=t.nest();return e.forEach(function(t){n.key(function(e){return e[t]})}),n},r.prototype.nest=function(t){return this._nest(t).entries(this._data)},r.prototype.rollup=function(t,e){return this._nest(t).rollup(e).entries(this._data)},r.prototype.length=function(){return this._data.length+1},r.prototype.width=function(){return this.fields().length},r.prototype.pivot=function(){return this.resetColumns(),this.rows(this.columns()),this},r.prototype.clone=function(t){return(new r).fields(this.fields(),t).data(this.data(),t)},r.prototype.filter=function(t){var e={};return this.row(0).forEach(function(t,i){e[t]=i}),(new r).fields(this.fields(),!0).data(this.data().filter(function(i){for(var n in t)if(t[n]!==i[e[n]])return!1;return!0}))};var _=null;r.prototype.analyse=function(t){t instanceof Array||(t=[t]);var e=[];return t.forEach(function(t){var i=this.rollup(t,function(t){return t.length});e.push(i);var n=i.map(function(t){return t.key});this.fields()[t].isBoolean=h(n,c),this.fields()[t].isNumber=h(n,l),this.fields()[t].isString=!this.fields()[t].isNumber&&h(n,p),this.fields()[t].isUSState=this.fields()[t].isString&&h(n,y),this.fields()[t].isDateTime=this.fields()[t].isString&&h(n,d),this.fields()[t].isDateTimeFormat=_,this.fields()[t].isDate=!this.fields()[t].isDateTime&&h(n,f),this.fields()[t].isDateFormat=_,this.fields()[t].isTime=this.fields()[t].isString&&!this.fields()[t].isDateTime&&!this.fields()[t].isDate&&h(n,m),this.fields()[t].isTimeFormat=_},this),e},r.prototype.jsonObj=function(t){return arguments.length?(this.clear(),this.data(t.map(function(t,e){var i=[];for(var n in t){var r=this.row(0).indexOf(n);0>r&&(r=this.fields().length,this.fields().push((new o).label(n))),i[r]=t[n]}return i},this)),this):this._data.map(function(t){var e={};return this.row(0).forEach(function(i,n){e[i]=t[n]}),e},this)},r.prototype.json=function(t){return arguments.length?(this.jsonObj(JSON.parse(t)),this):JSON.stringify(this.jsonObj(),null,"  ")},r.prototype.csv=function(e){if(!arguments.length){var i=document.createElement("div");return t.csv.formatRows(this.grid().map(function(t){return t.map(function(t){return n.removeHTMLFromString(t,i)})}))}return this.jsonObj(t.csv.parse(e)),this},r.prototype.tsv=function(e){return arguments.length?(this.jsonObj(t.tsv.parse(e)),this):t.tsv.formatRows(this.grid())};var v=[],x=["%Y-%m-%d","%Y%m%d"],b=["%H:%M:%S.%LZ","%H:%M:%SZ","%H:%M:%S"];return x.forEach(function(t){b.forEach(function(e){
v.push(t+"T"+e)})}),{Field:o,Grid:r}}),function(t,e){"function"==typeof define&&define.amd?define("common/Widget.js",["d3","./Class","./Platform","./PropertyExt","./Database"],e):t.common_Widget=e(t.d3,t.common_Class,t.common_Platform,t.common_PropertyExt,t.common_Database)}(this,function(t,e,i,n,o){function r(){e.call(this),i.call(this),n.call(this),this._class=Object.getPrototypeOf(this)._class,this._id=this._idSeed+s++,this._db=new o.Grid,this._pos={x:0,y:0},this._size={width:0,height:0},this._scale=1,this._visible=!0,this._target=null,this._parentElement=null,this._parentWidget=null,this._element=t.select(),this._renderCount=0,window.__hpcc_debug&&(void 0===window.g_all&&(window.g_all={}),window.g_all[this._id]=this),window.__hpcc_theme&&this.applyTheme(window.__hpcc_theme)}var s=0;return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.mixin(i),r.prototype.mixin(n),r.prototype._class+=" common_Widget",r.prototype._idSeed="_w",r.prototype.publishProxy("fields","_db","fields"),r.prototype.publish("classed",{},"object","HTML Classes",null,{tags:["Private"]}),r.prototype["export"]=function(t){switch(t){case"TSV":return this._db.tsv();case"JSON":return this._db.json()}return this._db.csv()},r.prototype.leakCheck=function(t){for(var e=this,i=[t],n=new this.MutationObserver(function(t){var o=!1;t.forEach(function(t){for(var r=0;r<t.removedNodes.length;++r){var s=t.removedNodes.item(r);i.indexOf(s)>=0&&e._target&&(o=!0,n.disconnect())}}),o&&console.log("leak:  "+e.id()+" - "+e.classID()+"		widget.target(null); was not called for this widget before it was removed from the page.")}),o=t.parentNode;o;)n.observe(o,{childList:!0}),i.push(o),o=o.parentNode},r.prototype.on=function(e,i,n){var o=this;return this.overrideMethod(e,function(e,r){var s;return n?t.event&&t.event.stopPropagation():s=e.apply(o,r),i.apply(o,r)||s}),this},r.prototype.id=function(t){return arguments.length?(this._id=t,this):this._id},r.prototype.columns=function(t,e){return arguments.length?(this._db.legacyColumns(t,e),this):this._db.legacyColumns()},r.prototype.parsedData=function(){return this._db.parsedData()},r.prototype.formattedData=function(){return this._db.formattedData()},r.prototype.data=function(t){return arguments.length?(this._db.legacyData(t),this):this._db.legacyData()},r.prototype.cloneData=function(){return this.data().map(function(t){return t.slice(0)})},r.prototype.flattenData=function(){var t=[];return this.data().forEach(function(e,i){this.columns().filter(function(t,e){return e>0}).forEach(function(n,o){var r=e[o+1];if(r){var s={rowIdx:i,colIdx:o+1,label:e[0],value:r};t.push(s)}},this)},this),t},r.prototype.rowToObj=function(t){var e={};return this.fields().forEach(function(i,n){e[i.label_default()||i.label()]=t[n]}),t.length===this.columns().length+1&&(e.__lparam=t[this.columns().length]),e},r.prototype.pos=function(t){return arguments.length?(this._pos=t,this._overlayElement&&this._overlayElement.attr("transform","translate("+t.x+","+t.y+")scale("+this._scale+")"),this):this._pos},r.prototype.x=function(t){return arguments.length?(this.pos({x:t,y:this._pos.y}),this):this._pos.x},r.prototype.y=function(t){return arguments.length?(this.pos({x:this._pos.x,y:t}),this):this._pos.y},r.prototype.size=function(t){return arguments.length?(this._size=t,this._overlayElement&&this._overlayElement.attr("width",t.width).attr("height",t.height),this):this._size},r.prototype.width=function(t){return arguments.length?(this.size({width:t,height:this._size.height}),this):this._size.width},r.prototype.height=function(t){return arguments.length?(this.size({width:this._size.width,height:t}),this):this._size.height},r.prototype.resize=function(t,e){e=e||{width:0,height:0};var i,n;if(t&&t.width&&t.height)i=t.width,n=t.height;else{var o=window.getComputedStyle(this._target,null);i=parseFloat(o.getPropertyValue("width"))-e.width,n=parseFloat(o.getPropertyValue("height"))-e.height}return this.size({width:i,height:n}),this},r.prototype.scale=function(t){return arguments.length?(this._scale=t,this._overlayElement&&this._overlayElement.attr("transform","translate("+t.x+","+t.y+")scale("+this._scale+")"),this):this._scale},r.prototype.visible=function(t){return arguments.length?(this._visible=t,this._parentElement&&this._parentElement.style({visibility:this._visible?null:"hidden",opacity:this._visible?null:0}),this):this._visible},r.prototype.display=function(t){return arguments.length?(this._display=t,this._element&&this._element.style("display",this._display?null:"none"),this):this._display},r.prototype.calcSnap=function(t){function e(t,e){function i(t,e){var i=t%e;return Math.abs(i)>e-Math.abs(i)&&(i=(e-Math.abs(i))*(0>i?1:-1)),i}return t-i(t,e)}var i=e(this._pos.x-this._size.width/2,t),n=e(this._pos.y-this._size.height/2,t),o=e(this._pos.x+this._size.width/2,t),r=e(this._pos.y+this._size.height/2,t),s=o-i,a=r-n;return[{x:i+s/2,y:n+a/2},{width:s,height:a}]},r.prototype.toWidget=function(e){if(!e)return null;var i=t.select(e);if(i){var n=i.datum();if(n&&n instanceof r)return n}return null},r.prototype.locateParentWidget=function(t){if(t=t||(this._target?this._target.parentNode:null)){var e=this.toWidget(t);if(e)return e;if(t.parentNode)return this.locateParentWidget(t.parentNode)}return null},r.prototype.locateSVGNode=function(t){return t?"svg"===t.tagName?t:this.locateSVGNode(t.parentNode):null},r.prototype.locateOverlayNode=function(){for(var t=this.locateParentWidget(this._target);t;){if(t._parentOverlay)return t._parentOverlay;t=this.locateParentWidget(t._target.parentNode)}return null},r.prototype.locateAncestor=function(t){for(var e=this.locateParentWidget(this._target);e;){if(e.classID()===t)return e;e=this.locateParentWidget(e._target.parentNode)}return null},r.prototype.getAbsolutePos=function(t,e,i){var n=this.locateSVGNode(t);if(!n)return null;var o=n.createSVGPoint(),r=t.getCTM();o=o.matrixTransform(r);var s={x:o.x,y:o.y};if(void 0!==e&&void 0!==i){var a=n.createSVGPoint();a.x=e,a.y=i,a=a.matrixTransform(r),s.width=a.x-o.x,s.height=a.y-o.y}return s},r.prototype.hasOverlay=function(){return this._overlayElement},r.prototype.syncOverlay=function(){if(this._size.width&&this._size.height){var t=this.getAbsolutePos(this._overlayElement.node(),this._size.width,this._size.height);if(t&&(null===this.oldPos||void 0===this.oldPos||t.x!==this.oldPos.x||t.y!==this.oldPos.y||t.width!==this.oldPos.width||t.height!==this.oldPos.height)){var e=t.width/this._size.width,i=t.height/this._size.height;this._parentElement.style({left:t.x-t.width/e/2+"px",top:t.y-t.height/i/2+"px",width:t.width/e+"px",height:t.height/i+"px"});var n="scale("+e+","+i+")";this._parentElement.style("transform",n).style("-moz-transform",n).style("-ms-transform",n).style("-webkit-transform",n).style("-o-transform",n)}this.oldPos=t}},r.prototype.element=function(){return this._element},r.prototype.node=function(){return this._element.node()},r.prototype.render=function(e){if(window.__hpcc_debug){var i=Date.now();i-this._prevNow<500&&console.log("Double Render:  "+(i-this._prevNow)+" - "+this.id()+" - "+this.classID()),this._prevNow=i}if(e=e||function(){},!this._parentElement||!this.visible())return e(this),this;if(this._parentElement){if(!this._tag)throw"No DOM tag specified";var n=this._parentElement.selectAll("#"+this._id).data([this],function(t){return t._id});n.enter().append(this._tag).classed(this._class,!0).attr("id",this._id).each(function(e){e._element=t.select(this),e.enter(this,e._element),window.__hpcc_debug&&e.leakCheck(this)}),n.classed(this.classed()).each(function(t){t.preUpdate(this,t._element),t.update(this,t._element),t.postUpdate(this,t._element)}),n.exit().each(function(e){t.select(this).datum(null),e.exit(this,e._element)}).remove(),this._renderCount++}var o=[];this.publishedProperties(!0).forEach(function(t){if(!t.ext||t.ext.render!==!1)switch(t.type){case"widget":var e=this[t.id]();e&&o.push(this[t.id]());break;case"widgetArray":o=o.concat(this[t.id]())}},this);var r=this;switch(o.length){case 0:e(this);break;case 1:o[0].render(function(){e(r)});break;default:var s=o.length;o.forEach(function(t,i){setTimeout(function(){t.render(function(){0===--s&&e(r)})},0)})}return this},r.prototype.lazyRender=r.prototype.debounce(function(){this.render()},100),r.prototype.enter=function(t,e){},r.prototype.preUpdate=function(t,e){},r.prototype.update=function(t,e){},r.prototype.postUpdate=function(t,e){},r.prototype.exit=function(t,e){},r}),function(t,e){"function"==typeof define&&define.amd?define("common/Transition.js",[],e):t.common_Transition=e()}(this,function(){function t(t){this._widget=t,this._duration=250,this._delay=0,this._ease="cubic-in-out"}return t.prototype.duration=function(t){return arguments.length?(this._duration=t,this._widget):this._duration},t.prototype.delay=function(t){return arguments.length?(this._delay=t,this._widget):this._delay},t.prototype.ease=function(t){return arguments.length?(this._ease=t,this._widget):this._ease},t.prototype.apply=function(t){return this._duration||this._delay?t.transition().duration(this._duration).delay(this._delay).ease(this._ease):t},t}),function(t,e){"function"==typeof define&&define.amd?define("common/HTMLWidget.js",["d3","./Widget","./Transition"],e):t.common_HTMLWidget=e(t.d3,t.common_Widget,t.common_Transition)}(this,function(t,e,i){function n(){e.call(this),this._drawStartPos="origin",this._tag="div",this._boundingBox=null}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype._class+=" common_HTMLWidget",n.prototype.calcFrameWidth=function(t){var e=parseFloat(t.style("padding-left"))+parseFloat(t.style("padding-right"))+parseFloat(t.style("margin-left"))+parseFloat(t.style("margin-right"))+parseFloat(t.style("border-left-width"))+parseFloat(t.style("border-right-width"));return e},n.prototype.calcWidth=function(t){return parseFloat(t.style("width"))-this.calcFrameWidth(t)},n.prototype.calcFrameHeight=function(t){var e=parseFloat(t.style("padding-top"))+parseFloat(t.style("padding-bottom"))+parseFloat(t.style("margin-top"))+parseFloat(t.style("margin-bottom"))+parseFloat(t.style("border-top-width"))+parseFloat(t.style("border-bottom-width"));return e},n.prototype.calcHeight=function(t){return parseFloat(t.style("height"))+this.calcFrameHeight(t)},n.prototype.hasHScroll=function(t){return t=t||this._element,t.property("scrollWidth")>t.property("clientWidth")},n.prototype.hasVScroll=function(t){return t=t||this._element,t.property("scrollHeight")>t.property("clientHeight")},n.prototype.clientWidth=function(){return this._size.width-this.calcFrameWidth(this._element)},n.prototype.clientHeight=function(){return this._size.height-this.calcFrameHeight(this._element)},n.prototype.getBBox=function(t,e){if(t||null===this._boundingBox){var i=this._element.node()?this._element.node().firstElementChild:null;if(i instanceof Element){var n=i.getBoundingClientRect();this._boundingBox={x:n.left,y:n.top,width:n.width,height:n.height}}}return null===this._boundingBox?{x:0,y:0,width:0,height:0}:{x:(e?Math.round(this._boundingBox.x):this._boundingBox.x)*this._scale,y:(e?Math.round(this._boundingBox.y):this._boundingBox.y)*this._scale,width:(e?Math.round(this._boundingBox.width):this._boundingBox.width)*this._scale,height:(e?Math.round(this._boundingBox.height):this._boundingBox.height)*this._scale}},n.prototype.resize=function(t){var i=e.prototype.resize.apply(this,arguments);return this._parentElement.style("width",this._size.width+"px").style("height",this._size.height+"px"),i},n.prototype.target=function(e){if(!arguments.length)return this._target;if(this._target&&e)throw"Target can only be assigned once.";if(this._target=e,("string"==typeof this._target||this._target instanceof String)&&(this._target=document.getElementById(this._target)),this._target instanceof SVGElement){var i=this.locateOverlayNode();this._parentElement=i.append("div").style({position:"absolute",top:0,left:0,overflow:"hidden"}),this._overlayElement=t.select(this._target);var n=this;this.oldPos=null,this.observer=new this.MutationObserver(function(t){n.syncOverlay()});for(var o=this._overlayElement.node();o;)this.observer.observe(o,{attributes:!0}),o=o.parentNode}else if(this._target){if(this._parentElement=t.select(this._target),!this._size.width&&!this._size.height){var r=parseFloat(this._parentElement.style("width")),s=parseFloat(this._parentElement.style("height"));this.size({width:r,height:s})}this._parentElement=t.select(this._target).append("div")}else this.exit();return this},n.prototype.postUpdate=function(t,i){if(e.prototype.postUpdate.apply(this,arguments),"origin"===this._drawStartPos)this._element.style({position:"relative",left:this._pos.x+"px",top:this._pos.y+"px"});else{var n=this.getBBox(!0);this._element.style({position:"relative","float":"left",left:this._pos.x+(this._size.width-n.width)/2+"px",top:this._pos.y+(this._size.height-n.height)/2+"px"})}},n.prototype.exit=function(t,i){this.observer&&this.observer.disconnect(),this.oldPos=null,this._parentElement&&this._parentElement.remove(),e.prototype.exit.apply(this,arguments)},n}),function(t,e){"function"==typeof define&&define.amd?define("common/CanvasWidget.js",["d3","./HTMLWidget"],e):t.common_CanvasWidget=e(t.d3,t.common_HTMLWidget)}(this,function(t,e){function i(){e.call(this),this._tag="canvas"}return i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype._class+=" common_CanvasWidget",i.prototype.resize=function(t){var i=e.prototype.resize.apply(this,arguments);return this._element.attr("width",this._size.width),this._element.attr("height",this._size.height),i},i.prototype.click=function(t,e){console.log(t)},i}),function(t,e){"function"==typeof define&&define.amd?define("common/SVGWidget.js",["d3","./Widget","./Transition"],e):t.common_SVGWidget=e(t.d3,t.common_Widget,t.common_Transition)}(this,function(t,e,i){function n(){e.call(this),this._tag="g",this._boundingBox=null,this.transition=new i(this),this._drawStartPos="center"}n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype._class+=" common_SVGWidget",n.prototype.move=function(t,e){var i=this.pos.apply(this,arguments);return arguments.length&&(e?this._element.transition().duration(e):this._element).attr("transform","translate("+t.x+" "+t.y+")"),i},n.prototype.size=function(t){var i=e.prototype.size.apply(this,arguments);return arguments.length&&(this._boundingBox=null),i},n.prototype.resize=function(t){var i=e.prototype.resize.apply(this,arguments);if(this._parentRelativeDiv)switch(this._parentRelativeDiv.style({width:this._size.width+"px",height:this._size.height+"px"}),this._drawStartPos){case"origin":this.pos({x:0,y:0});break;case"center":default:this.pos({x:this._size.width/2,y:this._size.height/2})}return this._parentElement.attr("width",this._size.width).attr("height",this._size.height),i},n.prototype.target=function(e){if(!arguments.length)return this._target;if(this._target&&e&&this._target.__data__.id!==e.__data__.id)throw"Target can only be assigned once.";return this._target=e,("string"==typeof this._target||this._target instanceof String)&&(this._target=document.getElementById(this._target)),this._target instanceof SVGElement?(this._parentElement=t.select(this._target),this._parentWidget=this._parentElement.datum(),this._parentWidget&&this._parentWidget._id!==this._id||(this._parentWidget=this.locateParentWidget(this._target.parentNode)),this._parentOverlay=this.locateOverlayNode()):this._target?(this._parentRelativeDiv=t.select(this._target).append("div").style({position:"relative"}),this._parentElement=this._parentRelativeDiv.append("svg").style({position:"absolute",top:0,left:0}),this._parentOverlay=this._parentRelativeDiv.append("div").style({position:"absolute",top:0,left:0}),this.resize(this._size)):this.exit(),this},n.prototype.enter=function(t,i){e.prototype.enter.apply(this,arguments)},n.prototype.update=function(t,i){e.prototype.update.apply(this,arguments)},n.prototype.postUpdate=function(t,i){e.prototype.postUpdate.apply(this,arguments),"origin"===this._drawStartPos&&this._target instanceof SVGElement?this._element.attr("transform","translate("+(this._pos.x-this._size.width/2)+","+(this._pos.y-this._size.height/2)+")scale("+this._scale+")"):this._element.attr("transform","translate("+this._pos.x+","+this._pos.y+")scale("+this._scale+")")},n.prototype.exit=function(t,i){this._parentRelativeDiv&&(this._parentOverlay.remove(),this._parentElement.remove(),this._parentRelativeDiv.remove()),e.prototype.exit.apply(this,arguments)},n.prototype.getOffsetPos=function(){var t={x:0,y:0};return this._parentWidget?(t=this._parentWidget.getOffsetPos(),t.x+=this._pos.x,t.y+=this._pos.y,t):t},n.prototype.getBBox=function(t,e){if(t||null===this._boundingBox){var i=this._element.node();i instanceof SVGElement&&(this._boundingBox=i.getBBox())}return null===this._boundingBox?{x:0,y:0,width:0,height:0}:{x:(e?Math.round(this._boundingBox.x):this._boundingBox.x)*this._scale,y:(e?Math.round(this._boundingBox.y):this._boundingBox.y)*this._scale,width:(e?Math.round(this._boundingBox.width):this._boundingBox.width)*this._scale,height:(e?Math.round(this._boundingBox.height):this._boundingBox.height)*this._scale}},n.prototype.intersection=function(t,e){return this.intersectRect(t,e)};var o=function(t,e,i){return{x:t.x+(e.x-t.x)*i,y:t.y+(e.y-t.y)*i}},r=function(t,e,i,n){var o={type:"",points:[]},r=(n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x),s=(e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x),a=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y);if(0!==a){var h=r/a,c=s/a;h>=0&&1>=h&&c>=0&&1>=c?(o.type="Intersection",o.points.push({x:t.x+h*(e.x-t.x),y:t.y+h*(e.y-t.y)})):o.type="No Intersection"}else 0===r||0===s?o.type="Coincident":o.type="Parallel";return o};n.prototype.intersectRect=function(t,e){var i=this.getOffsetPos(),n=this.getBBox();if(t.x===e.x&&t.y===e.y)return t;var o={x:i.x-n.width/2,y:i.y-n.height/2},s={x:i.x+n.width/2,y:i.y-n.height/2},a={x:i.x+n.width/2,y:i.y+n.height/2},h={x:i.x-n.width/2,y:i.y+n.height/2},c=r(o,s,t,e);return c.points.length?{x:c.points[0].x,y:c.points[0].y}:(c=r(s,a,t,e),c.points.length?{x:c.points[0].x,y:c.points[0].y}:(c=r(a,h,t,e),c.points.length?{x:c.points[0].x,y:c.points[0].y}:(c=r(h,o,t,e),c.points.length?{x:c.points[0].x,y:c.points[0].y}:null)))};var s=function(t,e,i,n){var r={type:"",points:[]},s=(n.x-i.x)*(n.x-i.x)+(n.y-i.y)*(n.y-i.y),a=2*((n.x-i.x)*(i.x-t.x)+(n.y-i.y)*(i.y-t.y)),h=t.x*t.x+t.y*t.y+i.x*i.x+i.y*i.y-2*(t.x*i.x+t.y*i.y)-e*e,c=a*a-4*s*h;if(0>c)r.type="Outside";else if(0===c)r.type="Tangent";else{var l=Math.sqrt(c),p=(-a+l)/(2*s),u=(-a-l)/(2*s);(0>p||p>1)&&(0>u||u>1)?0>p&&0>u||p>1&&u>1?r.type="Outside":r.type="Inside":(r.type="Intersection",p>=0&&1>=p&&r.points.push(o(i,n,p)),u>=0&&1>=u&&r.points.push(o(i,n,u)))}return r};return n.prototype.intersectCircle=function(t,e){var i=this.getOffsetPos(),n=this.radius(),o=s(i,n,t,e);return o.points.length?{x:o.points[0].x,y:o.points[0].y}:null},n.prototype.distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},n.prototype._pushMarkers=function(t,e){this.svgMarkerGlitch&&(t=t||this._element,t.selectAll("path[marker-start],path[marker-end]").attr("fixme-start",function(t){return this.getAttribute("marker-start")}).attr("fixme-end",function(t){return this.getAttribute("marker-end")}).attr("marker-start",null).attr("marker-end",null))},n.prototype._popMarkers=function(t,e){this.svgMarkerGlitch&&(t=t||this._element,t.selectAll("path[fixme-start],path[fixme-end]").attr("marker-start",function(t){return this.getAttribute("fixme-start")}).attr("marker-end",function(t){return this.getAttribute("fixme-end")}).attr("fixme-start",null).attr("fixme-end",null))},n.prototype._popMarkersDebounced=e.prototype.debounce(function(t,e){this.svgMarkerGlitch&&this._popMarkers(t,e)},250),n.prototype._fixIEMarkers=function(t,e){this.svgMarkerGlitch&&(this._pushMarkers(t,e),this._popMarkersDebounced(t,e))},n}),"function"==typeof define&&define.amd&&define("css",[],function(){return{load:function(t,e,i){i()}}}),function(t,e){"function"==typeof define&&define.amd?define("common/Text.js",["./SVGWidget","css!./Text"],e):t.common_Text=e(t.common_SVGWidget)}(this,function(t){function e(){t.call(this)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype._class+=" common_Text",e.prototype.publish("text","","string","Display Text",null,{tags:["Basic"]}),e.prototype.publish("fontFamily",null,"string","Font Family",null,{tags:["Intermediate"],optional:!0}),e.prototype.publish("fontSize",null,"number","Font Size (px)",null,{tags:["Intermediate"]}),e.prototype.publish("anchor","middle","set","Anchor Position",["start","middle","end"],{tags:["Intermediate"]}),e.prototype.publish("colorFill",null,"html-color","Fill Color",null,{tags:["Basic"]}),e.prototype.publish("rotation",0,"number","Degrees of rotation",null,{tags:["Basic"]}),e.prototype.enter=function(e,i){t.prototype.enter.apply(this,arguments),this._textElement=i.append("text")},e.prototype.update=function(e,i){t.prototype.update.apply(this,arguments);var n=this;this._textElement.attr("font-family",this.fontFamily()).attr("font-size",this.fontSize());var o=this.text().split("\n"),r=this._textElement.selectAll("tspan").data(o);r.enter().append("tspan").attr("class",function(t,e){return"tspan_"+e}).attr("dy","1em").attr("x","0"),r.style("fill",this.colorFill()).text(function(t){return t}),r.exit().remove();var s={width:0,height:0};try{s=this._textElement.node().getBBox()}catch(a){}var h=-(s.x+s.width/2),c=-(s.y+s.height/2);switch(this.anchor()){case"start":h=-s.x+s.width/2;break;case"end":h=s.x+s.width/2}var l=-this.rotation()*Math.PI/180;h=-1*Math.abs(h*Math.cos(l)+c*Math.sin(l)),c=-1*Math.abs(h*Math.sin(l)+c*Math.cos(l)),this._textElement.style("text-anchor",this.anchor()).attr("transform",function(t){return"translate("+h+","+c+")rotate("+n.rotation()+")"})},e}),function(t,e){"function"==typeof define&&define.amd?define("common/FAChar",["./SVGWidget","./Text","css!font-awesome","css!./FAChar"],e):t.common_FAChar=e(t.common_SVGWidget,t.common_Text)}(this,function(t,e){function i(){t.call(this),this._text=(new e).fontFamily("FontAwesome")}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" common_FAChar",i.prototype.publish("char","","string","Font Awesome Item",null,{tags:["Private"]}),i.prototype.publish("fontSize",null,"number","Font Size",null,{tags:["Private"]}),i.prototype.publishProxy("text_colorFill","_text","colorFill"),i.prototype.enter=function(e,i){t.prototype.enter.apply(this,arguments),this._text.target(e)},i.prototype.update=function(e,i){t.prototype.update.apply(this,arguments),this._text.text(this["char"]()).scale((this.fontSize()||14)/14).render()},i.prototype.exit=function(e,i){this._text.target(null),t.prototype.exit.apply(this,arguments)},i}),function(t,e){"function"==typeof define&&define.amd?define("common/Shape.js",["d3","./SVGWidget","css!./Shape"],e):t.common_Shape=e(t.d3,t.common_SVGWidget)}(this,function(t,e){function i(){e.call(this)}return i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype._class+=" common_Shape",i.prototype.publish("shape","circle","set","Shape Type",["circle","square","rect","ellipse"],{tags:["Private"]}),i.prototype.publish("width",24,"number","Width",null,{tags:["Private"]}),i.prototype.publish("height",24,"number","Height",null,{tags:["Private"]}),i.prototype.publish("colorStroke",null,"html-color","Stroke Color",null,{tags:["Private"]}),i.prototype.publish("colorFill",null,"html-color","Fill Color",null,{tags:["Private"]}),i.prototype.publish("radius",null,"number","Radius",null,{tags:["Private"]}),i.prototype.publish("tooltip","","string","Tooltip",null,{tags:["Private"]}),i.prototype._origRadius=i.prototype.radius,i.prototype.radius=function(t){var e=i.prototype._origRadius.apply(this,arguments);return arguments.length?(this.width(t),this.height(t),e):Math.max(this.width(),this.height())/2},i.prototype.intersection=function(t,i){switch(this.shape()){case"circle":return this.intersectCircle(t,i)}return e.prototype.intersection.apply(this,arguments)},i.prototype.update=function(e,i){var n=i.selectAll("rect,circle,ellipse").data([this.shape()],function(t){return t}),o=this;n.enter().append("square"===this.shape()?"rect":this.shape()).attr("class","common_Shape").each(function(e){var i=t.select(this);o._tooltipElement=i.append("title")}),n.style("fill",this.colorFill()).style("stroke",this.colorStroke()).each(function(e){var i=t.select(this);switch(o._tooltipElement.text(o.tooltip()),o.shape()){case"circle":var n=o.radius();i.attr("r",n);break;case"square":var r=Math.max(o.width(),o.height());i.attr("x",-r/2).attr("y",-r/2).attr("width",r).attr("height",r);break;case"rect":i.attr("x",-o.width()/2).attr("y",-o.height()/2).attr("width",o.width()).attr("height",o.height());break;case"ellipse":i.attr("rx",o.width()/2).attr("ry",o.height()/2)}}),n.exit().remove()},i}),function(t,e){"function"==typeof define&&define.amd?define("common/Icon",["./SVGWidget","./Shape","./FAChar","css!./Icon"],e):t.common_Icon=e(t.common_SVGWidget,t.common_Shape,t.common_FAChar)}(this,function(t,e,i){function n(){t.call(this),this._shapeWidget=new e,this._faChar=new i}return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype._class+=" common_Icon",n.prototype.publish("shape","circle","set","Shape Type",["circle","square"],{tags:["Private"]}),n.prototype.publishProxy("faChar","_faChar","char"),n.prototype.publish("imageUrl",null,"string","Image URL",null,{optional:!0}),n.prototype.publishProxy("image_colorFill","_faChar","text_colorFill"),n.prototype.publish("tooltip","","string","Tooltip",null,{tags:["Private"]}),n.prototype.publish("diameter",24,"number","Diameter",null,{tags:["Private"]}),n.prototype.publish("paddingPercent",45,"number","Padding Percent",null,{tags:["Private"]}),n.prototype.publishProxy("shape_colorFill","_shapeWidget","colorFill"),n.prototype.publishProxy("shape_colorStroke","_shapeWidget","colorStroke"),n.prototype.intersection=function(t,e){return this._shapeWidget.intersection(t,e)},n.prototype.enter=function(e,i){t.prototype.enter.apply(this,arguments),this._defs=i.append("defs"),this._defs.append("clipPath").attr("id","clip_"+this.id()+"_circle").append("circle").attr("x",0).attr("y",0),this._defs.append("clipPath").attr("id","clip_"+this.id()+"_square").append("rect"),this._root=i.append("g"),this._shapeWidget.target(this._root.node()).render(),this._faChar.target(i.node()).render(),this._tooltipElement=i.append("title");var n=this;i.on("click",function(t){n.click(t)}).on("dblclick",function(t){n.dblclick(t)})},n.prototype.click=function(t){console.log("Clicked the icon")},n.prototype.dblclick=function(t){console.log("Double clicked the icon")},n.prototype.update=function(e,i){t.prototype.update.apply(this,arguments);var n=this.diameter(),o=n/2;this._defs.select("circle").attr("r",o),this._defs.select("rect").attr("x",-o).attr("y",-o).attr("width",n).attr("height",n),this._faChar.fontSize(n*(100-this.paddingPercent())/100).render(),this._shapeWidget.shape(this.shape()).width(n).height(n).render();var r=this._root.selectAll("image").data(this.imageUrl()?[this.imageUrl()]:[],function(t){return t});r.enter().append("image").attr("xlink:href",this.imageUrl()),r.attr("clip-path","url(#clip_"+this.id()+"_"+this.shape()+")").attr("x",-o).attr("y",-o).attr("width",n).attr("height",n),r.exit().remove(),this._tooltipElement.text(this.tooltip())},n.prototype.exit=function(e,i){t.prototype.exit.apply(this,arguments),this._shapeWidget.target(null),this._faChar.target(null)},n}),function(t,e){"function"==typeof define&&define.amd?define("common/IList",[],e):t.common_IList=e()}(this,function(){function t(){}return t.prototype.click=function(t){console.log("Click:  "+t)},t.prototype.dblclick=function(t){console.log("Double click:  "+t)},t}),function(t,e){"function"==typeof define&&define.amd?define("common/Image.js",["./HTMLWidget"],e):t.common_Image=e(t.common_HTMLWidget)}(this,function(t){function e(){t.call(this),this._drawStartPos="center"}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype._class+=" common_Image",e.prototype.publish("source",null,"string","Image Source",null,{tags:["Basic"]}),e.prototype.publish("sizing","actual","set","Controls sizing mode",["actual","fit","custom"],{tags:["Basic"]}),e.prototype.publish("customWidth","50%","string","Applies this width to IMG element if 'sizing' is set to 'custom'",null,{tags:["Basic"],disable:function(t){return"custom"!==t.sizing()}}),e.prototype.publish("customHeight","20%","string","Applies this height to IMG element if 'sizing' is set to 'custom'",null,{tags:["Basic"],disable:function(t){return"custom"!==t.sizing()}}),e.prototype.publish("lockAspectRatio",!0,"boolean","Locks the aspect ratio when scaling/stretching",null,{tags:["Basic"],disable:function(t){return"fit"!==t.sizing()}}),e.prototype.publish("alignment","center","set","Image Alignment",["center","origin"],{tags:["Basic"]}),e.prototype.enter=function(e,i){t.prototype.enter.apply(this,arguments)},e.prototype.update=function(e,i){this._drawStartPos=this.alignment(),t.prototype.update.apply(this,arguments);var n=this,o=i.selectAll("img").data(this.source()?[this.source()]:[],function(t){return t});o.enter().append("img").attr("src",this.source()).on("load",function(t){o.style(n.calcSize())}),o.style(this.calcSize()),o.exit().remove()},e.prototype.calcSize=function(){var t={width:"auto",height:"auto"};switch(this.sizing()){case"fit":if(this.lockAspectRatio()){var e=this.element().select("img");e.style({width:"auto",height:"auto"});var i=e.node().getBoundingClientRect(),n=i.width/this.width(),o=i.height/this.height();n>o?(t.width=this.width()+"px",t.height=i.height/n+"px"):(t.width=i.width/o+"px",t.height=this.height()+"px")}else t.width=this.width()+"px",t.height=this.height()+"px";break;case"custom":t.width=this.customWidth(),t.height=this.customHeight()}return t},e.prototype.exit=function(e,i){t.prototype.exit.apply(this,arguments)},e}),function(t,e){"function"==typeof define&&define.amd?define("common/IMenu",[],e):t.common_IMenu=e()}(this,function(){function t(){}return t.prototype.click=function(t){console.log("Click:  "+t)},t.prototype.preShowMenu=function(){console.log("preShowMenu")},t.prototype.postHideMenu=function(t){console.log("postHideMenu")},t}),function(t,e){"function"==typeof define&&define.amd?define("common/TextBox.js",["./SVGWidget","./Shape","./Text","css!./TextBox"],e):t.common_TextBox=e(t.common_SVGWidget,t.common_Shape,t.common_Text)}(this,function(t,e,i){function n(){t.call(this),this._shape=(new e).shape("rect"),this._text=new i}return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype._class+=" common_TextBox",n.prototype.publishProxy("text","_text"),n.prototype.publishProxy("shape_colorStroke","_shape","colorStroke"),n.prototype.publishProxy("shape_colorFill","_shape","colorFill"),n.prototype.publishProxy("text_colorFill","_text","colorFill"),n.prototype.publish("paddingLeft",4,"number","Padding:  Left",null,{tags:["Private"]}),n.prototype.publish("paddingRight",4,"number","Padding:  Right",null,{tags:["Private"]}),n.prototype.publish("paddingTop",4,"number","Padding:  Top",null,{tags:["Private"]}),n.prototype.publish("paddingBottom",4,"number","Padding:  Bottom",null,{tags:["Private"]}),n.prototype.publishProxy("anchor","_text"),n.prototype.publish("fixedSize",null),n.prototype.publish("tooltip","","string","Tooltip",null,{tags:["Private"]}),n.prototype.padding=function(t){return this.paddingLeft(t),this.paddingRight(t),this.paddingTop(t),this.paddingBottom(t),this},n.prototype.enter=function(e,i){t.prototype.enter.apply(this,arguments),this._tooltipElement=i.append("title"),this._shape.target(e).render(),this._text.target(e).render()},n.prototype.update=function(e,i){t.prototype.update.apply(this,arguments),this._tooltipElement.text(this.tooltip()),
this._text.render();var n=this._text.getBBox(!0),o={width:this.fixedSize()?this.fixedSize().width:n.width+this.paddingLeft()+this.paddingRight(),height:this.fixedSize()?this.fixedSize().height:n.height+this.paddingTop()+this.paddingBottom()};if(this._shape.width(o.width).height(o.height).render(),this.fixedSize())switch(this.anchor()){case"start":this._text.x(-this.fixedSize().width/2+n.width/2+(this.paddingLeft()+this.paddingRight())/2).render();break;case"end":this._text.x(this.fixedSize().width/2-n.width/2-(this.paddingLeft()+this.paddingRight())/2).render()}},n.prototype.exit=function(e,i){this._shape.target(null),this._text.target(null),t.prototype.exit.apply(this,arguments)},n}),function(t,e){"function"==typeof define&&define.amd?define("common/List",["d3","../common/SVGWidget","./IList","../common/TextBox","css!./List"],e):t.common_List=e(t.d3,t.common_SVGWidget,t.common_IList,t.common_TextBox)}(this,function(t,e,i,n){function o(t){e.call(this),i.call(this),this._listWidgets={}}return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype._class+=" common_List",o.prototype["implements"](i.prototype),o.prototype.publish("anchor","start","set","Anchor Position",["","start","middle","end"],{tags:["Private"]}),o.prototype.update=function(t,i){e.prototype.update.apply(this,arguments);var o=this,r=i.selectAll(".line").data(this.data(),function(t){return t});r.enter().append("g").attr("class","line").each(function(t){var e=(new n).target(this).paddingTop(0).paddingBottom(0).paddingLeft(8).paddingRight(8).text(t).render();e.element().on("click",function(t){o.click(t.text())}).on("dblclick",function(t){o.dblclick(t.text())}),o._listWidgets[t]=e});var s=0,a=0,h=0;for(var c in this._listWidgets)if(this._listWidgets.hasOwnProperty(c)){var l=this._listWidgets[c].getBBox();s+=l.height,a<l.width&&(a=l.width),++h}var p=-s/2;r.each(function(t){var e=o._listWidgets[t],i=e.getBBox();e.pos({x:0,y:p+i.height/2}).anchor(o.anchor()).fixedSize({width:a,height:i.height}).render(),p+=i.height}),r.exit().remove().each(function(t){o._listWidgets[t].target(null),delete o._listWidgets[t]})},o.prototype.exit=function(t,i){for(var n in this._listWidgets)this._listWidgets[n].target(null);e.prototype.exit.apply(this,arguments)},o}),function(t,e){"function"==typeof define&&define.amd?define("common/Menu",["d3","./SVGWidget","./IMenu","./Icon","./List","css!./Menu"],e):t.common_Menu=e(t.d3,t.common_SVGWidget,t.common_IMenu,t.common_Icon,t.common_List)}(this,function(t,e,i,n,o){function r(){e.call(this),i.call(this),this._icon=(new n).shape("square").diameter(14),this._list=new o;var r=this;this._list.click=function(e){t.event.stopPropagation(),r.hideMenu(),r.click(e)},this._open=!1}return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype._class+=" common_Menu",r.prototype["implements"](i.prototype),r.prototype.publishProxy("faChar","_icon",null,""),r.prototype.publishProxy("paddingPercent","_icon",null,10),r.prototype.toggleMenu=function(){this._open?this.hideMenu():this.showMenu()},r.prototype.showMenu=function(){this.preShowMenu(),this._open=!0,this._list.data(this.data()).render();var e=this._icon.getBBox(!0),i=this._list.getBBox(!0),n={x:e.width/2-i.width/2,y:e.height/2+i.height/2};this._list.move(n);var o=this;t.select("body").on("click."+this._id,function(){console.log("click:  body - "+o._id),o._open&&o.hideMenu()})},r.prototype.hideMenu=function(){t.select("body").on("click."+this._id,null),this._open=!1,this._list.data([]).render(),this.postHideMenu()},r.prototype.enter=function(i,n){e.prototype.enter.apply(this,arguments),this._icon.target(i).render(),this._list.target(i).render();var o=this;this._icon.element().on("click",function(e){t.event.stopPropagation(),o.toggleMenu()})},r.prototype.update=function(t,i){e.prototype.update.apply(this,arguments),i.classed("disabled",0===this.data().length),this._icon.faChar(this.faChar()).paddingPercent(this.paddingPercent()).render()},r.prototype.exit=function(t,i){this._icon.target(null),this._list.target(null),e.prototype.exit.apply(this,arguments)},r}),function(t,e){"function"==typeof define&&define.amd?define("common/Palette.js",["d3","colorbrewer"],e):t.common_Palette=e(t.d3)}(this,function(t){function e(t,e){if(!t)return i();var n=h[t];return n||(n=i(t,e),h[t]=n),n}function i(n,o){function c(t){return l(t)}if(!n)return["default"].concat(r.concat(s).concat(a));var l=null;if(o)l=t.scale.ordinal().range(o);else{if(r.indexOf(n)>=0)l=new t.scale[n];else if(a.indexOf(n)>=0){var p=[];switch(n){case"hpcc10":var u=i("default").colors();p=u.filter(function(t,e){return e%2?!0:!1});break;case"hpcc20":p=i("category10").colors().concat(i("hpcc10").colors())}l=t.scale.ordinal().range(p)}else if(s.indexOf(n)>0)for(var d=12;d>0;){if(colorbrewer[n][d]){l=t.scale.ordinal().range(colorbrewer[n][d]);break}--d}l||(l=t.scale.category20()),o=l.range()}return c.type=function(){return"ordinal"},c.id=function(t){return arguments.length?(n=t,c):n},c.colors=function(t){return arguments.length?(o=t,c):o},c.clone=function(t){return h[t]=i(t,this.colors()),h[t]},c.cloneNotExists=function(t){return h[t]?h[t]:this.clone(t)},c["switch"]=function(t,i){return n===t?this:arguments.length?e(t,i):e()},c}function n(t,e,i){if(!t)return o();var n=c[t];return n||(n=o(t,e,i),c[t]=n),n}function o(e,i,r){function a(t,e,i){return e===i?p.domain([e-1,i+1])(t):p.domain([e,i])(t)}if(!arguments.length){var h=["default"];for(var l in colorbrewer)-1===s.indexOf(l)&&h.push(l);return h}var p=null,u=i,d=function(e,i){i=i||32;var n=Math.ceil(i/(e.length-1)),o=[],r=null;return e.forEach(function(e){if(r)for(var i=t.scale.linear().domain([0,n]).range([r,e]).interpolate(t.interpolateLab),s=0;n>s;++s)o.push(i(s));r=e}),p=t.scale.quantize().domain([0,100]).range(o)};if(i)p=d(i,r);else{if(colorbrewer[e])for(var f=12;f>0;){if(colorbrewer[e][f]){p=d(colorbrewer[e][f]);break}--f}p||(p=d(colorbrewer.RdYlGn[11])),u=p.range()}return a.type=function(){return"rainbow"},a.id=function(t){return arguments.length?(e=t,a):e},a.colors=function(t){return arguments.length?(u=t,a):u},a.clone=function(t){return c[t]=o(t,this.color()),c[t]},a.cloneNotExists=function(t){return c[t]?c[t]:this.clone(t)},a["switch"]=function(t,i){return e===t?this:arguments.length?n(t,i):n()},a}var r=["category10","category20","category20b","category20c"],s=["Accent","Dark2","Paired","Pastel1","Pastel2","Set1","Set2","Set3"],a=["hpcc10","hpcc20"],h={},c={},l=function(e,n,r,s,a){t.select(e).selectAll(".palette").data(i(),function(t){return t}).enter().append("span").attr("class","palette").attr("title",function(t){return t}).on("click",function(e){console.log(t.values(e.value).map(JSON.stringify).join("\n"))}).selectAll(".swatch").data(function(t){return i(t).colors()}).enter().append("span").attr("class","swatch").style("background-color",function(t){return t}),t.select(n).selectAll(".palette").data(o(),function(t){return t}).enter().append("span").attr("class","palette").attr("title",function(t){return t}).on("click",function(e){console.log(t.values(e.value).map(JSON.stringify).join("\n"))}).selectAll(".swatch2").data(function(t){return o(t).colors()}).enter().append("span").attr("class","swatch2").style("height","8px").style("background-color",function(t){return t});var h={id:s.join("_")+a,scale:o("custom",s,a)};t.select(r).selectAll(".palette").data([h],function(t){return t.id}).enter().append("span").attr("class","palette").attr("title",function(t){return"aaa"}).on("click",function(e){console.log(t.values(e.value).map(JSON.stringify).join("\n"))}).selectAll(".swatch2").data(function(t){for(var e=[],i=0;255>=i;++i)e.push(h.scale(i,0,255));return e}).enter().append("span").attr("class","swatch2").style("background-color",function(t){return t})};return colorbrewer.RdWhGr={3:["red","white","green"]},{ordinal:e,rainbow:n,test:l}}),function(t,e){"function"==typeof define&&define.amd?define("common/Surface.js",["d3","./SVGWidget","./Icon","./Shape","./Text","./FAChar","./Menu","css!./Surface"],e):t.common_Surface=e(t.d3,t.common_SVGWidget,t.common_Icon,t.common_Shape,t.common_Text,t.common_FAChar,t.common_Menu)}(this,function(t,e,i,n,o,r,s){function a(){e.call(this),this._icon=(new i).faChar("").paddingPercent(50),this._container=(new n)["class"]("container").shape("rect"),this._titleRect=(new n)["class"]("title").shape("rect"),this._text=(new o)["class"]("title"),this._menu=(new s).paddingPercent(0);var t=this;this._menu.preShowMenu=function(){t.content()&&t.content().hasOverlay()&&t.content().visible(!1)},this._menu.postHideMenu=function(){t.content()&&t.content().hasOverlay()&&t.content().visible(!0)},this._surfaceButtons=[]}return a.prototype=Object.create(e.prototype),a.prototype.constructor=a,a.prototype._class+=" common_Surface",a.prototype.publish("showTitle",!0,"boolean","Show Title",null,{tags:["Basic"]}),a.prototype.publish("title","","string","Title",null,{tags:["Basic"]}),a.prototype.publishProxy("titleFontSize","_text","fontSize"),a.prototype.publish("showIcon",!0,"boolean","Show Title",null,{tags:["Advanced"]}),a.prototype.publishProxy("icon_faChar","_icon","faChar"),a.prototype.publishProxy("icon_shape","_icon","shape"),a.prototype.publish("content",null,"widget","Content",null,{tags:["Private"]}),a.prototype.publish("buttonAnnotations",[],"array","Button Array",null,{tags:["Intermediate"]}),a.prototype.publish("buttonGutter",25,"number","Space Between Menu and Buttons",null,{tags:["Intermediate"]}),a.prototype.publish("showContent",!0,"boolean","Show Content",null,{tags:["Intermediate"]}),a.prototype.publish("menu",[],"array","Menu List Data",null,{tags:["Intermediate"]}),a.prototype.publish("menuPadding",2,"number","Menu Padding",null,{tags:["Advanced"]}),a.prototype._origMenuParam=a.prototype.menu,a.prototype.menu=function(t){return a.prototype._origMenuParam.apply(this,arguments),arguments.length?(this._menu.data(t),this):this._menu.data()},a.prototype._origShowContent=a.prototype.showContent,a.prototype.showContent=function(t){var e=a.prototype._origShowContent.apply(this,arguments);return arguments.length&&this.content()&&this.content().visible(this.showContent()),e},a.prototype.enter=function(i,n){e.prototype.enter.apply(this,arguments);var o=n.append("g").attr("class","frame"),r=o.node();this._clipRect=o.append("defs").append("clipPath").attr("id",this.id()+"_clip").append("rect").attr("x",0).attr("y",0).attr("width",this._size.width).attr("height",this._size.height),this._titleRect.target(r).render().display(this.showTitle()&&this.showIcon()),this._icon.target(r).render(),this._menu.target(i),this._text.target(r),this._container.target(r),this.buttonContainer=t.select(this._target).append("div").attr("class","svg-button-container")},a.prototype.update=function(i,n){e.prototype.update.apply(this,arguments);var o=this,r=this.width()-1,s=this.height()-1;this._icon.display(this.showTitle()&&this.showIcon()).shape(this.icon_shape()).render(),this._menu.render(),this._text.text(this.title()).display(this.showTitle()).render();var a=this.buttonContainer.selectAll(".surface-button").data(this.buttonAnnotations());a.enter().append("button").attr("class","surface-button").each(function(e,i){var n=o._surfaceButtons[i]=t.select(this).attr("class","surface-button "+(e["class"]?e["class"]:"")).attr("id",e.id).style("padding",e.padding).style("width",e.width).style("height",e.height).style("cursor","pointer").on("click",function(t){o.click(t)});"FontAwesome"===e.font?n.append("i").attr("class","fa").text(function(t){return e.label}):n.text(function(t){return e.label})}),a.exit().each(function(e,i){var n=t.select(this);delete o._surfaceButtons[i],n.remove()});var h=this.showTitle()?Math.max.apply(null,this._surfaceButtons.map(function(t){return t.node().offsetHeight})):0,c=this.showTitle()&&this.showIcon()?this._icon.getBBox(!0):{width:0,height:0},l=this._text.getBBox(!0),p=this._menu.getBBox(!0),u=Math.max(c.height,l.height,p.height,h),d=this.showTitle()?u:0,f=(-s+u)/2,m=this.showTitle()?Math.max(l.height,p.height,h):0,y=m>=d?0:(d-m)/2,g=y;this._titleRect.pos({x:g,y:f}).width(r-2*g).height(m).display(this.showTitle()).render(),this._icon.move({x:-r/2+c.width/2,y:f}),this._menu.move({x:r/2-p.width/2-this.menuPadding(),y:f}),this._text.move({x:(c.width/2-p.width/2)/2,y:f});var _=o._titleRect.node().getBoundingClientRect().left+(o._size.width-2*g)-o.buttonGutter()-this.buttonContainer.node().offsetWidth,v=o._titleRect.node().getBoundingClientRect().top+(m-this.buttonContainer.node().offsetHeight)/2;if(isNaN(_)||this.buttonContainer.style("left",_+"px"),isNaN(v)||this.buttonContainer.style("top",v+"px"),this.showTitle()?this._container.pos({x:g/2,y:d/2-y/2}).width(r-g).height(s-d+y).render():this._container.pos({x:0,y:0}).width(r).height(s).render(),this.showContent()){var x=g,b=d-y,w=n.selectAll(".content").data(this.content()?[this.content()]:[],function(t){return t._id});w.enter().append("g").attr("class","content").attr("clip-path","url(#"+this.id()+"_clip)").each(function(t){t.target(this)}),w.attr("transform","translate("+g/2+", "+(d/2-y/2)+")").each(function(t){var e={left:0,top:0,right:1,bottom:1};t.resize({width:r-x-(e.left+e.right),height:s-b-(e.top+e.bottom)})}),this.content()&&this._clipRect.attr("x",-(r-x)/2).attr("y",-(s-b)/2).attr("width",r-x).attr("height",s-b),w.exit().transition().each(function(t){t.target(null)}).remove()}this._menu.element()&&this._menu.element().node()&&this._menu.element().node().parentNode&&this._menu.element().node().parentNode.appendChild(this._menu.element().node())},a.prototype.exit=function(t,i){this._titleRect.target(null),this._icon.target(null),this._menu.target(null),this._text.target(null),this._container.target(null),this.content()&&this.content().target(null),e.prototype.exit.apply(this,arguments)},a.prototype.intersection=function(t,e){var i=[],n=this._icon.intersection(t,e,this._pos);n&&i.push({i:n,d:this.distance(n,e)});var o=this._titleRect.intersection(t,e);o&&i.push({i:o,d:this.distance(o,e)});var r=this._container.intersection(t,e);r&&i.push({i:r,d:this.distance(r,e)});var s=null;return i.forEach(function(t){(null===s||s.d>t.d)&&(s=t)}),s&&s.i?s.i:null},a.prototype.click=function(t,e){console.log("Clicked: "+t.id)},a}),function(t,e){"function"==typeof define&&define.amd?define("common/ResizeSurface.js",["d3","./Surface","css!./ResizeSurface"],e):t.common_ResizeSurface=e(t.d3,t.common_Surface)}(this,function(t,e){function i(){e.call(this),this.handleWidth=8,this.handles=[{loc:"NW"},{loc:"N"},{loc:"NE"},{loc:"E"},{loc:"SE"},{loc:"S"},{loc:"SW"},{loc:"W"}];var i=this;this.dispatch=t.dispatch("sizestart","size","sizeend"),this.drag=t.behavior.drag().origin(function(t){return t}).on("dragstart",function(e){i.dispatch.sizestart(i,e.loc),i.allowResize()&&(t.event.sourceEvent.stopPropagation(),i._dragHandlePos={x:e.x,y:e.y},i._dragStartPos=i.pos(),i._dragStartSize=i.size(),i._prevPosSize={x:i._dragStartPos.x,y:i._dragStartPos.y,width:i._dragStartSize.width,height:i._dragStartSize.height},i._textPosSize=i._text.getBBox(!0),i._iconPosSize=i._icon.getBBox(!0),i.showContent(!1))}).on("drag",function(e){if(i.allowResize()){t.event.sourceEvent.stopPropagation();var n=t.event.x-i._dragHandlePos.x,o=t.event.y-i._dragHandlePos.y,r={x:0,y:0,w:0,h:0};switch(e.loc){case"NW":r.x=n/2,r.w=-n;case"N":r.y=o/2,r.h=-o;break;case"NE":r.y=o/2,r.h=-o;case"E":r.x=n/2,r.w=n;break;case"SE":r.x=n/2,r.w=n;case"S":r.y=o/2,r.h=o;break;case"SW":r.y=o/2,r.h=o;case"W":r.x=n/2,r.w=-n}var s={x:i._dragStartPos.x+r.x,y:i._dragStartPos.y+r.y,width:i._dragStartSize.width+r.w,height:i._dragStartSize.height+r.h};s.width<2*i._iconPosSize.width+i._textPosSize.width&&(s.x=i._prevPosSize.x,s.width=i._prevPosSize.width),s.height<i._textPosSize.height+48&&(s.y=i._prevPosSize.y,s.height=i._prevPosSize.height),i.pos({x:s.x,y:s.y},!1,!1).size({width:s.width,height:s.height}).render().getBBox(!0),i.dispatch.size(i,e.loc),i._prevPosSize=s}}).on("dragend",function(e){i.allowResize()&&(t.event.sourceEvent.stopPropagation(),i.showContent(!0).render(),i._container.getBBox(!0),i._titleRect.getBBox(!0),i.dispatch.sizeend(i,e.loc))})}return i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype._class+=" common_ResizeSurface",i.prototype.publish("allowResize",!0,"boolean","Sets if surface can be resized",null,{tags:["Private","Shared"]}),i.prototype.move=function(t){var i=e.prototype.move.apply(this,arguments);return this.updateHandles(this._domNode,this._element),i},i.prototype.update=function(t,i){e.prototype.update.apply(this,arguments),this.updateHandles(t,i)},i.prototype.updateHandles=function(e,i){var n=this._parentElement.selectAll("rect").data(this.handles,function(t){return t.loc});n.enter().append("rect").attr("class",function(t){return"resize"+t.loc}).call(this.drag);var o=this._pos.x+this._container._pos.x-this._container.width()/2,r=this._pos.y+this._titleRect._pos.y-this._titleRect.height()/2,s=this._pos.x+this._container._pos.x+this._container.width()/2,a=this._pos.y+this._container._pos.y+this._container.height()/2,h=s-o,c=a-r,l=this;n.each(function(e){switch(e.loc){case"NW":e.x=o-l.handleWidth/2,e.y=r-l.handleWidth/2,e.width=l.handleWidth,e.height=l.handleWidth;break;case"N":e.x=o+l.handleWidth/2,e.y=r-l.handleWidth/2,e.width=h-l.handleWidth,e.height=l.handleWidth;break;case"NE":e.x=s-l.handleWidth/2,e.y=r-l.handleWidth/2,e.width=l.handleWidth,e.height=l.handleWidth;break;case"E":e.x=s-l.handleWidth/2,e.y=r+l.handleWidth/2,e.width=l.handleWidth,e.height=c-l.handleWidth;break;case"SE":e.x=s-l.handleWidth/2,e.y=a-l.handleWidth/2,e.width=l.handleWidth,e.height=l.handleWidth;break;case"S":e.x=o+l.handleWidth/2,e.y=a-l.handleWidth/2,e.width=h-l.handleWidth,e.height=l.handleWidth;break;case"SW":e.x=o-l.handleWidth/2,e.y=a-l.handleWidth/2,e.width=l.handleWidth,e.height=l.handleWidth;break;case"W":e.x=o-l.handleWidth/2,e.y=r+l.handleWidth/2,e.width=l.handleWidth,e.height=c-l.handleWidth}t.select(this).attr("x",e.x).attr("y",e.y).attr("width",e.width).attr("height",e.height)})},i}),function(t,e){"function"==typeof define&&define.amd?define("common/SVGZoomWidget.js",["d3","../common/SVGWidget","../common/Icon","css!./SVGZoomWidget"],e):t.common_SVGZoomWidget=e(t.d3,t.common_SVGWidget,t.common_Icon)}(this,function(t,e,i){function n(t){e.call(this)}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype._class+=" common_SVGZoomWidget",n.prototype.publish("zoomToolbar",!0,"boolean","Show Zoom Toolbar"),n.prototype.publish("zoomDuration",250,"number","Transition Duration"),n.prototype.zoomTo=function(t,e,i){t=t||this._zoom.translate(),e=e||this._zoom.scale(),i=void 0===i?this.zoomDuration():0,this._zoomElement.transition().duration(i).call(this._zoom.translate(t).scale(e).event)},n.prototype.zoomToFit=function(t){var e=this._renderElement.node().getBBox();if(e.width&&e.height){var i=e.x+e.width/2,n=e.y+e.height/2,o=e.width,r=e.height,s=this.width(),a=this.height(),h=1/Math.max(o/s,r/a),c=[s/2-h*i,a/2-h*n];this.zoomTo(c,h,t)}},n.prototype.enter=function(i,n){e.prototype.enter.apply(this,arguments),this._zoomElement=n.append("g"),this._zoomGrab=this._zoomElement.append("rect").attr("class","background"),this._zoomG=this._zoomElement.append("g"),this._renderElement=this._zoomG.append("g");var o=this;this._zoom=t.behavior.zoom().scaleExtent([.05,20]).on("zoom",function(){o._zoomG.attr("transform","translate("+t.event.translate+")scale("+t.event.scale+")")}),this._zoomElement.call(this._zoom)},n.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this._zoomGrab.attr("width",this.width()).attr("height",this.height());var o=this,r=n.selectAll(".toolbar").data(this.zoomToolbar()?["dummy"]:[]),s=24,a=14;r.enter().append("g").attr("class","toolbar").each(function(t){o._buttonToFit=(new i).target(this).faChar("").shape("square").diameter(s).paddingPercent(100*(1-a/s)).on("click",function(){o.zoomToFit()}),o._buttonPlus=(new i).target(this).faChar("").shape("square").diameter(s).paddingPercent(100*(1-a/s)).on("click",function(){o.zoomTo(null,1.2*o._zoom.scale())}),o._buttonMinus=(new i).target(this).faChar("").shape("square").diameter(s).paddingPercent(100*(1-a/s)).on("click",function(){o.zoomTo(null,o._zoom.scale()/1.2)}),o._buttonLast=o._buttonMinus}),this.zoomToolbar()&&(this._buttonToFit.x(this.width()-s/2-4).y(s/2+4).render(),this._buttonPlus.x(this.width()-s/2-4).y(this._buttonToFit.y()+4+s).render(),this._buttonMinus.x(this.width()-s/2-4).y(this._buttonPlus.y()+s).render()),r.exit().each(function(){o._buttonToFit.target(null).render(),delete o._buttonToFit}).remove()},n.prototype.exit=function(t,i){e.prototype.exit.apply(this,arguments)},n}),function(t,e){"function"==typeof define&&define.amd?define("common/WidgetArray.js",["./Widget"],e):t.common_WidgetArray=e(t.common_Widget)}(this,function(t){function e(){t.call(this)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype._class+=" common_WidgetArray",e.prototype.publish("content",[],"widgetArray","Widget Array"),e.prototype.target=function(t){t||(this.content_reset(),this.exit())},e});