!function(o,t){"function"==typeof define&&define.amd?define(["d3","../common/CanvasWidget","../common/Icon","../common/TextBox"],t):o.graph_VertexC=t(o.d3,o.common_CanvasWidget,o.common_Icon,o.common_TextBox)}(this,function(o,t,e,i){function l(){t.call(this),this.poly_arr=[],this._icon=new e,this._textBox=new i,this._annotationWidgets={}}return l.prototype=Object.create(t.prototype),l.prototype.constructor=l,l.prototype._class+=" graph_VertexC",l.prototype.publishProxy("faChar","_icon"),l.prototype.publishProxy("imageUrl","_icon"),l.prototype.publishProxy("icon_shape_diameter","_icon","diameter"),l.prototype.publishProxy("icon_shape_colorFill","_icon","shape_colorFill"),l.prototype.publishProxy("icon_shape_colorStroke","_icon","shape_colorStroke"),l.prototype.publishProxy("icon_image_colorFill","_icon","image_colorFill"),l.prototype.publish("centroid",!1,"boolean","Centroid Vertex"),l.prototype.publish("centroidGlowSize",20,"number","Centroid Vertex glow size"),l.prototype.publish("centroidGlowColor","#ED1C24","html-color","Centroid Vertex glow color"),l.prototype.publishProxy("text","_textBox"),l.prototype.publishProxy("anchor","_textBox"),l.prototype.publishProxy("textbox_shape_colorStroke","_textBox","shape_colorStroke"),l.prototype.publishProxy("textbox_shape_colorFill","_textBox","shape_colorFill"),l.prototype.publishProxy("textbox_text_colorFill","_textBox","text_colorFill"),l.prototype.publish("iconAnchor","start","set","Icon Anchor Position",["","start","middle","end"],{tags:["Basic"]}),l.prototype.publish("tooltip","","string","Tooltip",null,{tags:["Private"]}),l.prototype.publish("iconTooltip","","string","iconTooltip",null,{tags:["Private"]}),l.prototype.publish("annotationDiameter",14,"number","Annotation Diameter",null,{tags:["Private"]}),l.prototype.publish("annotationSpacing",3,"number","Annotation Spacing",null,{tags:["Private"]}),l.prototype.publish("annotationIcons",[],"array","Annotations",null,{tags:["Private"]}),l.prototype.drawOriginalLayout=function(o,t){},l.prototype.drawCenteredLayout=function(o,t){},l.prototype.drawKeyLayout=function(o,t){function e(t){var e={vertex:a,tooltip:a.iconTooltip()},i=b,l=p-i,c=s-b/2;o.font=y+"px "+_,a.centroid()&&r(),o.beginPath(),o.font=y+"px "+_,o.rect(l-w,c,i,b),a.poly_arr.push([l-w,c,i,b,e]),o.strokeStyle=a.icon_shape_colorStroke()?a.icon_shape_colorStroke():"#777",o.stroke(),o.fillStyle=a.icon_shape_colorFill()?a.icon_shape_colorFill():"#fff",o.fill(),o.fillStyle=a.icon_image_colorFill()?a.icon_image_colorFill():"#fff",o.textAlign="center",n(),o.fillText(t,l+i/2-w,c+u+m),o.closePath(),a.update_x_minmax(l),a.update_x_minmax(l+i),a.update_y_minmax(c),a.update_y_minmax(c+b)}function i(t){var e={vertex:a,tooltip:a.tooltip()},i=p,l=s-b/2;a.centroid()&&r(),o.beginPath(),o.strokeStyle=a.textbox_shape_colorStroke()?a.textbox_shape_colorStroke():"#777",o.font=h+"px "+x,f=o.measureText(t).width,P=p-b+(b+f)/2,w=P-p,o.rect(i-w,l,f+2*u,d),a.poly_arr.push([i-w,l,f+2*u,d,e]),o.fillStyle=a.textbox_shape_colorFill()?a.textbox_shape_colorFill():"#fff",o.fill(),o.fillStyle=a.textbox_text_colorFill()?a.textbox_text_colorFill():"#000",o.textAlign="left",n(),o.fillText(t,i+u-w,l+u),o.stroke(),o.closePath(),a.update_x_minmax(i),a.update_x_minmax(i+f+2*u),a.update_y_minmax(l),a.update_y_minmax(l+d)}function l(){var t=p+f+2*u-g,e=s,i=0;o.textAlign="left",o.font=h+"px FontAwesome",a.annotationIcons().forEach(function(l){var p={vertex:a,tooltip:l.tooltip,direction:"down"};o.font=h+"px "+l.font,a.centroid()&&r(),o.beginPath(),o.strokeStyle="#777",o.rect(t-i-w,e,g,g),a.poly_arr.push([t-i-w,e,g,g,p]),o.stroke(),o.fillStyle=l.shape_colorFill?l.shape_colorFill:"#fff",o.fill(),o.fillStyle=l.image_colorFill?l.image_colorFill:"#000",n(),o.fillText(l.faChar,t-i+u-w,e+u),o.closePath(),i+=g})}function r(){o.shadowBlur=a.centroidGlowSize(),o.shadowColor=a.centroidGlowColor()}function n(){o.shadowBlur=0}var a=this,p=this.x(),s=this.y(),c=1,x="Arial",_="FontAwesome",h=12*c,y=2*h,u=h/4,m=u,f=0,d=h+2*u,b=2*d,g=d,P=0,w=0;this.min_x=p,this.max_x=p,this.min_y=s,this.max_y=s,o.textBaseline="top",i(this.text()),e(this.faChar()),l(),this.size({height:this.max_y-this.min_y,width:this.max_x-this.min_x})},l.prototype.drawPolyTooltip=function(o,t){function e(o,e,i,l){t.textBaseline="bottom";var r=14;t.font=r+"px Arial";var n=4,a=t.measureText(i).width,p=16,s=10,c=a+2*n,x=r+2*n;l&&(s*=-1,x*=-1),t.fillStyle="#000",t.beginPath(),t.moveTo(o,e),t.lineTo(o-p/2,e-s),t.lineTo(o-c/2,e-s),t.lineTo(o-c/2,e-(s+x)),t.lineTo(o+c/2,e-(s+x)),t.lineTo(o+c/2,e-s),t.lineTo(o+p/2,e-s),t.lineTo(o,e),t.closePath(),t.fill(),t.fillStyle="#FFF",l?t.fillText(i,o-c/2+n,e-s+n+r):t.fillText(i,o-c/2+n,e-s-n)}if(o[4].tooltip){var i=o[0]+o[2]/2,l=o[1]+o[3]/2,r=o[4].direction?o[4].direction:"up";switch(r){case"up":e(i,l,o[4].tooltip);break;case"down":e(i,l,o[4].tooltip,!0)}}},l.prototype.drawSelf=function(o,t){this.poly_arr=[],this.drawKeyLayout(o,t)},l.prototype.getHoveredPolygons=function(o,t){return this.poly_arr.filter(function(e){var i=o>e[0]&&o<e[0]+e[2],l=t>e[1]&&t<e[1]+e[3];return i&&l})},l.prototype.update_x_minmax=function(o){this.min_x>o&&(this.min_x=o),this.max_x<o&&(this.max_x=o)},l.prototype.update_y_minmax=function(o){this.min_y>o&&(this.min_y=o),this.max_y<o&&(this.max_y=o)},l.prototype.getBBox=function(){return this.size()},l});