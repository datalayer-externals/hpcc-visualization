!function(t,e){"function"==typeof define&&define.amd?define(["d3","topojson","./Layer","../common/Palette","../common/Utility","css!./Choropleth"],e):t.map_Choropleth=e(t.d3,t.topojson,t.map_Layer,t.common_Palette,t.common_Utility)}(this,function(t,e,o,i,a){function r(){o.call(this),a.SimpleSelectionMixin.call(this),this._dataMap={},this._path=t.select(null)}return r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype._class+=" map_Choropleth",r.prototype.mixin(a.SimpleSelectionMixin),r.prototype._palette=i.rainbow("default"),r.prototype.publish("paletteID","YlOrRd","set","Palette ID",r.prototype._palette["switch"](),{tags:["Basic","Shared"]}),r.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),r.prototype.publish("opacity",1,"number","Opacity",null,{tags:["Advanced"]}),r.prototype.publish("meshVisible",!0,"boolean","Mesh Visibility"),r.prototype.publish("meshColor",null,"html-color","Stroke Color",null,{optional:!0}),r.prototype.publish("meshStrokeWidth",.25,"number","Stroke Width"),r.prototype.publish("internalOnly",!1,"boolean","Internal mesh only"),r.prototype.publish("autoScaleMode","mesh","set","Auto Scale",["none","mesh","data"],{tags:["Basic"],override:!0}),r.prototype.data=function(t){var e=o.prototype.data.apply(this,arguments);if(arguments.length){this._dataMap={},this._dataMinWeight=null,this._dataMaxWeight=null;var i=this;this.data().forEach(function(t){i._dataMap[t[0]]=t,(!i._dataMinWeight||t[1]<i._dataMinWeight)&&(i._dataMinWeight=t[1]),(!i._dataMaxWeight||t[1]>i._dataMaxWeight)&&(i._dataMaxWeight=t[1])})}return e},r.prototype.getDataBounds=function(){var t=this._choroplethData.node().getBBox(),e={x:t.x,y:t.y,width:t.width,height:t.height},o=this._zoom.scale();e.x*=o,e.y*=o,e.width*=o,e.height*=o;var i=this._zoom.translate();return e.x+=i[0],e.y+=i[1],e},r.prototype.autoScale=function(){switch(this.autoScaleMode()){case"none":return;case"mesh":this.shrinkToFit(this.getBounds());break;case"data":this.shrinkToFit(this.getDataBounds())}},r.prototype.layerEnter=function(t,e,i){o.prototype.layerEnter.apply(this,arguments),this._choroplethTransform=e,this._choroplethData=this._choroplethTransform.append("g"),this._choropleth=this._choroplethTransform.append("path").attr("class","mesh")},r.prototype.layerUpdate=function(t,i){return o.prototype.layerUpdate.apply(this,arguments),this._palette=this._palette["switch"](this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id())),this.visible()&&this.meshVisible()?((i||this._prevProjection!==t.projection()||this._prevInternalOnly!==this.internalOnly())&&(this._choropleth.attr("d",t._d3GeoPath(e.mesh(this._choroTopology,this._choroTopologyObjects,this.internalOnly()?function(t,e){return t!==e}:function(t,e){return!0}))),this._prevProjection=t.projection(),this._prevInternalOnly=this.internalOnly()),void this._choroplethTransform.style("opacity",this.opacity()).style("stroke",this.meshColor())):(this._choropleth.attr("d",""),void delete this._prevProjection)},r.prototype.layerExit=function(t){delete this._prevProjection,delete this._prevInternalOnly},r.prototype.layerZoomed=function(t){o.prototype.layerZoomed.apply(this,arguments),this._choroplethTransform.attr("transform","translate("+t._zoom.translate()+")scale("+t._zoom.scale()+")").style("stroke-width",this.meshStrokeWidth()/t._zoom.scale()+"px")},r.prototype.click=function(t,e,o){console.log("Click:  "+JSON.stringify(t)+", "+e+", "+o)},r.prototype.dblclick=function(t,e,o){console.log("Double click:  "+JSON.stringify(t)+", "+e+", "+o)},r});