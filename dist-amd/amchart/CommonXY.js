!function(t,i){"function"==typeof define&&define.amd?define(["d3","../common/HTMLWidget","amcharts-xy","require","./XYAxis","../api/ITooltip"],i):t.amchart_CommonXY=i(t.d3,t.common_HTMLWidget,t.AmCharts,t.require,t.amchart_XYAxis,t.api_ITooltip)}(this,function(t,i,e,o,s,a){function l(){i.call(this),this._tag="div",this._chart={},this._selected=null,this._selections=[],this._dataUpdated=0,this._prevDataUpdated=-1,this._columnsUpdated=0,this._prevColumnsUpdated=-1,this._xAxis=new s,this._xAxis._owningWidget=this,this._yAxis=new s,this._yAxis._owningWidget=this}return l.prototype=Object.create(i.prototype),l.prototype.constructor=l,l.prototype._class+=" amchart_CommonXY",l.prototype["implements"](a.prototype),l.prototype.publish("backwardsCompatible",!0,"boolean","Allow use of old publish parameters"),l.prototype.publish("xAxes",[],"propertyArray","widgets",null,{max:1,tags:["Basic"]}),l.prototype.publish("yAxes",[],"propertyArray","widgets",null,{tags:["Basic"]}),l.prototype.publish("fontSize",11,"number","Font Size",null,{tags:["Basic","Shared"]}),l.prototype.publish("fontFamily","Verdana","string","Font Name",null,{tags:["Basic","Shared","Shared"]}),l.prototype.publish("fontColor","#000000","html-color","Font Color",null,{tags:["Basic","Shared"]}),l.prototype.publish("lineWidth",0,"number","Line Thickness",null,{min:0,max:10,step:1,inputType:"range",tags:["Basic","Shared"]}),l.prototype.publish("lineColor",null,"html-color","Color of the data/content lines",null,{tags:["Basic","Shared"]}),l.prototype.publish("lineOpacity",0,"number","Line Opacity",null,{min:0,max:1,step:.001,inputType:"range",tags:["Basic","Shared"]}),l.prototype.publish("dashedLineStyle",0,"number","",null,{tags:["Advanced","Shared"]}),l.prototype.publish("showScrollbar",!1,"boolean","Chart Scrollbar",null,{tags:["Intermediate"]}),l.prototype.publish("bulletSize",8,"number","Bullet Size",null,{tags:["Intermediate"]}),l.prototype.publish("bulletType","round","set","Bullet Type",["none","round","square","triangleUp","triangleDown","triangleLeft","triangleRight","bubble","diamond"],{tags:["Intermediate"]}),l.prototype.publish("marginLeft",50,"number","Margin (Left)",null,{tags:["Intermediate"]}),l.prototype.publish("marginRight",10,"number","Margin (Right)",null,{tags:["Intermediate"]}),l.prototype.publish("marginTop",20,"number","Margin (Top)",null,{tags:["Intermediate"]}),l.prototype.publish("marginBottom",50,"number","Margin (Bottom)",null,{tags:["Intermediate"]}),l.prototype.publish("selectionColor","#f00","html-color","Font Color",null,{tags:["Basic"]}),l.prototype.publish("selectionMode","simple","set","Selection Mode",["simple","multi"],{tags:["Intermediate"]}),l.prototype.publish("showCursor",!1,"boolean","Show Chart Scrollbar",null,{tags:["Intermediate","Shared"]}),l.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),l.prototype.publishProxy("xAxisType","_xAxis","axisType"),l.prototype.publishProxy("yAxisType","_yAxis","axisType"),l.prototype.publishProxy("xAxisTitle","_xAxis","axisTitle"),l.prototype.publishProxy("yAxisTitle","_yAxis","axisTitle"),l.prototype.publishProxy("xAxisBaselineColor","_xAxis","axisBaselineColor"),l.prototype.publishProxy("yAxisBaselineColor","_yAxis","axisBaselineColor"),l.prototype.publishProxy("xAxisFontColor","_xAxis","axisFontColor"),l.prototype.publishProxy("yAxisFontColor","_yAxis","axisFontColor"),l.prototype.publishProxy("xAxisTitleFontSize","_xAxis","axisTitleFontSize"),l.prototype.publishProxy("yAxisTitleFontSize","_yAxis","axisTitleFontSize"),l.prototype.publishProxy("xAxisTitleFontColor","_xAxis","axisTitleFontColor"),l.prototype.publishProxy("yAxisTitleFontColor","_yAxis","axisTitleFontColor"),l.prototype.publishProxy("xAxisLabelRotation","_xAxis","axisLabelRotation"),l.prototype.publishProxy("yAxisLabelRotation","_yAxis","axisLabelRotation"),l.prototype.publish("axisLineWidth",1,"number","Thickness of axis",null,{tags:["Intermediate","Shared"]}),l.prototype.publishProxy("xAxisAutoGridCount","_xAxis","axisAutoGridCount"),l.prototype.publishProxy("yAxisAutoGridCount","_yAxis","axisAutoGridCount"),l.prototype.publishProxy("xAxisGridPosition","_xAxis","axisGridPosition"),l.prototype.publishProxy("yAxisGridPosition","_yAxis","axisGridPosition"),l.prototype.publishProxy("xAxisFillAlpha","_xAxis","axisFillAlpha"),l.prototype.publishProxy("yAxisFillAlpha","_yAxis","axisFillAlpha"),l.prototype.publishProxy("xAxisFillColor","_xAxis","axisFillColor"),l.prototype.publishProxy("yAxisFillColor","_yAxis","axisFillColor"),l.prototype.publishProxy("xAxisGridAlpha","_xAxis","axisGridAlpha"),l.prototype.publishProxy("yAxisGridAlpha","_yAxis","axisGridAlpha"),l.prototype.publishProxy("xAxisDashLength","_xAxis","axisDashLength"),l.prototype.publishProxy("yAxisDashLength","_yAxis","axisDashLength"),l.prototype.publishProxy("xAxisTickFormat","_xAxis","axisTickFormat"),l.prototype.publishProxy("yAxisTickFormat","_yAxis","axisTickFormat"),l.prototype.publish("axisAlpha",1,"number","Axis opacity",null,{tags:["Intermediate"]}),l.prototype._origBackwardsCompatible=l.prototype.backwardsCompatible,l.prototype.backwardsCompatible=function(t){var i=l.prototype._origBackwardsCompatible.apply(this,arguments);return arguments.length&&this.switchProperties(t),i},l.prototype.switchProperties=function(t){t===!0?l.prototype.excludeObjs=["amchart_XYAxis"]:l.prototype.excludeObjs=[]},l.prototype.xAxis=function(t){if(!this.xAxes()[t]){var i=new s;i._owningWidget=this,this.xAxes()[t]=i}return this.xAxes()[t]},l.prototype.yAxis=function(t){if(!this.yAxes()[t]){var i=new s;i._owningWidget=this,this.yAxes()[t]=i}return this.yAxes()[t]},l.prototype.updateChartOptions=function(){var i=this;this._chart.theme="none",this._chart.type="xy",this._chart.color=this.fontColor(),this._chart.fontSize=this.fontSize(),this._chart.fontFamily=this.fontFamily();for(var e=0,o=0;o<this.yAxes().length;o++){var s=this.yAxes()[o];this._chart.valueAxes[e].position=s.position()?s.position():"left",this._chart.valueAxes[e].axisAlpha=s.axisAlpha(),this._chart.valueAxes[e].title=s.axisTitle(),this._chart.valueAxes[e].axisThickness=s.axisLineWidth(),this._chart.valueAxes[e].axisColor=s.axisBaselineColor(),this._chart.valueAxes[e].color=s.axisFontColor(),this._chart.valueAxes[e].titleFontSize=s.axisTitleFontSize(),this._chart.valueAxes[e].titleColor=s.axisTitleFontColor(),this._chart.valueAxes[e].autoGridCount=s.axisAutoGridCount(),this._chart.valueAxes[e].gridPosition=s.axisGridPosition(),this._chart.valueAxes[e].fillAlpha=s.axisFillAlpha(),this._chart.valueAxes[e].fillColor=s.axisFillColor(),this._chart.valueAxes[e].gridAlpha=s.axisGridAlpha(),this._chart.valueAxes[e].dashLength=s.axisDashLength(),this._chart.valueAxes[e].labelFunction=function(i){return t.format(s.axisTickFormat())(i)},e++}for(var a=0;a<this.xAxes().length;a++){var l=this.xAxes()[a];this._chart.valueAxes[e].position=l.position()?l.position():"bottom",this._chart.valueAxes[e].axisAlpha=l.axisAlpha(),this._chart.valueAxes[e].title=l.axisTitle(),this._chart.valueAxes[e].axisThickness=l.axisLineWidth(),this._chart.valueAxes[e].axisColor=l.axisBaselineColor(),this._chart.valueAxes[e].color=l.axisFontColor(),this._chart.valueAxes[e].titleFontSize=l.axisTitleFontSize(),this._chart.valueAxes[e].titleColor=l.axisTitleFontColor(),this._chart.valueAxes[e].labelRotation=l.axisLabelRotation(),this._chart.valueAxes[e].autoGridCount=l.axisAutoGridCount(),this._chart.valueAxes[e].gridPosition=l.axisGridPosition(),this._chart.valueAxes[e].fillAlpha=l.axisFillAlpha(),this._chart.valueAxes[e].fillColor=l.axisFillColor(),this._chart.valueAxes[e].gridAlpha=l.axisGridAlpha(),this._chart.valueAxes[e].dashLength=l.axisDashLength(),"ordinal"===l.axisType()?(this._chart.valueAxes[e].integersOnly=!0,this._chart.valueAxes[e].labelFunction=function(t,e){return e>i.data().length?"":i.data().length&&e>0?i.data()[e-1][0]:""}):this._chart.valueAxes[e].labelFunction=function(i){return t.format(l.axisTickFormat())(i)},e++}return(this._dataUpdated>this._prevDataUpdated||this._columnsUpdated>this._prevColumnsUpdated)&&(this._chart.dataProvider=this.formatData(this.data())),this._prevDataUpdated=this._dataUpdated,this._prevColumnsUpdated=this._columnsUpdated,this._chart.dataProvider.forEach(function(t,e){i._chart.dataProvider[e].color=i._palette(t[i.columns()[2]]),i._chart.dataProvider[e].linecolor=null!==i.lineColor()?i.lineColor():i._palette(t[i.columns()[2]])}),this._chart.colors=[],this.showScrollbar()?this._chart.chartScrollbar.enabled=!0:this._chart.chartScrollbar.enabled=!1,this.showCursor()?(this._chart.precision="ordinal"===this.xAxes()[0].axisType()?1:void 0,this._chart.chartCursor.enabled=!0,this._chart.chartCursor.valueLineEnabled=!0,this._chart.chartCursor.valueLineBalloonEnabled=!0,this._chart.chartCursor.categoryBalloonEnabled=!0):(this._chart.precision=void 0,this._chart.chartCursor.enabled=!1,this._chart.chartCursor.valueLineEnabled=!1,this._chart.chartCursor.valueLineBalloonEnabled=!1,this._chart.chartCursor.categoryBalloonEnabled=!1),this._chart},l.prototype.buildGraphObj=function(i,e){var o=this,s={};return s.id="g"+e,s.balloonFunction=function(i){return o&&o.tooltipValueFormat?o.columns()[i.graph.index]+": "+t.format(o.tooltipValueFormat())(o.data()[i.index][i.graph.index]):o.columns()[i.graph.index]+": "+o.data()[i.index][i.graph.index]},s.lineAlpha=o.lineOpacity(),s.lineThickness=o.lineWidth(),s.bullet=o.bulletType(),s.bulletSize=o.bulletSize(),s.dashLength=o.dashedLineStyle(),s.lineAlpha=o.lineOpacity(),s.lineColor=o.lineColor(),s.lineThickness=o.lineWidth(),s.type=i,s.colorField="color"+e,s.lineColorField="linecolor","ordinal"===this.xAxes()[0].axisType()&&(s.xField="idx",s.yField=o.columns()[e]),"linear"===this.xAxes()[0].axisType()&&(s.xField=o.columns()[0],s.yField=o.columns()[1]),s},l.prototype.formatData=function(t){var i=this,e=[];return t.forEach(function(t,o){var s={};i.columns().forEach(function(i,e){s[i]=t[e],s.idx=o+1}),e.push(s)}),e},l.prototype.enter=function(t,s){i.prototype.enter.apply(this,arguments),0===this.xAxes().length&&this.xAxes().push(this._xAxis),0===this.yAxes().length&&this.yAxes().push(this._yAxis);var a=this,l={type:"xy",addClassNames:!0,autoMargins:!0,chartScrollbar:{},valueAxes:[],chartCursor:{enabled:!1,valueLineEnabled:!1,valueLineBalloonEnabled:!1,categoryBalloonEnabled:!1,cursorAlpha:0,valueLineAlpha:.2,oneBalloonOnly:!0,balloonPointerOrientation:"vertical",valueBalloonsEnabled:!1},graphs:[{}],dataProvider:[{}],responsive:{enabled:!0}};"function"==typeof define&&define.amd&&(l.pathToImages=o.toUrl("amcharts-images")),this._chart=e.makeChart(t,l),this._chart.addListener("clickGraphItem",function(t){var i=t.graph,e=t.item.dataContext,o=i.colorField;null!==e[o]&&void 0!==e[o]?(delete e[o],"simple"===a.selectionMode()&&(null!==a._selected&&delete a._selected.data[a._selected.field],a._selected=null)):(e[o]=a.selectionColor(),"simple"===a.selectionMode()&&(null!==a._selected&&delete a._selected.data[a._selected.field],a._selected={field:o,data:e,cIdx:t.target.index,dIdx:t.index},a._selections.push(a._selected))),t.chart.validateData(),a.click(a.rowToObj(a.data()[t.index]),a.columns()[t.target.index],null!==a._selected)})},l.prototype.update=function(t,e){i.prototype.update.apply(this,arguments);var o=this;this.yAxes().forEach(function(t,i){0===i&&(o._yAxis=t),t._owningWidget=o}),this.xAxes().forEach(function(t,i){0===i&&(o._xAxis=t),t._owningWidget=o}),this.backwardsCompatible()?this.switchProperties(!0):this.switchProperties(!1),t.style.width=this.size().width+"px",t.style.height=this.size().height+"px",this._palette=this._palette["switch"](this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id()))},l.prototype.render=function(t){return i.prototype.render.apply(this,arguments)},l.prototype.data=function(t){return arguments.length&&this._dataUpdated++,i.prototype.data.apply(this,arguments)},l.prototype.columns=function(t){return arguments.length&&this._columnsUpdated++,i.prototype.columns.apply(this,arguments)},l});