!function(t,e){"function"==typeof define&&define.amd?define(["./SVGWidget","css!./Text"],e):t.common_Text=e(t.common_SVGWidget)}(this,function(t){function e(){t.call(this)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype._class+=" common_Text",e.prototype.publish("text","","string","Display Text",null,{tags:["Basic"]}),e.prototype.publish("fontFamily",null,"string","Font Family",null,{tags:["Intermediate"],optional:!0}),e.prototype.publish("fontSize",null,"number","Font Size (px)",null,{tags:["Intermediate"]}),e.prototype.publish("anchor","middle","set","Anchor Position",["start","middle","end"],{tags:["Intermediate"]}),e.prototype.publish("colorFill",null,"html-color","Fill Color",null,{tags:["Basic"]}),e.prototype.publish("rotation",0,"number","Degrees of rotation",null,{tags:["Basic"]}),e.prototype.enter=function(e,o){t.prototype.enter.apply(this,arguments),this._textElement=o.append("text")},e.prototype.update=function(e,o){t.prototype.update.apply(this,arguments);var n=this;this._textElement.attr("font-family",this.fontFamily()).attr("font-size",this.fontSize());var i=this.text().split("\n"),a=this._textElement.selectAll("tspan").data(i);a.enter().append("tspan").attr("class",function(t,e){return"tspan_"+e}).attr("dy","1em").attr("x","0"),a.style("fill",this.colorFill()).text(function(t){return t}),a.exit().remove();var r={width:0,height:0};try{r=this._textElement.node().getBBox()}catch(s){}var l=-(r.x+r.width/2),p=-(r.y+r.height/2);switch(this.anchor()){case"start":l=-r.x+r.width/2;break;case"end":l=r.x+r.width/2}var h=-this.rotation()*Math.PI/180;l=-1*Math.abs(l*Math.cos(h)+p*Math.sin(h)),p=-1*Math.abs(l*Math.sin(h)+p*Math.cos(h)),this._textElement.style("text-anchor",this.anchor()).attr("transform",function(t){return"translate("+l+","+p+")rotate("+n.rotation()+")"})},e});