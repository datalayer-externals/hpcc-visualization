!function(t,e){"function"==typeof define&&define.amd?define(["d3","./SVGWidget","./IMenu","./Icon","./List","css!./Menu"],e):t.common_Menu=e(t.d3,t.common_SVGWidget,t.common_IMenu,t.common_Icon,t.common_List)}(this,function(t,e,i,o,n){function s(){e.call(this),i.call(this),this._icon=(new o).shape("square").diameter(14),this._list=new n;var s=this;this._list.click=function(e){t.event.stopPropagation(),s.hideMenu(),s.click(e)},this._open=!1}return s.prototype=Object.create(e.prototype),s.prototype.constructor=s,s.prototype._class+=" common_Menu",s.prototype["implements"](i.prototype),s.prototype.publishProxy("faChar","_icon",null,"ïƒ‰"),s.prototype.publishProxy("paddingPercent","_icon",null,10),s.prototype.toggleMenu=function(){this._open?this.hideMenu():this.showMenu()},s.prototype.showMenu=function(){this.preShowMenu(),this._open=!0,this._list.data(this.data()).render();var e=this._icon.getBBox(!0),i=this._list.getBBox(!0),o={x:e.width/2-i.width/2,y:e.height/2+i.height/2};this._list.move(o);var n=this;t.select("body").on("click."+this._id,function(){console.log("click:  body - "+n._id),n._open&&n.hideMenu()})},s.prototype.hideMenu=function(){t.select("body").on("click."+this._id,null),this._open=!1,this._list.data([]).render(),this.postHideMenu()},s.prototype.enter=function(i,o){e.prototype.enter.apply(this,arguments),this._icon.target(i).render(),this._list.target(i).render();var n=this;this._icon.element().on("click",function(e){t.event.stopPropagation(),n.toggleMenu()})},s.prototype.update=function(t,i){e.prototype.update.apply(this,arguments),i.classed("disabled",0===this.data().length),this._icon.faChar(this.faChar()).paddingPercent(this.paddingPercent()).render()},s.prototype.exit=function(t,i){this._icon.target(null),this._list.target(null),e.prototype.exit.apply(this,arguments)},s});