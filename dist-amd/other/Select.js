!function(t,e){"function"==typeof define&&define.amd?define(["d3","../common/HTMLWidget","css!./Select"],e):t.other_Select=e(t.d3,t.common_HTMLWidget)}(this,function(t,e){function l(t){e.call(this)}return l.prototype=Object.create(e.prototype),l.prototype.constructor=l,l.prototype._class+=" other_Select",l.prototype.publish("label",null,"string","Label for select"),l.prototype.publish("valueColumn",null,"set","Select display value",function(){return this.columns()},{optional:!0}),l.prototype.publish("textColumn",null,"set","Select value(s)",function(){return this.columns()},{optional:!0}),l.prototype.publish("optional",!0,"boolean","Optional Select"),l.prototype.publish("sort",null,"set","Sort contents",["","ascending","descending"],{optional:!0}),l.prototype.publish("multiple",!1,"boolean","Multiple selection"),l.prototype.publish("selectSize",5,"number","Size of multiselect box",null,{disable:function(t){return!t.multiple()}}),l.prototype.selectData=function(){var t=this._db.rollupView([this.textColumn(),this.valueColumn()]),e=[];if(e=e.concat(t.entries().map(function(t){return{text:t.key,value:t.values.length?t.values[0].key:"",origRow:t.values.length&&t.values[0].values.length?t.values[0].values[0]:[]}},this)),this.sort_exists()){var l="descending"===this.sort();e.sort(function(t,e){return t.text<e.text?l?1:-1:t.text>e.text?l?-1:1:0})}return this.optional()&&e.unshift({value:"",text:""}),e},l.prototype.enter=function(l,o){e.prototype.enter.apply(this,arguments),this._span=o.append("span"),this._label=this._span.append("label").attr("for",this.id()+"_select");var n=this;this._select=this._span.append("select").attr("id",this.id()+"_select").on("change",function(e){for(var l=[],o=n._select.node().options,i=0;i<o.length;++i){var s=o[i];s.selected&&l.push(t.select(s).datum().origRow)}l.length?n.click(n.rowToObj(l[0]),n.valueColumn(),!0):n.click([],n.valueColumn(),!1)})},l.prototype.update=function(t,l){e.prototype.update.apply(this,arguments),this._label.text(this.label()),this._select.attr("multiple",this.multiple()?this.multiple():null).attr("size",this.multiple()&&this.selectSize()?this.selectSize():null);var o=this._select.selectAll(".dataRow").data(this.selectData());o.enter().append("option").attr("class","dataRow"),o.attr("value",function(t){return t.value}).text(function(t){return t.text}),o.exit().remove(),o.order()},l.prototype.exit=function(t,l){this._span.remove(),e.prototype.exit.apply(this,arguments)},l.prototype.click=function(t,e,l){console.log("Click:  "+JSON.stringify(t)+", "+e+", "+l)},l});