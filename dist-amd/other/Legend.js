!function(t,e){"function"==typeof define&&define.amd?define(["d3","./Table","../common/Palette","css!./Legend"],e):t.other_Legend=e(t.d3,t.other_Table,t.common_Palette)}(this,function(t,e,o){function i(){e.call(this),this.showHeader(!1),this.pagination(!1)}function r(t){return'<div class="colorBlock" style="background-color:'+t+';"></div>'}i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype._class+=" other_Legend",i.prototype.publish("dataFamily","ND","set","Type of data",["1D","2D","ND","map","any"],{tags:["Private"]}),i.prototype.publish("orientation","vertical","set","Orientation of Legend rows",["vertical","horizontal"],{tags:["Private"]}),i.prototype.publish("rainbowFormat",",","string","Rainbow number formatting",null,{tags:["Private"],optional:!0,disable:function(t){return!t.isRainbow()}}),i.prototype.publish("rainbowBins",8,"number","Number of rainbow bins",null,{tags:["Private"],disable:function(t){return!t.isRainbow()}}),i.prototype.isRainbow=function(){var t=this.getWidget();return t&&t._palette&&"rainbow"===t._palette.type()},i.prototype.targetWidget=function(t){if(!arguments.length)return this._targetWidget;this._targetWidget=t,this._targetWidgetMonitor&&(this._targetWidgetMonitor.remove(),delete this._targetWidgetMonitor);var e=this;return this._targetWidgetMonitor=this._targetWidget.monitor(function(t,o,i,r){switch(t){case"chart":case"columns":case"data":case"paletteID":e.lazyRender()}}),this},i.prototype.getWidget=function(){if(this._targetWidget)switch(this._targetWidget.classID()){case"chart_MultiChart":return this._targetWidget.chart()}return this._targetWidget},i.prototype.getPalette=function(){var t=this.getWidget();if(t&&t._palette)switch(t._palette.type()){case"ordinal":return o.ordinal(t._palette.id());case"rainbow":return o.rainbow(t._palette.id())}return o.ordinal("default")};var a=e.prototype.getBBox;return i.prototype.getBBox=function(t,e){var o=a.apply(this,arguments),i=this.element().select(".tableDiv > table");if(!i.empty()){var r=i.node().getBoundingClientRect(),n=r.width+8+(this.hasVScroll(this._parentElement)?this.getScrollbarWidth():0),s=r.height+8+(this.hasHScroll(this._parentElement)?this.getScrollbarWidth():0);return{x:o.x,y:o.y,width:(e?Math.round(n):n)*this._scale,height:(e?Math.round(s):s)*this._scale}}return o},i.prototype.enter=function(o,i){e.prototype.enter.apply(this,arguments),t.select(o.parentNode).style("overflow-y","auto"),this.renderHtmlDataCells(!0),this.fixedHeader(!1),this.fixedSize(!0),i.classed("other_Legend",!0)},i.prototype.update=function(o,i){var a=["Key","Label"],n=[];if(this._targetWidget){var s=this.getPalette();switch(s.type()){case"ordinal":switch(this.dataFamily()){case"2D":n=this._targetWidget.data().map(function(t){return[r(s(t[0])),t[0]]},this);break;case"ND":var l=this._targetWidget.columns();n=l.filter(function(t,e){return e>0}).map(function(t){return[r(s(t)),t]},this)}break;case"rainbow":var h=t.format(this.rainbowFormat()),c=this.getWidget(),g=this.rainbowBins(),d=c._dataMinWeight,p=c._dataMaxWeight,u=(p-d)/(g-1);n.push([r(s(d,d,p)),h(d)]);for(var f=1;g-1>f;++f){var y=u*f;n.push([r(s(y,d,p)),h(Math.floor(y))])}n.push([r(s(p,d,p)),h(p)])}}this.columns(a),this.data(n),e.prototype.update.apply(this,arguments),i.classed("horiz-legend","horizontal"===this.orientation());var b=i.select(".tableDiv > table"),m=b.node().getBoundingClientRect(),_=this._parentElement.node().getBoundingClientRect();i.select(".tableDiv").style({overflow:"visible"});var v=_.height/2-m.height/2,w=_.width/2-m.width/2;b.style({position:"absolute",top:v+"px",left:w+"px"});var W=this.pageNumber()-1,D=this.itemsPerPage(),M=W*D,x=parseInt(W*D)+parseInt(D),k=null;k=this.pagination()?this.data().slice(M,x):this.data();var C=this.tbody.selectAll("tr").data(k),B=this;C.on("click",function(t,e){B.onClick(t,e)}).on("dblclick",function(t,e){B.onDblClick(t,e)}).on("mouseover",function(t,e){B.onMouseOver(t,e)})},i.prototype.exit=function(t,o){this._targetWidgetMonitor&&(this._targetWidgetMonitor.remove(),delete this._targetWidgetMonitor),e.prototype.exit.apply(this,arguments)},i.prototype.onClick=function(t,e){console.log("Legend onClick method"),console.log("rowData: "+t),console.log("rowIdx: "+e)},i.prototype.onDblClick=function(t,e){console.log("Legend onDblClick method"),console.log("rowData: "+t),console.log("rowIdx: "+e)},i.prototype.onMouseOver=function(t,e){console.log("Legend onMouseOver method"),console.log("rowData: "+t),console.log("rowIdx: "+e)},i});