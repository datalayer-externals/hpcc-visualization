!function(t,e){"function"==typeof define&&define.amd?define(["d3","../common/CanvasWidget","simpleheat","../common/Palette"],e):t.other_HeatMap=e(t.d3,t.common_CanvasWidget,t.simpleheat,t.common_Palette)}(this,function(t,e,o,i){function a(){e.call(this)}return a.prototype=Object.create(e.prototype),a.prototype.constructor=a,a.prototype._palette=i.rainbow("default"),a.prototype._class+=" other_HeatMap",a.prototype.publish("radius",15,"number","Set point radius",null,{tags:["Basic"]}),a.prototype.publish("blur",15,"number","Set point blur",null,{tags:["Basic"]}),a.prototype.publish("max",1,"number","Set max data value",null,{tags:["Basic"]}),a.prototype.publish("gradient",{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},"object","Set gradient colors",null,{tags:["Basic"]}),a.prototype.publish("usePalette",!1,"boolean","If true, uses paletteID and colorCount to determine gradient",null,{tags:["Basic"]}),a.prototype.publish("colorCount",10,"number","Top left x-value",null,{tags:["Basic"]}),a.prototype.publish("paletteID","default","set","Palette ID",a.prototype._palette["switch"](),{tags:["Basic"]}),a.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),a.prototype.publish("topLeftX",null,"number","Top left x-value",null,{tags:["Basic"],optional:!0}),a.prototype.publish("topLeftY",null,"number","Top left y-value",null,{tags:["Basic"],optional:!0}),a.prototype.publish("bottomRightX",null,"number","Bottom right x-value",null,{tags:["Basic"],optional:!0}),a.prototype.publish("bottomRightY",null,"number","Bottom right y-value",null,{tags:["Basic"],optional:!0}),a.prototype.enter=function(t,i){e.prototype.enter.apply(this,arguments),this.resize(this._size),this._heat=o(t)},a.prototype.update=function(t,o){if(e.prototype.update.apply(this,arguments),this._palette=this._palette["switch"](this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id())),this.topLeftX_exists()&&this.topLeftY_exists()&&this.bottomRightX_exists()&&this.bottomRightY_exists()?this._heat.data(this.skewedData()):this._heat.data(this.data()),this.radius()&&this._heat.radius(this.radius(),this.blur()),this.usePalette()){for(var i={},a=1;a<=this.colorCount();a++){var s=a/this.colorCount();i[s]=this._palette(a,1,this.colorCount())}this._heat.defaultGradient=i,this._heat.gradient(i)}else this.gradient()&&(this._heat.defaultGradient=this.gradient(),this._heat.gradient(this.gradient()));this._heat.draw()},a.prototype.exit=function(t,o){delete this._heat,e.prototype.exit.apply(this,arguments)},a.prototype.resize=function(t){e.prototype.resize.apply(this,arguments),void 0!==this._heat&&this._heat.resize()},a.prototype.skewedData=function(){var t=this,e=[],o=this.data(),i=this.element().node().getBoundingClientRect(),a=this.bottomRightX()-this.topLeftX(),s=this.bottomRightY()-this.topLeftY(),l=a/i.width,p=s/i.height;return o.forEach(function(o){var i=Math.abs(o[0]-t.topLeftX()),a=Math.abs(o[1]-t.topLeftY()),s=i/l,n=a/p;e.push([s,n,o[2]])}),e},a});