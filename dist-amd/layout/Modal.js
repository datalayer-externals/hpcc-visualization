!function(t,e){"function"==typeof define&&define.amd?define(["d3","../common/HTMLWidget","../other/Html","css!./Modal"],e):t.layout_Modal=e(t.d3,t.common_HTMLWidget,t.other_Html)}(this,function(t,e,i){function o(){e.call(this),this._tag="div",this._widget=(new i).overflowX("visible").overflowY("visible")}return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype._class+=" layout_Modal",o.prototype.publishProxy("html","_widget"),o.prototype.publish("title","","string","title"),o.prototype.publish("titleFontSize","18px","string","titleFontSize"),o.prototype.publish("titleFontColor","#ffffff","html-color","titleFontColor"),o.prototype.publish("relativeTargetId",null,"string","relativeTargetId"),o.prototype.publish("headerPadding","15px","string","headerPadding"),o.prototype.publish("bodyPadding","15px","string","bodyPadding"),o.prototype.publish("showFade",!0,"boolean","showFade"),o.prototype.publish("enableClickFadeToClose",!0,"boolean","enableClickFadeToClose"),o.prototype.publish("minWidth","400px","string","minWidth"),o.prototype.publish("minHeight","400px","string","minHeight"),o.prototype.publish("maxWidth","800px","string","maxWidth"),o.prototype.publish("maxHeight","800px","string","maxHeight"),o.prototype.publish("fixedWidth",null,"string","fixedWidth"),o.prototype.publish("fixedHeight",null,"string","fixedHeight"),o.prototype.closeModal=function(){this.visible(!1)},o.prototype.getRelativeTarget=function(){var t;return this.relativeTargetId()&&(t=document.getElementById(this.relativeTargetId()))?t:!t&&(t=this.locateAncestor("layout_Grid"),t&&t.element)?t.element().node():document.body},o.prototype.setModalSize=function(){null!==this.fixedHeight()&&null!==this.fixedWidth()?this._modal.style({height:this.fixedHeight(),width:this.fixedWidth(),"min-height":null,"min-width":null,"max-height":null,"max-width":null}):(this.minHeight()||this.minWidth())&&this._modal.style({"min-height":this.minHeight(),"min-width":this.minWidth(),"max-height":this.maxHeight(),"max-width":this.maxWidth()});var t=this._modal.node().getBoundingClientRect(),e=this._modalHeader.node().getBoundingClientRect();return this._modalBody.style("height",t.height-e.height+"px").style("width",t.width),t},o.prototype.setFadePosition=function(t){var e={top:t.top+"px",left:t.left+"px",width:t.width+"px",height:t.height+"px"};this._fade.style(e)},o.prototype.setModalPosition=function(t){var e=this.setModalSize();if(null!==this.fixedHeight()&&null!==this.fixedWidth())this._modal.style({top:t.top+t.height/2-e.height/2+"px",left:t.left+t.width/2-e.width/2+"px"});else if(this.minHeight()||this.minWidth()){var i=this._modal.node().getBoundingClientRect();this._modal.style({top:t.top+t.height/2-i.height/2+"px",left:t.left+t.width/2-i.width/2+"px"})}},o.prototype.enter=function(t,i){e.prototype.enter.apply(this,arguments);var o=this;this._fade=i.append("div").classed("layout_Modal-fade",!0).classed("layout_Modal-fadeClickable",this.enableClickFadeToClose()).classed("layout_Modal-fade-hidden",!this.showFade()),this._modal=i.append("div").classed("layout_Modal-content",!0),this._modalHeader=this._modal.append("div").classed("layout_Modal-header",!0).style("padding",this.headerPadding()).style("color",this.titleFontColor()).style("font-size",this.titleFontSize()),this._modalBody=this._modal.append("div").classed("layout_Modal-body",!0).style("padding",this.bodyPadding()),this._modalHeaderTitle=this._modalHeader.append("div").classed("layout_Modal-title",!0).text(this.title()),this._modalHeaderTitle.style({left:this.headerPadding(),top:this.headerPadding()}),this._modalHeaderAnnotations=this._modalHeader.append("div").classed("layout_Modal-annotations",!0),this._modalHeaderAnnotations.style({right:this.headerPadding(),top:this.headerPadding()}),this._modalHeaderCloseButton=this._modalHeaderAnnotations.append("div").classed("layout_Modal-closeButton",!0).html('<i class="fa fa-close"></i>'),this._modalHeaderCloseButton.on("click",function(){o.closeModal()}),this._fade.on("click",function(){o.enableClickFadeToClose()&&o.closeModal()}),this._widget.target(this._modalBody.node())},o.prototype.update=function(t,i){e.prototype.update.apply(this,arguments),this._fade.classed("layout_Modal-fade-hidden",!this.showFade()),this._relativeTarget=this.getRelativeTarget(),this._modalHeaderTitle.text(this.title());var o=this._relativeTarget.getBoundingClientRect();this.setModalPosition(o)},o.prototype.exit=function(t,i){e.prototype.exit.apply(this,arguments),this._widget.target(null)},o.prototype.render=function(t){var i=this;return e.prototype.render.call(this,function(e){i._widget.resize().render(function(o){var d=i._relativeTarget.getBoundingClientRect();i.setFadePosition(d),i.setModalPosition(d),t&&t(e)})})},o});